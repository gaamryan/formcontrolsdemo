<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controls Library (WCAG 2.2 Compliant)</title>
    <style>
        /* Basic Reset & Variables */
        :root {
            --primary-color: #005fcc;
            --primary-hover-color: #004a9f;
            /* Light Theme Text/Element Colors */
            --text-color-light: #333;
            --border-color-light: #ccc;
            --label-color-light: #555;
            --input-bg-color-light: #fff;
            --input-border-color-light: #ccc;
            --disabled-bg-color-light: #eee;
            --disabled-text-color-light: #999;
            --form-item-bg-light: transparent;
            --header-bg-light: #f8f9fa;
            --pre-bg-light: #f0f0f0;
            --pre-border-light: #ccc;
            --theme-toggle-bg-light: transparent; /* UPDATED - Explicitly transparent */
            --component-bg-light: #fff;
            --component-border-light: #ccc;
            --alert-info-bg-light: #e7f3fe;
            --alert-info-border-light: #b3d7f9;
            --alert-info-text-light: #0a58ca;
            --overlay-bg-light: rgba(0, 0, 0, 0.6);


            /* Dark Theme Text/Element Colors */
            --primary-color-dark: #4dabf7;
            --primary-hover-color-dark: #74c0fc;
            --text-color-dark: #eee;
            --border-color-dark: #4a4a4a;
            --label-color-dark: #bbb;
            --input-bg-color-dark: #1a1a1a;
            --input-border-color-dark: #4a4a4a;
            --disabled-bg-color-dark: #333;
            --disabled-text-color-dark: #777;
            --form-item-bg-dark: transparent;
            --header-bg-dark: #0a0b0d;
            --pre-bg-dark: #151515;
            --pre-border-dark: #333;
            --theme-toggle-bg-dark: transparent; /* UPDATED - Explicitly transparent */
            --component-bg-dark: #252525;
            --component-border-dark: #4a4a4a;
            --alert-info-bg-dark: #1c2a3b;
            --alert-info-border-dark: #2a4a6f;
            --alert-info-text-dark: #a6cfff;
            --overlay-bg-dark: rgba(0, 0, 0, 0.7);


            --error-color: #d9534f;
            --focus-outline-color: #005fcc;
            --input-focus-border-color: #005fcc;
            --focus-outline-color-dark: #4dabf7;
            --input-focus-border-color-dark: #4dabf7;

            --font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
            --spacing-unit: 8px;
            --min-control-height: 44px;
        }

        /* Apply base variables (Light theme default) */
        :root {
            --text-color: var(--text-color-light);
            --border-color: var(--border-color-light);
            --label-color: var(--label-color-light);
            --input-bg-color: var(--input-bg-color-light);
            --input-border-color: var(--input-border-color-light);
            --disabled-bg-color: var(--disabled-bg-color-light);
            --disabled-text-color: var(--disabled-text-color-light);
            --form-item-bg: var(--form-item-bg-light);
            --header-bg: var(--header-bg-light);
            --pre-bg: var(--pre-bg-light);
            --pre-border: var(--pre-border-light);
            --theme-toggle-bg: var(--theme-toggle-bg-light);
            --component-bg: var(--component-bg-light);
            --component-border: var(--component-border-light);
            --alert-info-bg: var(--alert-info-bg-light);
            --alert-info-border: var(--alert-info-border-light);
            --alert-info-text: var(--alert-info-text-light);
            --overlay-bg: var(--overlay-bg-light);
        }


        /* Dark Theme Overrides */
        body.dark-theme {
             --primary-color: var(--primary-color-dark);
            --primary-hover-color: var(--primary-hover-color-dark);
            --text-color: var(--text-color-dark);
            --border-color: var(--border-color-dark);
            --label-color: var(--label-color-dark);
            --input-bg-color: var(--input-bg-color-dark);
            --input-border-color: var(--input-border-color-dark);
            --disabled-bg-color: var(--disabled-bg-color-dark);
            --disabled-text-color: var(--disabled-text-color-dark);
            --form-item-bg: var(--form-item-bg-dark);
            --header-bg: var(--header-bg-dark);
            --pre-bg: var(--pre-bg-dark);
            --pre-border: var(--pre-border-dark);
            --theme-toggle-bg: var(--theme-toggle-bg-dark);
            --component-bg: var(--component-bg-dark);
            --component-border: var(--component-border-dark);
            --alert-info-bg: var(--alert-info-bg-dark);
            --alert-info-border: var(--alert-info-border-dark);
            --alert-info-text: var(--alert-info-text-dark);
            --overlay-bg: var(--overlay-bg-dark);


            --error-color: #f78b88;
            --focus-outline-color: var(--focus-outline-color-dark);
            --input-focus-border-color: var(--input-focus-border-color-dark);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
            height: 100%;
        }

        body {
            font-family: var(--font-family);
            color: var(--text-color);
            background-color: #f5f5f5;
            background-image: linear-gradient(147deg, #f5f5f5 0%, #fffafa 74%);
            background-attachment: fixed;
            background-size: cover;
            min-height: 100%;
            line-height: 1.6;
            padding: 0 0 3rem 0;
            padding-top: 0px;
            transition: color 0.3s ease;
        }
        body.modal-open {
             overflow: hidden;
        }

        body.dark-theme {
            background-color: #003153;
            background-image: linear-gradient(315deg, #003153 0%, #1B1B1B 74%);
        }


        /* --- Theme Toggle (Inside Header) --- */
        .theme-toggle-container {
            display: flex;
            align-items: center;
            gap: calc(var(--spacing-unit) / 2);
            background: none; /* UPDATED - Removed background */
            padding: calc(var(--spacing-unit) / 2);
            border-radius: 4px;
            box-shadow: none; /* UPDATED - Removed shadow */
            transition: background-color 0.3s ease;
        }
        body.dark-theme .theme-toggle-container {
             box-shadow: 0 0px 0px rgba(0, 0, 0, 0.3); /* UPDATED - Explicitly no shadow */
        }

        .theme-toggle-container label {
             font-size: 0.9em;
             font-weight: normal;
             color: var(--label-color);
             margin-bottom: 0;
        }

        h1, h2, h3 {
            margin-bottom: calc(var(--spacing-unit) * 2);
            color: var(--primary-color);
        }
        h1 {
            margin-top: 0;
            margin-bottom: 0;
        }
        h2 { margin-top: calc(var(--spacing-unit) * 4); }
        h3 { margin-top: calc(var(--spacing-unit) * 3); }

        p, ol {
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        ul {
            margin-bottom: calc(var(--spacing-unit) * 2);
            padding-left: 1rem;
        }
        .accessibility-notes ul {
             padding-left: 0;
             list-style: none;
        }
         .accessibility-notes ul ul {
              padding-left: 1rem;
              list-style: disc;
              margin-top: calc(var(--spacing-unit) / 2);
         }
         .accessibility-notes li {
             margin-bottom: calc(var(--spacing-unit) / 2);
         }


        pre {
            background-color: var(--pre-bg);
            padding: calc(var(--spacing-unit) * 2);
            border-radius: 4px;
            overflow-x: auto;
            margin-top: var(--spacing-unit);
            margin-bottom: var(--spacing-unit);
            border: 0px solid var(--pre-border);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        code {
            font-family: monospace;
             color: var(--text-color);
        }
        body.dark-theme pre code {
            color: var(--text-color-dark);
        }


        /* --- Sticky Search Header --- */
        .sticky-search-container {
            position: sticky;
            top: 0;
            left: 0;
            right: 0;
            background-color: var(--header-bg);
            padding: calc(var(--spacing-unit) * 2) calc(var(--spacing-unit) * 2) 2.5rem;
            border-bottom: 1px solid var(--border-color);
            z-index: 100;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: background-color 0.3s ease, border-bottom-color 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: stretch;
        }
        .header-top-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 900px;
            margin-bottom: var(--spacing-unit);
            margin-left: auto;
            margin-right: auto;
        }

        .search-form {
            display: flex;
            flex-direction: column;
            align-items: stretch;
            gap: calc(var(--spacing-unit) / 2);
            width: 100%;
            max-width: 900px; /* Match top row width */
            padding: 0;
            margin-left: auto;
            margin-right: auto;
        }
        .search-form > input,
        .search-form > span,
        .search-form > button {
             max-width: none;
             margin-left: 0;
             margin-right: 0;
        }


        .search-input-group {
            display: contents;
        }

        .search-form label {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        #controlSearchInput {
             width: 100%;
        }

        #search-results-count {
            font-size: 0.85em;
            color: var(--label-color);
            text-align: left;
            width: 100%;
            padding-left: calc(var(--spacing-unit) / 2);
            order: 1;
            margin-bottom: 1rem;
        }

        .search-form button {
            width: 100%;
            margin: 0;
            order: 2;
        }


        /* --- Form Control Container --- */
        .form-control-item {
            margin: calc(var(--spacing-unit) * 4) auto;
            padding: 1rem 1.5rem;
            border-width: 0px; /* UPDATED */
            border-radius: 8px;
            background-color: transparent; /* UPDATED */
            max-width: 900px;
            transition: background-color 0.3s ease, border-color 0.3s ease;
            box-shadow: none; /* UPDATED - Remove shadow */
        }
        body.dark-theme .form-control-item {
             box-shadow: none; /* UPDATED - Remove shadow */
        }


        .form-control-item.hidden {
            display: none;
        }

        .form-group {
            margin-bottom: calc(var(--spacing-unit) * 2);
        }

        /* Common Input & Select Styling */
        input[type="text"],
        input[type="password"],
        input[type="email"],
        input[type="url"],
        input[type="tel"],
        input[type="number"],
        input[type="search"],
        input[type="date"],
        input[type="time"],
        input[type="datetime-local"],
        input[type="month"],
        input[type="week"],
        textarea,
        select {
            display: block;
            width: 100%;
            padding: var(--spacing-unit) calc(var(--spacing-unit) * 1.5);
            font-size: 1rem;
            line-height: 1.5;
            color: var(--text-color);
            background-color: var(--input-bg-color);
            background-clip: padding-box;
            border: 1px solid var(--input-border-color);
            border-radius: 4px;
            transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out, background-color 0.3s ease, color 0.3s ease;
            margin-top: calc(var(--spacing-unit) / 2);
            min-height: var(--min-control-height);
            vertical-align: middle;
        }

        select {
             padding-top: calc(var(--spacing-unit) * 0.75);
             padding-bottom: calc(var(--spacing-unit) * 0.75);
        }
        input[type="date"],
        input[type="time"],
        input[type="datetime-local"],
        input[type="month"],
        input[type="week"] {
             padding-top: calc(var(--spacing-unit) * 0.75);
             padding-bottom: calc(var(--spacing-unit) * 0.75);
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        /* Focus States */
        input:focus-visible,
        textarea:focus-visible,
        select:focus-visible,
        button:focus-visible,
        input[type="checkbox"]:focus-visible + label::before,
        input[type="radio"]:focus-visible + label::before,
        a.button-like:focus-visible,
        [role="switch"]:focus-visible,
        .switch input:focus-visible + .slider,
        .accordion-button:focus-visible,
        .carousel-button:focus-visible,
        .carousel-pagination button:focus-visible,
        [role="listbox"]:focus-visible,
        [role="option"]:focus-visible,
        .dialog button:focus-visible,
        .dialog input:focus-visible,
        .dialog [tabindex="-1"]:focus-visible
        {
            outline: 2px solid var(--focus-outline-color);
            outline-offset: 2px;
            border-color: var(--input-focus-border-color);
            box-shadow: 0 0 0 2px color-mix(in srgb, var(--focus-outline-color) 25%, transparent);
        }
        input:focus, textarea:focus, select:focus, button:focus, a:focus {
            outline: none;
        }


        /* Labels */
        label {
            display: inline-block;
            margin-bottom: calc(var(--spacing-unit) / 2);
            font-weight: bold;
            color: var(--label-color);
            cursor: pointer;
            transition: color 0.3s ease;
        }
        .form-group label:not(.inline-label) {
             display: block;
        }


        /* Help Text / Descriptions */
        .help-text {
            font-size: 0.875em;
            color: var(--label-color);
            margin-top: calc(var(--spacing-unit) / 2);
            display: block;
            transition: color 0.3s ease;
        }

        /* Required Fields */
        .required-indicator {
            color: var(--error-color);
            margin-left: 2px;
            font-weight: bold;
        }
        label .required-indicator {
             font-weight: bold;
        }

        /* Fieldsets for Grouping */
        fieldset {
            border: 1px solid var(--border-color);
            padding: calc(var(--spacing-unit) * 2);
            margin-bottom: calc(var(--spacing-unit) * 2);
            border-radius: 4px;
            transition: border-color 0.3s ease;
        }

        legend {
            padding: 0 calc(var(--spacing-unit));
            font-weight: bold;
            color: var(--primary-color);
            transition: color 0.3s ease;
        }

        /* Buttons */
        button,
        input[type="submit"],
        input[type="reset"],
        input[type="button"],
        a.button-like
        {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: 400;
            color: #fff;
            text-align: center;
            vertical-align: middle;
            cursor: pointer;
            user-select: none;
            background-color: var(--primary-color);
            border: 1px solid var(--primary-color);
            padding: var(--spacing-unit) calc(var(--spacing-unit) * 1.5);
            font-size: 1rem;
            line-height: 1.5;
            border-radius: 4px;
            text-decoration: none;
            transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
            margin-right: var(--spacing-unit);
            margin-bottom: 0px;
            min-height: var(--min-control-height);
        }
         .form-group > button,
         .dialog_form_actions > button {
             margin-bottom: var(--spacing-unit);
         }
         .form-group > button:last-child,
         .dialog_form_actions > button:last-child {
              margin-bottom: 0;
         }


        button:hover,
        input[type="submit"]:hover,
        input[type="reset"]:hover,
        input[type="button"]:hover,
        a.button-like:hover {
            background-color: var(--primary-hover-color);
            border-color: var(--primary-hover-color);
            color: #fff;
            text-decoration: none;
        }

        /* Secondary/Cancel Button Style */
        button.secondary,
        a.button-like.secondary {
            color: var(--primary-color);
            background-color: transparent;
            border-color: var(--primary-color);
        }
        button.secondary:hover,
        a.button-like.secondary:hover {
            color: #fff;
            background-color: var(--primary-hover-color);
            border-color: var(--primary-hover-color);
        }
        body.dark-theme button.secondary:hover {
             color: var(--text-color-dark);
             background-color: color-mix(in srgb, var(--primary-color-dark) 30%, transparent);
        }


        /* Disabled State */
        input:disabled,
        textarea:disabled,
        select:disabled,
        button:disabled {
            background-color: var(--disabled-bg-color);
            opacity: 0.65;
            cursor: not-allowed;
            color: var(--disabled-text-color);
            border-color: var(--input-border-color);
        }
        input[type="checkbox"]:disabled + label,
        input[type="radio"]:disabled + label {
             color: var(--disabled-text-color);
             cursor: not-allowed;
        }
        input[type="checkbox"]:disabled + label::before,
        input[type="radio"]:disabled + label::before {
             background-color: var(--disabled-bg-color);
             border-color: color-mix(in srgb, var(--disabled-text-color) 50%, transparent);
             cursor: not-allowed;
        }


        /* Checkbox & Radio Button Custom Styling */
        .checkbox-group label,
        .radio-group label {
            display: flex;
            align-items: center;
            margin-bottom: var(--spacing-unit);
            position: relative;
            padding-left: calc(var(--spacing-unit) * 3.5);
            min-height: calc(var(--spacing-unit) * 3);
            cursor: pointer;
            font-weight: normal;
            color: var(--text-color);
            transition: color 0.3s ease;
        }

        .checkbox-group input[type="checkbox"],
        .radio-group input[type="radio"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }

        .checkbox-group label::before,
        .radio-group label::before {
            content: "";
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            height: calc(var(--spacing-unit) * 2.5);
            width: calc(var(--spacing-unit) * 2.5);
            border: 1px solid var(--input-border-color);
            background-color: var(--input-bg-color);
            transition: background-color 0.15s ease-in-out, border-color 0.15s ease-in-out;
        }

        .radio-group label::before { border-radius: 50%; }
        .checkbox-group label::before { border-radius: 3px; }


        .checkbox-group input[type="checkbox"]:checked + label::after {
            content: "";
            position: absolute;
            left: calc(var(--spacing-unit) * 0.75);
            top: 50%;
            width: calc(var(--spacing-unit) * 0.75);
            height: calc(var(--spacing-unit) * 1.5);
            border: solid var(--primary-color);
            border-width: 0 3px 3px 0;
            transform: translateY(-65%) rotate(45deg);
        }

        .radio-group input[type="radio"]:checked + label::after {
            content: "";
            position: absolute;
            left: calc(var(--spacing-unit) * 0.6);
            top: 50%;
            transform: translateY(-50%);
            height: calc(var(--spacing-unit) * 1.3);
            width: calc(var(--spacing-unit) * 1.3);
            border-radius: 50%;
            background: var(--primary-color);
        }

        .checkbox-group label:hover::before,
        .radio-group label:hover::before {
             border-color: var(--input-focus-border-color);
        }


        /* File Input Specific Styling */
        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-flex;
            align-items: center;
            margin-top: calc(var(--spacing-unit) / 2);
            min-height: var(--min-control-height);
            gap: var(--spacing-unit);
        }
        .file-input-wrapper input[type="file"] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
         .file-input-wrapper .button-like {
             margin: 0;
             flex-shrink: 0;
         }
        .file-input-wrapper .file-name-display {
            display: inline-block;
            font-size: 0.9em;
            color: var(--label-color);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 200px;
            transition: color 0.3s ease;
        }

        /* Range Input - Display Value */
        .range-group {
            display: flex;
            align-items: center;
            gap: var(--spacing-unit);
            min-height: var(--min-control-height);
        }
        .range-group input[type="range"] {
             flex-grow: 1;
             margin-top: 0;
             height: var(--min-control-height);
             cursor: pointer;
        }
        .range-group .range-value {
            font-weight: bold;
            min-width: 3ch;
            text-align: right;
            color: var(--text-color);
            transition: color 0.3s ease;
        }


        /* Toggle Switch Styling */
        .switch {
          position: relative;
          display: inline-flex;
          align-items: center;
          width: 50px;
          height: 28px;
          vertical-align: middle;
          margin-top: calc(var(--spacing-unit) / 2);
          min-height: var(--min-control-height);
        }

        .switch input {
          opacity: 0;
          width: 0;
          height: 0;
          position: absolute;
        }

        .slider {
          position: absolute;
          cursor: pointer;
          top: 50%;
          transform: translateY(-50%);
          left: 0;
          right: 0;
          height: 28px;
          background-color: var(--input-border-color);
          transition: .4s;
          border-radius: 28px;
        }

        .slider:before {
          position: absolute;
          content: "";
          height: 20px;
          width: 20px;
          left: 4px;
          bottom: 4px;
          background-color: white;
          transition: .4s;
          border-radius: 50%;
        }
        body.dark-theme .slider:before {
            background-color: #ddd;
        }

        input:checked + .slider {
          background-color: var(--primary-color);
        }

        input:checked + .slider:before {
          transform: translateX(22px);
        }


        /* --- Scroll to Top Button --- */
        #scrollToTopBtn {
            display: none;
            position: fixed;
            bottom: 20px;
            right: 30px;
            z-index: 99;
            border: none;
            outline: none;
            background-color: var(--primary-color);
            color: white;
            cursor: pointer;
            padding: 0;
            border-radius: 50%;
            font-size: 18px;
            width: 55px;
            height: 55px;
            line-height: 55px;
            text-align: center;
            opacity: 0.8;
            transition: opacity 0.3s ease, background-color 0.3s ease;
        }

        #scrollToTopBtn:hover {
            background-color: var(--primary-hover-color);
            opacity: 1;
        }
         #scrollToTopBtn:focus-visible {
            outline: 3px solid var(--focus-outline-color);
            outline-offset: 3px;
            opacity: 1;
         }
         #scrollToTopBtn::before {
            content: '';
            display: inline-block;
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 10px solid white;
            position: absolute;
            top: 45%;
            left: 50%;
            transform: translate(-50%, -50%);
         }

        /* --- Utility Classes --- */
        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
        .hidden {
            display: none !important;
        }


        /* --- Component Styles --- */

        /* Modal Dialog Styles */
        .dialog-overlay {
            position: fixed;
            inset: 0;
            background-color: var(--overlay-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 1rem;
        }
        .dialog {
            background-color: var(--component-bg);
            border: 1px solid var(--component-border);
            border-radius: 8px;
            padding: calc(var(--spacing-unit) * 3);
            max-width: 600px;
            width: 90%;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }
        .dialog-close-btn {
             position: absolute;
             top: var(--spacing-unit);
             right: var(--spacing-unit);
             background: transparent;
             border: none;
             font-size: 1.8rem;
             line-height: 1;
             padding: calc(var(--spacing-unit) / 2);
             cursor: pointer;
             color: var(--label-color);
             width: 40px;
             height: 40px;
             display: flex;
             align-items: center;
             justify-content: center;
             border-radius: 50%;
             margin: 0;
             min-height: auto;
        }
         .dialog-close-btn:hover, .dialog-close-btn:focus {
              color: var(--text-color);
              background-color: color-mix(in srgb, var(--border-color) 20%, transparent);
         }

        .dialog_label {
            font-size: 1.5rem;
            margin-bottom: var(--spacing-unit);
            margin-right: 40px;
            color: var(--primary-color);
        }
        .dialog_desc {
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        .dialog_form .form-group {
            margin-bottom: var(--spacing-unit);
        }
        .dialog_form_actions {
            margin-top: calc(var(--spacing-unit) * 3);
            text-align: right;
            border-top: 1px solid var(--border-color);
            padding-top: calc(var(--spacing-unit) * 2);
        }
        .dialog_form_actions button {
            margin-left: var(--spacing-unit);
            margin-bottom: 0;
        }
        .dialog_form_actions button:first-child {
             margin-left: 0;
        }

        /* Accordion Styles */
        .accordion {
            border: 1px solid var(--border-color);
            border-radius: 4px;
            overflow: hidden;
        }
        .accordion-item {
            border-bottom: 1px solid var(--border-color);
        }
        .accordion-item:last-child {
            border-bottom: none;
        }
        .accordion-button {
            display: block;
            width: 100%;
            padding: calc(var(--spacing-unit) * 1.5) calc(var(--spacing-unit) * 2);
            background-color: var(--input-bg-color);
            border: none;
            text-align: left;
            font-size: 1rem;
            font-weight: bold;
            color: var(--text-color);
            cursor: pointer;
            position: relative;
            transition: background-color 0.2s ease;
            min-height: var(--min-control-height);
        }
        .accordion-button:hover {
            background-color: color-mix(in srgb, var(--input-bg-color) 85%, var(--border-color));
        }
        .accordion-button::after {
            content: '';
            position: absolute;
            right: calc(var(--spacing-unit) * 2);
            top: 50%;
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-top: 6px solid currentColor;
            transform: translateY(-50%);
            transition: transform 0.2s ease;
        }
        .accordion-button[aria-expanded="true"]::after {
            transform: translateY(-50%) rotate(180deg);
        }
        .accordion-panel {
            padding: calc(var(--spacing-unit) * 2);
            background-color: var(--component-bg);
            border-top: 1px solid var(--border-color);
        }

        /* Alert Styles */
        .alert {
            padding: calc(var(--spacing-unit) * 1.5);
            margin-bottom: var(--spacing-unit) * 2;
            border: 1px solid transparent;
            border-radius: 4px;
            background-color: var(--alert-info-bg);
            border-color: var(--alert-info-border);
            color: var(--alert-info-text);
        }

        /* Breadcrumb Styles */
        .breadcrumb {
            padding: var(--spacing-unit) 0;
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            gap: calc(var(--spacing-unit) / 2) var(--spacing-unit);
        }
        .breadcrumb li {
            display: inline-flex;
            align-items: center;
        }
        .breadcrumb li + li::before {
            content: "/";
            padding: 0 var(--spacing-unit);
            color: var(--label-color);
        }
        .breadcrumb a {
            color: var(--primary-color);
            text-decoration: none;
        }
        .breadcrumb a:hover, .breadcrumb a:focus {
            text-decoration: underline;
        }
        .breadcrumb [aria-current="page"] {
            color: var(--text-color);
            font-weight: bold;
            text-decoration: none;
            cursor: default;
        }

        /* Carousel Styles */
        .carousel {
            position: relative;
            overflow: hidden;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background-color: var(--input-bg-color);
        }
        .carousel-slides {
            display: flex;
            transition: transform 0.5s ease-in-out;
        }
        .carousel-slide {
            min-width: 100%;
            flex-shrink: 0;
            padding: calc(var(--spacing-unit) * 5);
            text-align: center;
            background-color: var(--component-bg);
            border: 1px solid var(--component-border);
            margin: 1px;
        }
        .carousel-slide img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 0 auto calc(var(--spacing-unit)*2);
            max-height: 300px;
        }
        .carousel-button {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            padding: var(--spacing-unit);
            border-radius: 50%;
            cursor: pointer;
            z-index: 10;
            width: 40px;
            height: 40px;
            font-size: 1.5rem;
            line-height: 1;
        }
        .carousel-button.prev { left: var(--spacing-unit); }
        .carousel-button.next { right: var(--spacing-unit); }
        .carousel-button:hover, .carousel-button:focus {
            background-color: rgba(0, 0, 0, 0.8);
        }
        .carousel-pagination {
            position: absolute;
            bottom: var(--spacing-unit);
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: var(--spacing-unit);
            z-index: 10;
        }
        .carousel-pagination button {
            background-color: rgba(255, 255, 255, 0.5);
            border: 1px solid rgba(0,0,0,0.5);
            border-radius: 50%;
            width: 12px;
            height: 12px;
            padding: 0;
            cursor: pointer;
            min-height: auto;
            margin: 0;
        }
        .carousel-pagination button[aria-selected="true"] {
            background-color: rgba(0, 0, 0, 0.8);
        }
        .carousel-status {
             position: absolute;
             width: 1px;
             height: 1px;
             padding: 0;
             margin: -1px;
             overflow: hidden;
             clip: rect(0, 0, 0, 0);
             white-space: nowrap;
             border-width: 0;
        }

        /* Listbox Styles */
        .listbox-container {
            margin-top: var(--spacing-unit);
        }
        .listbox-label {
            display: block;
            font-weight: bold;
            margin-bottom: calc(var(--spacing-unit) / 2);
            color: var(--label-color);
        }
        [role="listbox"] {
            border: 1px solid var(--input-border-color);
            background-color: var(--input-bg-color);
            border-radius: 4px;
            padding: calc(var(--spacing-unit) / 2) 0;
            min-height: 100px;
            max-height: 200px;
            overflow-y: auto;
        }
        [role="option"] {
            padding: var(--spacing-unit) calc(var(--spacing-unit) * 1.5);
            cursor: pointer;
            display: block;
        }
        [role="option"][aria-selected="true"] {
            background-color: var(--primary-color);
            color: white;
        }
        [role="option"]:hover, [role="option"]:focus {
             background-color: color-mix(in srgb, var(--primary-color) 20%, var(--input-bg-color));
             color: var(--text-color);
        }
        [role="option"][aria-selected="true"]:hover,
        [role="option"][aria-selected="true"]:focus {
            background-color: var(--primary-hover-color);
            color: white;
        }
        .listbox-group-label {
            padding: calc(var(--spacing-unit) / 2) calc(var(--spacing-unit) * 1.5);
            font-weight: bold;
            color: var(--label-color);
            font-style: italic;
            margin-top: var(--spacing-unit);
            border-top: 1px dashed var(--border-color);
        }
        .listbox-group-label:first-child {
             margin-top: 0;
             border-top: none;
        }
        [role="group"] [role="option"] {
             padding-left: calc(var(--spacing-unit) * 3);
        }
        .rearrange-listbox-wrapper {
            display: flex;
            align-items: flex-start;
            gap: var(--spacing-unit);
        }
        .rearrange-listbox-wrapper [role="listbox"] {
            flex-grow: 1;
        }
        .rearrange-buttons {
            display: flex;
            flex-direction: column;
            gap: calc(var(--spacing-unit) / 2);
            padding-top: calc(var(--spacing-unit) * 3);
        }
        .rearrange-buttons button {
            margin: 0;
            padding: calc(var(--spacing-unit) / 2) var(--spacing-unit);
            min-height: 30px;
            font-size: 0.9em;
        }


    </style>
</head>
<body>

    <header class="sticky-search-container">
        <div class="header-top-row">
            <h1>Controls Library</h1>
            <div class="theme-toggle-container">
                 <label for="themeToggle" id="themeToggleLabel" class="inline-label">Theme Toggle</label>
                 <label class="switch" aria-labelledby="themeToggleLabel">
                   <input type="checkbox" id="themeToggle" role="switch" aria-checked="false">
                   <span class="slider"></span>
                 </label>
            </div>
        </div>

        <form action="#" class="search-form" role="search" onsubmit="return false;">
            <label for="controlSearchInput">Search Components</label>
            <input type="search" id="controlSearchInput" placeholder="E.g., 'button', 'modal', 'accordion'">
            <span id="search-results-count" aria-live="polite"></span>
            <button type="submit" class="secondary" aria-label="Search Components">Search</button>
        </form>
    </header>

    <main id="controls-container">

        <div class="form-control-item" data-keywords="text input field textfield string">
            <h2>Text Input</h2>
            <p>Standard input for single-line text.</p>
            <div class="form-group">
                <label for="textInputExample" class="label-block">Your Name <span class="required-indicator" aria-hidden="true">*</span></label>
                <input type="text" id="textInputExample" name="username" placeholder="E.g., Jane Doe" required aria-required="true" aria-describedby="nameHelp">
                <small id="nameHelp" class="help-text">Please enter your full name.</small>
            </div>
            <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="textInputExample"&gt;Your Name &lt;span class="required-indicator" aria-hidden="true"&gt;*&lt;/span&gt;&lt;/label&gt;
  &lt;input type="text" id="textInputExample" name="username" placeholder="E.g., Jane Doe" required aria-required="true" aria-describedby="nameHelp"&gt;
  &lt;small id="nameHelp" class="help-text"&gt;Please enter your full name.&lt;/small&gt;
&lt;/div&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                    <li><strong>Label Association:</strong> The <code>&lt;label&gt;</code>'s <code>for</code> attribute must match the <code>&lt;input&gt;</code>'s <code>id</code>. (WCAG 1.3.1, 3.3.2, 4.1.2)</li>
                    <li><strong>Visible Label:</strong> Must always be visible.</li>
                    <li><strong>Placeholder:</strong> Use only for hints, not labels. (WCAG 1.3.1, 3.3.2)</li>
                    <li><strong>Required Fields:</strong> Indicate visually and programmatically (<code>required</code>/<code>aria-required="true"</code>). (WCAG 3.3.2)</li>
                    <li><strong>Instructions/Hints:</strong> Link via <code>aria-describedby</code>. (WCAG 3.3.2)</li>
                    <li><strong>Focus Indicator:</strong> Ensure clear visual focus. (WCAG 2.4.7, 2.4.11)</li>
                    <li><strong>Target Size:</strong> Ensure min. 44px height. (WCAG 2.5.5)</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" data-keywords="email address input contact">
            <h2>Email Input</h2>
            <p>Input specifically for email addresses.</p>
            <div class="form-group">
                <label for="emailInputExample">Email Address</label>
                <input type="email" id="emailInputExample" name="user_email" placeholder="you@example.com" aria-describedby="emailHelp">
                 <small id="emailHelp" class="help-text">We'll never share your email with anyone else.</small>
            </div>
            <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="emailInputExample"&gt;Email Address&lt;/label&gt;
  &lt;input type="email" id="emailInputExample" name="user_email" placeholder="you@example.com" aria-describedby="emailHelp"&gt;
  &lt;small id="emailHelp" class="help-text"&gt;We'll never share your email with anyone else.&lt;/small&gt;
&lt;/div&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                    <li>Follows Text Input principles.</li>
                    <li><code>type="email"</code> provides native validation & optimized keyboard. (WCAG 3.3.1)</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" data-keywords="password secret input secure">
            <h2>Password Input</h2>
            <p>Input for sensitive information.</p>
            <div class="form-group">
                <label for="passwordInputExample">Password</label>
                <input type="password" id="passwordInputExample" name="user_pass" required aria-required="true" aria-describedby="passwordHelp">
                 <small id="passwordHelp" class="help-text">Must be at least 8 characters long.</small>
            </div>
             <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="passwordInputExample"&gt;Password&lt;/label&gt;
  &lt;input type="password" id="passwordInputExample" name="user_pass" required aria-required="true" aria-describedby="passwordHelp"&gt;
  &lt;small id="passwordHelp" class="help-text"&gt;Must be at least 8 characters long.&lt;/small&gt;
  &lt;!-- Add Show/Hide button + JS here if needed --&gt;
&lt;/div&gt;</code></pre>
             <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                    <li>Follows Text Input principles.</li>
                    <li><code>type="password"</code> masks input.</li>
                    <li>Consider accessible <strong>"Show/Hide" toggle button</strong> (clear label, state announcement via ARIA, keyboard accessible, sufficient target size). (WCAG 4.1.2)</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" data-keywords="url web address website link input">
            <h2>URL Input</h2>
            <p>Input for web addresses (URLs).</p>
            <div class="form-group">
                <label for="urlInputExample">Website URL</label>
                <input type="url" id="urlInputExample" name="website" placeholder="https://example.com">
            </div>
             <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="urlInputExample"&gt;Website URL&lt;/label&gt;
  &lt;input type="url" id="urlInputExample" name="website" placeholder="https://example.com"&gt;
&lt;/div&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                    <li>Follows Text Input principles.</li>
                    <li><code>type="url"</code> provides native validation & optimized keyboard. (WCAG 3.3.1)</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" data-keywords="search find query input filter content">
            <h2>Search Input (Content Area Example)</h2>
            <p>Input specifically for search queries within the main content area.</p>
             <div class="form-group" role="search">
                <label for="searchInputExampleContent">Search Documentation</label>
                <div style="display: flex; align-items: center; gap: var(--spacing-unit);">
                    <input type="search" id="searchInputExampleContent" name="query_content" placeholder="Enter search term..." style="flex-grow: 1;">
                    <button type="submit" class="secondary" aria-label="Search Documentation">Search</button>
                </div>
            </div>
            <pre><code>&lt;div class="form-group" role="search"&gt;
  &lt;label for="searchInputExampleContent"&gt;Search Documentation&lt;/label&gt;
  &lt;!-- Flex group for alignment --&gt;
  &lt;div style="display: flex; align-items: center; gap: 8px;"&gt;
    &lt;input type="search" id="searchInputExampleContent" name="query_content" placeholder="Enter search term..." style="flex-grow: 1;"&gt;
    &lt;button type="submit" class="secondary" aria-label="Search Documentation"&gt;Search&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                 <ul>
                    <li>Follows Text Input principles (for input and button).</li>
                    <li><code>type="search"</code> may provide 'clear' button.</li>
                    <li>Visible label recommended.</li>
                    <li>Button association usually automatic with `type="submit"`.</li>
                    <li>Use <strong>`aria-live` region</strong> for announcing dynamic results if applicable. (WCAG 4.1.3)</li>
                    <li><strong>`role="search"`</strong> provides landmark.</li>
                 </ul>
            </div>
        </div>

         <div class="form-control-item" data-keywords="textarea multi-line text input large comments feedback">
            <h2>Textarea</h2>
            <p>Input for multi-line text entry.</p>
            <div class="form-group">
                <label for="textareaExample">Your Comments</label>
                <textarea id="textareaExample" name="comments" rows="5" placeholder="Enter your feedback here..." aria-describedby="commentsHelp"></textarea>
                <small id="commentsHelp" class="help-text">Max 500 characters.</small>
            </div>
            <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="textareaExample"&gt;Your Comments&lt;/label&gt;
  &lt;textarea id="textareaExample" name="comments" rows="5" placeholder="Enter your feedback here..." aria-describedby="commentsHelp"&gt;&lt;/textarea&gt;
  &lt;small id="commentsHelp" class="help-text"&gt;Max 500 characters.&lt;/small&gt;
&lt;/div&gt;</code></pre>
             <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                    <li>Follows Text Input principles.</li>
                    <li>Inherently accessible with label.</li>
                    <li>Specify constraints (e.g., `maxlength`) if applicable.</li>
                    <li>Ensure sufficient height for usability.</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" data-keywords="checkbox check box toggle boolean option select multiple">
            <h2>Checkbox</h2>
            <p>Allows users to select zero or more options.</p>
            <fieldset class="checkbox-group">
                 <legend>Notification Preferences</legend>
                 <div class="form-group">
                    <input type="checkbox" id="checkNews" name="notifications" value="newsletter" checked>
                    <label for="checkNews" class="inline-label">Subscribe to Newsletter</label>
                 </div>
                 <div class="form-group">
                     <input type="checkbox" id="checkUpdates" name="notifications" value="updates">
                     <label for="checkUpdates" class="inline-label">Receive Product Updates</label>
                 </div>
                 <div class="form-group">
                     <input type="checkbox" id="checkOffers" name="notifications" value="offers" disabled>
                     <label for="checkOffers" class="inline-label">Get Special Offers (Unavailable)</label>
                 </div>
            </fieldset>
             <pre><code>&lt;fieldset class="checkbox-group"&gt;
  &lt;legend&gt;Notification Preferences&lt;/legend&gt;
  &lt;div class="form-group"&gt;
    &lt;input type="checkbox" id="checkNews" name="notifications" value="newsletter" checked&gt;
    &lt;label for="checkNews" class="inline-label"&gt;Subscribe to Newsletter&lt;/label&gt;
  &lt;/div&gt;
  &lt;!-- ... other checkboxes ... --&gt;
&lt;/fieldset&gt;</code></pre>
             <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                    <li><strong>Label Association:</strong> CRITICAL (<code>for</code>/<code>id</code>).</li>
                    <li><strong>Grouping:</strong> Use <code>&lt;fieldset&gt;</code>/<code>&lt;legend&gt;</code> for related checkboxes. (WCAG 1.3.1, 3.3.2)</li>
                    <li><strong>State:</strong> `checked` attribute. Announced by screen readers.</li>
                    <li><strong>Keyboard:</strong> Spacebar toggles.</li>
                    <li><strong>Custom Styling:</strong> Ensure hidden native input is focusable, label targets it, visual state matches programmatic state.</li>
                    <li><strong>Target Size:</strong> Ensure label provides sufficient clickable area. (WCAG 2.5.5)</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" data-keywords="radio button option select single choice">
            <h2>Radio Buttons</h2>
            <p>Allows users to select exactly one option.</p>
             <fieldset class="radio-group">
                 <legend>Preferred Contact Method <span class="required-indicator" aria-hidden="true">*</span></legend>
                 <div class="form-group">
                    <input type="radio" id="contactEmail" name="contact_method" value="email" checked required aria-required="true">
                    <label for="contactEmail" class="inline-label">Email</label>
                 </div>
                 <div class="form-group">
                    <input type="radio" id="contactPhone" name="contact_method" value="phone" required aria-required="true">
                    <label for="contactPhone" class="inline-label">Phone</label>
                 </div>
                 <div class="form-group">
                     <input type="radio" id="contactMail" name="contact_method" value="mail" required aria-required="true" disabled>
                     <label for="contactMail" class="inline-label">Postal Mail (Unavailable)</label>
                 </div>
            </fieldset>
             <pre><code>&lt;fieldset class="radio-group"&gt;
  &lt;legend&gt;Preferred Contact Method &lt;span class="required-indicator" aria-hidden="true"&gt;*&lt;/span&gt;&lt;/legend&gt;
  &lt;div class="form-group"&gt;
    &lt;input type="radio" id="contactEmail" name="contact_method" value="email" checked required aria-required="true"&gt;
    &lt;label for="contactEmail" class="inline-label"&gt;Email&lt;/label&gt;
  &lt;/div&gt;
  &lt;!-- ... other radio buttons ... --&gt;
&lt;/fieldset&gt;</code></pre>
             <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                    <li><strong>Label Association:</strong> CRITICAL (<code>for</code>/<code>id</code>).</li>
                    <li><strong>Grouping:</strong> MUST use <code>&lt;fieldset&gt;</code>/<code>&lt;legend&gt;</code>.</li>
                    <li><strong>`name` Attribute:</strong> MUST be identical for all radios in a group. (WCAG 1.3.1, 4.1.2)</li>
                    <li><strong>State:</strong> `checked` attribute. Announced by screen readers.</li>
                    <li><strong>Keyboard:</strong> Arrow keys navigate within group; Spacebar selects. Tab moves in/out of group.</li>
                    <li><strong>Default Selection:</strong> Recommended.</li>
                    <li><strong>Target Size:</strong> Ensure label provides sufficient clickable area. (WCAG 2.5.5)</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" data-keywords="select dropdown drop down list options picker menu">
            <h2>Select (Dropdown)</h2>
            <p>Allows users to select one option from a list.</p>
            <div class="form-group">
                <label for="selectExample">Select Your Country</label>
                <select id="selectExample" name="country">
                    <option value="" disabled selected>--Please choose an option--</option>
                    <optgroup label="North America">
                        <option value="CA">Canada</option>
                        <option value="MX">Mexico</option>
                        <option value="US">United States</option>
                    </optgroup>
                    <optgroup label="Europe">
                        <option value="FR">France</option>
                        <option value="DE">Germany</option>
                        <option value="UK">United Kingdom</option>
                    </optgroup>
                     <option value="OTHER">Other</option>
                </select>
            </div>
            <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="selectExample"&gt;Select Your Country&lt;/label&gt;
  &lt;select id="selectExample" name="country"&gt;
    &lt;option value="" disabled selected&gt;--Please choose an option--&lt;/option&gt;
    &lt;optgroup label="North America"&gt; &lt;!-- Group related options --&gt;
      &lt;option value="CA"&gt;Canada&lt;/option&gt;
      &lt;!-- ... --&gt;
    &lt;/optgroup&gt;
    &lt;!-- ... --&gt;
  &lt;/select&gt;
&lt;/div&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                    <li><strong>Label Association:</strong> Essential (<code>for</code>/<code>id</code>).</li>
                    <li><strong>Native Element:</strong> Generally very accessible.</li>
                    <li><strong>Options:</strong> Use <code>&lt;option&gt;</code> (text is read, `value` submitted).</li>
                    <li><strong>Option Groups:</strong> Use <code>&lt;optgroup&gt;</code> for semantic grouping.</li>
                    <li><strong>Placeholder Option:</strong> Use a disabled, selected first option with `value=""`.</li>
                    <li><strong>Keyboard:</strong> Space/Alt+Down opens; Arrows navigate; Enter selects; Typing jumps.</li>
                    <li><strong>Custom Selects:</strong> Avoid unless necessary; complex to make accessible.</li>
                    <li><strong>Target Size:</strong> Ensure min. 44px height. (WCAG 2.5.5)</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" data-keywords="file input upload attachment select image document">
            <h2>File Input / Upload</h2>
            <p>Allows users to select files for upload.</p>
            <div class="form-group">
                 <label for="fileInputExample">Upload Your Resume (PDF or DOCX)</label>
                 <div class="file-input-wrapper">
                    <button type="button" class="button-like secondary" aria-hidden="true" tabindex="-1">Choose File</button>
                    <span class="file-name-display" id="fileNameDisplayResume">No file chosen</span>
                    <input type="file" id="fileInputExample" name="resume" accept=".pdf,.docx,.doc" aria-describedby="fileHelp resumeConstraints" onchange="document.getElementById('fileNameDisplayResume').textContent = this.files.length > 0 ? this.files[0].name : 'No file chosen';">
                </div>
                <small id="fileHelp" class="help-text">Max file size: 5MB.</small>
                <div id="resumeConstraints" class="help-text">Accepted formats: PDF, DOC, DOCX.</div>
            </div>
            <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="fileInputExample"&gt;Upload Your Resume (PDF or DOCX)&lt;/label&gt;
  &lt;div class="file-input-wrapper"&gt;
    &lt;button type="button" class="button-like secondary" aria-hidden="true" tabindex="-1"&gt;Choose File&lt;/button&gt;
    &lt;span class="file-name-display" id="fileNameDisplayResume"&gt;No file chosen&lt;/span&gt;
    &lt;input type="file" id="fileInputExample" name="resume" accept=".pdf,.docx,.doc" aria-describedby="fileHelp resumeConstraints" onchange="..."&gt;
  &lt;/div&gt;
  &lt;!-- ... help text ... --&gt;
&lt;/div&gt;</code></pre>
            <p><em>Note: Basic styling provided. Robust JS often needed.</em></p>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                     <li><strong>Label Association:</strong> Essential (<code>for</code>/<code>id</code>).</li>
                     <li><strong>Styling Challenges:</strong> Often requires hiding native input and styling a trigger button/label.</li>
                     <li><strong>Focus Management:</strong> Ensure focus lands on trigger; activation opens file browser. (WCAG 2.1.1, 2.4.7)</li>
                     <li><strong>Feedback:</strong> Display selected filename(s). Clearly state constraints (`accept`, text).</li>
                     <li><strong>Error Handling:</strong> Indicate errors accessibly (`aria-invalid`, `aria-describedby`).</li>
                     <li><strong>Target Size:</strong> Visible trigger element must meet min. 44px size. (WCAG 2.5.5)</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" data-keywords="date input picker calendar select day month year">
            <h2>Date Input</h2>
            <p>Allows users to select a specific date.</p>
            <div class="form-group">
                <label for="dateInputExample">Appointment Date</label>
                <input type="date" id="dateInputExample" name="appointment_date" min="2024-01-01" max="2025-12-31" aria-describedby="dateHelp">
                <small id="dateHelp" class="help-text">Format: MM/DD/YYYY. Use calendar or type.</small>
            </div>
            <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="dateInputExample"&gt;Appointment Date&lt;/label&gt;
  &lt;input type="date" id="dateInputExample" name="appointment_date" min="2024-01-01" max="2025-12-31" aria-describedby="dateHelp"&gt;
  &lt;small id="dateHelp" class="help-text"&gt;Format: MM/DD/YYYY...&lt;/small&gt;
&lt;/div&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                     <li><strong>Label Association:</strong> Essential (<code>for</code>/<code>id</code>).</li>
                     <li><strong>Native Picker Variance:</strong> Accessibility varies widely by browser/OS. TEST.</li>
                     <li><strong>Format Hint:</strong> Provide format hint (<code>aria-describedby</code>). Note: Browsers often enforce a specific format (like YYYY-MM-DD) for the *value* but may *display* it differently based on locale. The hint should ideally match the expected *input* format if typing.</li>
                     <li><strong>Keyboard Input:</strong> Should allow direct typing.</li>
                     <li><strong>Custom Pickers:</strong> Consider accessible libraries if native pickers fail.</li>
                     <li><strong>Min/Max Dates:</strong> Use `min`/`max` attributes.</li>
                     <li><strong>Target Size:</strong> Ensure min. 44px height. (WCAG 2.5.5)</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" data-keywords="time input picker clock select hour minute second">
            <h2>Time Input</h2>
            <p>Allows users to select a specific time.</p>
            <div class="form-group">
                 <label for="timeInputExample">Meeting Start Time</label>
                 <input type="time" id="timeInputExample" name="start_time" min="09:00" max="17:00" step="1800" aria-describedby="timeHelp">
                 <small id="timeHelp" class="help-text">Select time (9AM-5PM, 30min intervals).</small>
            </div>
             <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="timeInputExample"&gt;Meeting Start Time&lt;/label&gt;
  &lt;input type="time" id="timeInputExample" name="start_time" min="09:00" max="17:00" step="1800" aria-describedby="timeHelp"&gt;
  &lt;small id="timeHelp" class="help-text"&gt;Select time...&lt;/small&gt;
&lt;/div&gt;</code></pre>
             <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                 <ul>
                    <li><strong>Label Association:</strong> Essential (<code>for</code>/<code>id</code>).</li>
                    <li><strong>Native Picker Variance:</strong> Varies by browser. TEST.</li>
                    <li><strong>Format Hint:</strong> Provide hints (<code>aria-describedby</code>).</li>
                    <li><strong>Keyboard Input:</strong> Should allow direct typing.</li>
                    <li><strong>Custom Pickers:</strong> Consider accessible libraries if needed.</li>
                     <li><strong>Min/Max/Step:</strong> Use `min`/`max`/`step` attributes.</li>
                     <li><strong>Target Size:</strong> Ensure min. 44px height. (WCAG 2.5.5)</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" data-keywords="datetime date time local input picker timestamp">
            <h2>Date and Time Input</h2>
            <p>Allows users to select both date and time (local).</p>
            <div class="form-group">
                <label for="datetimeInputExample">Event Start Date/Time</label>
                <input type="datetime-local" id="datetimeInputExample" name="event_start" aria-describedby="datetimeHelp">
                <small id="datetimeHelp" class="help-text">Select date and local time.</small>
            </div>
            <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="datetimeInputExample"&gt;Event Start Date/Time&lt;/label&gt;
  &lt;input type="datetime-local" id="datetimeInputExample" name="event_start" aria-describedby="datetimeHelp"&gt;
  &lt;small id="datetimeHelp" class="help-text"&gt;Select date and local time.&lt;/small&gt;
&lt;/div&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                     <li><strong>Label Association:</strong> Essential (<code>for</code>/<code>id</code>).</li>
                    <li><strong>Native Picker Variance:</strong> Varies significantly. TEST.</li>
                    <li><strong>Format Hint:</strong> Provide hints (value format YYYY-MM-DDTHH:mm).</li>
                    <li><strong>Keyboard/Custom Pickers:</strong> Similar considerations as Date/Time.</li>
                    <li><strong>Timezones:</strong> `datetime-local` excludes timezone info. Clarify if needed.</li>
                    <li><strong>Target Size:</strong> Ensure min. 44px height. (WCAG 2.5.5)</li>
                </ul>
            </div>
        </div>

         <div class="form-control-item" data-keywords="month input picker select year month">
            <h2>Month Input</h2>
            <p>Allows users to select month and year.</p>
            <div class="form-group">
                 <label for="monthInputExample">Billing Cycle Month</label>
                 <input type="month" id="monthInputExample" name="billing_month" min="2024-01" max="2025-12" aria-describedby="monthHelp">
                 <small id="monthHelp" class="help-text">Select billing month/year (YYYY-MM).</small>
            </div>
            <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="monthInputExample"&gt;Billing Cycle Month&lt;/label&gt;
  &lt;input type="month" id="monthInputExample" name="billing_month" min="2024-01" max="2025-12" aria-describedby="monthHelp"&gt;
   &lt;small id="monthHelp" class="help-text"&gt;Select... (YYYY-MM).&lt;/small&gt;
&lt;/div&gt;</code></pre>
             <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                 <ul>
                    <li><strong>Label Association:</strong> Essential (<code>for</code>/<code>id</code>).</li>
                    <li><strong>Native Picker Variance:</strong> Varies. TEST.</li>
                    <li><strong>Format Hint:</strong> Value format YYYY-MM.</li>
                    <li><strong>Keyboard/Custom Pickers:</strong> Similar considerations as Date.</li>
                    <li><strong>Target Size:</strong> Ensure min. 44px height. (WCAG 2.5.5)</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" data-keywords="week input picker select year week">
            <h2>Week Input</h2>
            <p>Allows users to select week and year.</p>
            <div class="form-group">
                <label for="weekInputExample">Select Project Week</label>
                <input type="week" id="weekInputExample" name="project_week" min="2024-W01" max="2025-W52" aria-describedby="weekHelp">
                <small id="weekHelp" class="help-text">Select project week (YYYY-W##).</small>
            </div>
            <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="weekInputExample"&gt;Select Project Week&lt;/label&gt;
  &lt;input type="week" id="weekInputExample" name="project_week" min="2024-W01" max="2025-W52" aria-describedby="weekHelp"&gt;
  &lt;small id="weekHelp" class="help-text"&gt;Select... (YYYY-W##).&lt;/small&gt;
&lt;/div&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                    <li><strong>Label Association:</strong> Essential (<code>for</code>/<code>id</code>).</li>
                    <li><strong>Native Picker Variance:</strong> Varies. TEST.</li>
                    <li><strong>Format Hint:</strong> Value format YYYY-W##.</li>
                     <li><strong>Keyboard/Custom Pickers:</strong> Similar considerations as Date.</li>
                     <li><strong>Target Size:</strong> Ensure min. 44px height. (WCAG 2.5.5)</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" data-keywords="number numeric input integer float quantity amount spinner">
            <h2>Number Input</h2>
            <p>Input for numerical values.</p>
             <div class="form-group">
                 <label for="numberInputExample">Quantity</label>
                 <input type="number" id="numberInputExample" name="quantity" min="1" max="10" step="1" value="1" aria-describedby="numberHelp">
                 <small id="numberHelp" class="help-text">Enter whole number (1-10).</small>
            </div>
            <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="numberInputExample"&gt;Quantity&lt;/label&gt;
  &lt;input type="number" id="numberInputExample" name="quantity" min="1" max="10" step="1" value="1" aria-describedby="numberHelp"&gt;
  &lt;small id="numberHelp" class="help-text"&gt;Enter whole number (1-10).&lt;/small&gt;
&lt;/div&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                 <ul>
                    <li><strong>Label Association:</strong> Essential (<code>for</code>/<code>id</code>).</li>
                    <li><strong>Type Attribute:</strong> `type="number"` triggers numeric keyboard.</li>
                    <li><strong>Spinner Controls:</strong> Accessibility varies. Test. Ensure direct typing works.</li>
                    <li><strong>Min/Max/Step:</strong> Use attributes to define constraints. (WCAG 3.3.2)</li>
                    <li><strong>Validation:</strong> Native validation checks format/range.</li>
                    <li><strong>Target Size:</strong> Ensure min. 44px height. (WCAG 2.5.5)</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" data-keywords="range input slider select value volume brightness percentage">
            <h2>Range Input (Slider)</h2>
            <p>Allows selection of a value within a range.</p>
            <div class="form-group range-group">
                <label for="rangeInputExample">Volume</label>
                <input type="range" id="rangeInputExample" name="volume" min="0" max="100" step="1" value="50" aria-describedby="rangeValueHelp">
                <output for="rangeInputExample" class="range-value" id="rangeValueOutput">50</output>
                <small id="rangeValueHelp" class="help-text visually-hidden">Use arrows. Value displayed.</small>
            </div>
            <script> /* JS included in main script block */ </script>
            <pre><code>&lt;div class="form-group range-group"&gt;
  &lt;label for="rangeInputExample"&gt;Volume&lt;/label&gt;
  &lt;input type="range" id="rangeInputExample" name="volume" min="0" max="100" step="1" value="50" aria-describedby="rangeValueHelp"&gt;
  &lt;output for="rangeInputExample" class="range-value" id="rangeValueOutput"&gt;50&lt;/output&gt;
  &lt;small id="rangeValueHelp" class="help-text visually-hidden"&gt;Use arrows...&lt;/small&gt;
&lt;/div&gt;
&lt;script&gt; /* JS updates output */ &lt;/script&gt;</code></pre>
             <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                 <ul>
                    <li><strong>Label Association:</strong> Essential (<code>for</code>/<code>id</code>).</li>
                    <li><strong>Communicating Value:</strong> CRITICAL. Must provide current value accessibly (e.g., update text via JS using `<output>`, use `aria-valuetext`). (WCAG 4.1.2)</li>
                    <li><strong>Keyboard:</strong> Arrow keys adjust; Home/End jump.</li>
                    <li><strong>Min/Max/Step:</strong> Define range/increments.</li>
                    <li><strong>Target Size:</strong> Ensure slider thumb/track provides adequate target area (min height helps). (WCAG 2.5.5)</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" data-keywords="toggle switch on off boolean checkbox role switch">
             <h2>Toggle Switch</h2>
             <p>Visually distinct on/off control.</p>
             <div class="form-group" style="display: flex; align-items: center; gap: var(--spacing-unit);">
                 <label for="toggleSwitchExample" id="toggleSwitchLabel" class="inline-label" style="margin-bottom: 0;">Enable Feature X</label>
                 <label class="switch" aria-labelledby="toggleSwitchLabel">
                   <input type="checkbox" id="toggleSwitchExample" name="feature_x_enabled" role="switch">
                   <span class="slider"></span>
                 </label>
            </div>
             <pre><code>&lt;div class="form-group" style="display: flex; align-items: center; gap: 8px;"&gt;
  &lt;label for="toggleSwitchExample" id="toggleSwitchLabel" class="inline-label" style="margin-bottom: 0;"&gt;Enable Feature X&lt;/label&gt;
  &lt;label class="switch" aria-labelledby="toggleSwitchLabel"&gt;
    &lt;input type="checkbox" id="toggleSwitchExample" name="feature_x_enabled" role="switch" aria-checked="false"&gt;
    &lt;span class="slider"&gt;&lt;/span&gt;
  &lt;/label&gt;
&lt;/div&gt;
&lt;script&gt; /* JS syncs aria-checked */ &lt;/script&gt;</code></pre>
             <div class="accessibility-notes">
                 <h3>Accessibility Notes</h3>
                 <ul>
                     <li><strong>Underlying Element:</strong> Use hidden checkbox for state.</li>
                     <li><strong>Label Association:</strong> Associate label with checkbox (<code>for</code>/<code>id</code> or wrap). `aria-labelledby` on switch points to label.</li>
                     <li><strong>ARIA Role:</strong> Use `role="switch"` on input or interactive container. (WCAG 4.1.2)</li>
                     <li><strong>ARIA State:</strong> Use `aria-checked="true/false"`, kept in sync via JS.</li>
                     <li><strong>Keyboard Interaction:</strong> Spacebar toggles.</li>
                     <li><strong>Visual Design:</strong> Clear on/off states, sufficient contrast.</li>
                     <li><strong>Focus Indicator:</strong> Clear focus style on switch.</li>
                     <li><strong>Target Size:</strong> Clickable switch element needs min. 44px size. (WCAG 2.5.5)</li>
                 </ul>
             </div>
         </div>


        <div class="form-control-item" data-keywords="hidden input invisible data parameter form submission">
            <h2>Hidden Input</h2>
            <p>Non-visible input for submitting data.</p>
            <form>
                <input type="hidden" id="csrfToken" name="_csrf_token" value="aBcDeF12345GHIjkl">
                <input type="hidden" id="sessionId" name="session_id" value="zyXwVu98765TsRqPo">
            </form>
             <pre><code>&lt;input type="hidden" id="csrfToken" name="_csrf_token" value="..."&gt;
&lt;input type="hidden" id="sessionId" name="session_id" value="..."&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                    <li><strong>No User Interaction:</strong> Standard accessibility concerns (label, focus, target size) don't apply directly.</li>
                    <li><strong>Purposeful Use:</strong> Use appropriately (tokens, tracking codes), not to hide user-controllable info.</li>
                    <li><strong>Name and Value:</strong> Ensure correct `name`/`value` for submission.</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" data-keywords="button submit reset cancel action click interactive">
            <h2>Buttons</h2>
            <p>Elements to trigger actions.</p>
            <div class="form-group">
                <button type="submit">Submit Form</button>
                <button type="reset" class="secondary">Reset Fields</button>
                <button type="button" class="secondary">Cancel</button>
                <button type="button" disabled>Disabled Action</button>
                <a href="#some-section" class="button-like secondary" role="button">Link as Button</a>
            </div>
             <pre><code>&lt;button type="submit"&gt;Submit Form&lt;/button&gt;
&lt;button type="reset" class="secondary"&gt;Reset Fields&lt;/button&gt;
&lt;button type="button" class="secondary"&gt;Cancel&lt;/button&gt;
&lt;button type="button" disabled&gt;Disabled Action&lt;/button&gt;
&lt;a href="..." class="button-like secondary" role="button"&gt;Link as Button&lt;/a&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                    <li><strong>Use <code>&lt;button&gt;</code> Element:</strong> Preferred for actions.</li>
                    <li><strong>Clear Labels:</strong> Describe the action clearly. (WCAG 2.4.6, 3.3.2)</li>
                    <li><strong>`type` Attribute:</strong> Explicitly set `submit`, `reset`, or `button`. Default is `submit`. Use `reset` cautiously.</li>
                     <li><strong>Keyboard Accessibility:</strong> Focusable; activate with Enter/Space. (WCAG 2.1.1)</li>
                     <li><strong>Focus Indicator:</strong> Ensure clear visual focus. (WCAG 2.4.7, 2.4.11)</li>
                     <li><strong>Disabled State:</strong> Use `disabled` attribute; style clearly.</li>
                     <li><strong>Links Styled as Buttons:</strong> Use `<button>` if it triggers an action. If `<a>`, ensure link behavior (Enter activates) or add `role="button"` if appropriate (but `<button>` is better).</li>
                     <li><strong>Target Size:</strong> Ensure min. 44px size. (WCAG 2.5.5)</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" data-keywords="modal dialog popup window overlay accessible focus trap">
            <h2>Modal Dialog</h2>
            <p>A window overlaid on the primary content, requiring user interaction. Must trap focus and be dismissible.</p>
            <button type="button" id="openDialogBtn" data-dialog-id="addressDialog">
                Open Address Dialog
            </button>

            <div id="dialog_layer" class="dialog-overlay hidden">
                <div role="dialog"
                     id="addressDialog"
                     aria-labelledby="dialog1_label"
                     aria-modal="true"
                     class="dialog"> <button type="button" class="dialog-close-btn" aria-label="Close dialog">&times;</button>
                    <h2 id="dialog1_label" class="dialog_label">
                        Add Delivery Address
                    </h2>
                    <form class="dialog_form">
                        <div class="form-group">
                            <label for="dialog-street">Street:</label>
                            <input type="text" id="dialog-street" class="wide_input">
                        </div>
                        <div class="form-group">
                            <label for="dialog-city">City:</label>
                            <input type="text" id="dialog-city" class="city_input">
                        </div>
                        <div class="form-group">
                            <label for="dialog-state">State:</label>
                            <input type="text" id="dialog-state" class="state_input">
                        </div>
                         <div class="form-group">
                            <label for="dialog-zip">Zip:</label>
                            <input type="text" id="dialog-zip" class="zip_input">
                        </div>
                        </form>
                    <div class="dialog_form_actions">
                        <button type="button" class="dialog-add-btn">Add</button>
                        <button type="button" class="dialog-cancel-btn secondary">Cancel</button>
                    </div>
                </div>
                 </div>

            <pre><code>&lt;!-- Trigger Button --&gt;
&lt;button type="button" id="openDialogBtn" data-dialog-id="addressDialog"&gt;
  Open Address Dialog
&lt;/button&gt;

&lt;!-- Dialog Layer / Overlay (Initially Hidden) --&gt;
&lt;div id="dialog_layer" class="dialog-overlay hidden"&gt;
  &lt;!-- Dialog Element --&gt;
  &lt;div role="dialog"
       id="addressDialog"
       aria-labelledby="dialog1_label"
       aria-modal="true"
       class="dialog"&gt;

    &lt;!-- Explicit Close Button --&gt;
    &lt;button type="button" class="dialog-close-btn" aria-label="Close dialog"&gt;&times;&lt;/button&gt;

    &lt;h2 id="dialog1_label" class="dialog_label"&gt;
      Add Delivery Address
    &lt;/h2&gt;

    &lt;form class="dialog_form"&gt;
      &lt;!-- Form fields ... --&gt;
    &lt;/form&gt;

    &lt;div class="dialog_form_actions"&gt;
      &lt;button type="button" class="dialog-add-btn"&gt;Add&lt;/button&gt;
      &lt;button type="button" class="dialog-cancel-btn secondary"&gt;Cancel&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JS updated to handle overlay and close button --&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes (Modal Dialog)</h3>
                <ul>
                    <li><strong>Role & State:</strong> Use `role="dialog"` and `aria-modal="true"`.</li>
                    <li><strong>Labeling:</strong> Provide a label using `aria-labelledby` pointing to a visible heading (`h2` preferred).</li>
                    <li><strong>Description (Optional):</strong> Use `aria-describedby` to point to descriptive text if needed.</li>
                    <li><strong>Visibility & Overlay:</strong> Dialog and its overlay should be hidden initially. Use JS to show/hide the overlay. The overlay visually obscures the background content.</li>
                    <li><strong>Focus Management (CRITICAL):**
                        <ul>
                            <li>When opened, focus moves inside the dialog (e.g., first input or close button).</li>
                            <li>Focus is trapped within the dialog.</li>
                            <li>When closed, focus returns to the trigger element.</li>
                        </ul>
                        (WCAG 2.4.3 Focus Order, 2.1.1 Keyboard)
                    </li>
                    <li><strong>Keyboard Dismissal:</strong> Allow closing via Escape key.</li>
                    <li><strong>Dismiss Button:</strong> Provide a clearly labeled, keyboard-accessible close button (e.g., using `&times;` with an `aria-label`).</li>
                    <li><strong>Background Inertness:** Use JS focus trapping. Optionally use `aria-hidden="true"` on background elements or the `<dialog>` element's native behavior.</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" data-keywords="accordion disclosure collapse expand section toggle">
            <h2>Accordion</h2>
            <p>A vertically stacked set of interactive headings that each reveal an associated section of content.</p>
            <div class="accordion" id="myAccordion">
                <div class="accordion-item">
                    <h3 style="margin: 0;">
                        <button type="button"
                                class="accordion-button"
                                aria-expanded="false"
                                aria-controls="accordion-panel-1"
                                id="accordion-button-1">
                            Section 1 Title
                        </button>
                    </h3>
                    <div id="accordion-panel-1" role="region" aria-labelledby="accordion-button-1" class="accordion-panel hidden">
                        <p>Content for section 1. This can include text, images, or other elements.</p>
                    </div>
                </div>
                <div class="accordion-item">
                     <h3 style="margin: 0;">
                        <button type="button"
                                class="accordion-button"
                                aria-expanded="false"
                                aria-controls="accordion-panel-2"
                                id="accordion-button-2">
                            Section 2 Title
                        </button>
                    </h3>
                    <div id="accordion-panel-2" role="region" aria-labelledby="accordion-button-2" class="accordion-panel hidden">
                        <p>Content for section 2. More details here.</p>
                        <ul><li>List item</li><li>Another item</li></ul>
                    </div>
                </div>
                 <div class="accordion-item">
                     <h3 style="margin: 0;">
                        <button type="button"
                                class="accordion-button"
                                aria-expanded="false"
                                aria-controls="accordion-panel-3"
                                id="accordion-button-3">
                            Section 3 Title
                        </button>
                    </h3>
                    <div id="accordion-panel-3" role="region" aria-labelledby="accordion-button-3" class="accordion-panel hidden">
                        <p>Content for section 3.</p>
                    </div>
                </div>
            </div>
            <pre><code>&lt;div class="accordion" id="myAccordion"&gt;
  &lt;div class="accordion-item"&gt;
    &lt;h3 style="margin: 0;"&gt; &lt;!-- Use appropriate heading level --&gt;
      &lt;button type="button"
              class="accordion-button"
              aria-expanded="false" &lt;!-- JS updates this --&gt;
              aria-controls="accordion-panel-1" &lt;!-- Points to panel ID --&gt;
              id="accordion-button-1"&gt; &lt;!-- ID for panel's aria-labelledby --&gt;
        Section 1 Title
      &lt;/button&gt;
    &lt;/h3&gt;
    &lt;div id="accordion-panel-1"
         role="region" &lt;!-- Panel is a region --&gt;
         aria-labelledby="accordion-button-1" &lt;!-- Labeled by button --&gt;
         class="accordion-panel hidden"&gt; &lt;!-- Start hidden --&gt;
      &lt;p&gt;Content for section 1...&lt;/p&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;!-- More accordion items... --&gt;
&lt;/div&gt;

&lt;!-- JavaScript (see main script block) handles:
     - Toggling aria-expanded on button click
     - Showing/hiding the associated panel
     - Optional: Keyboard navigation (Arrows, Home, End) between buttons
     - Optional: Allowing only one panel open at a time
--&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes (Accordion)</h3>
                <ul>
                    <li><strong>Structure:</strong> Use a heading element (<code>h2</code>, <code>h3</code>, etc.) containing a <code>&lt;button&gt;</code> for each accordion header. The associated content panel should follow immediately after its header.</li>
                    <li><strong>Button Attributes:</strong>
                        <ul>
                            <li><code>aria-expanded="true|false"</code>: Indicates whether the panel controlled by the button is visible (true) or hidden (false). Must be updated by JS.</li>
                            <li><code>aria-controls="panel_id"</code>: Points to the `id` of the content panel that the button controls.</li>
                            <li><code>id="button_id"</code>: Each button needs a unique ID.</li>
                        </ul>
                    </li>
                    <li><strong>Panel Attributes:</strong>
                        <ul>
                            <li><code>role="region"</code>: Identifies the panel as a landmark region.</li>
                            <li><code>aria-labelledby="button_id"</code>: Associates the panel content with its controlling button's text.</li>
                            <li><code>id="panel_id"</code>: Each panel needs a unique ID referenced by `aria-controls`.</li>
                            <li>Should be hidden initially (e.g., `display: none` or `class="hidden"`).</li>
                        </ul>
                    </li>
                    <li><strong>Keyboard Interaction:</strong>
                        <ul>
                            <li>Buttons must be focusable (Tab/Shift+Tab).</li>
                            <li>Enter/Space activates the button, toggling the panel and `aria-expanded` state.</li>
                            <li>(Optional but recommended) Down/Up arrows should move focus between accordion buttons. Home/End keys should move focus to the first/last button.</li>
                        </ul>
                        (WCAG 2.1.1 Keyboard)
                    </li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" data-keywords="alert notification message status assertive polite live region">
            <h2>Alert</h2>
            <p>Provides brief, important, and usually time-sensitive information. Often appears dynamically.</p>
            <button type="button" id="triggerAlertBtn">Trigger Alert</button>
            <div id="alertContainer">
                </div>
            <pre><code>&lt;!-- Button to trigger the alert (for demo) --&gt;
&lt;button type="button" id="triggerAlertBtn"&gt;Trigger Alert&lt;/button&gt;

&lt;!-- Container where the alert will appear --&gt;
&lt;div id="alertContainer"&gt;&lt;/div&gt;

&lt;!-- Example Alert Structure (added via JS) --&gt;
&lt;div class="alert" role="alert"&gt; &lt;!-- Use role="status" for less urgent messages --&gt;
  Your profile has been updated successfully!
&lt;/div&gt;

&lt;!-- JavaScript (see main script block) handles:
     - Adding the alert div to the container on button click
     - Optionally removing the alert after a timeout (use caution - ensure users have time to perceive it)
--&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes (Alert)</h3>
                <ul>
                    <li><strong>Role:</strong> Use `role="alert"`. This usually implies `aria-live="assertive"`, meaning screen readers should announce it immediately, potentially interrupting other speech.</li>
                    <li><strong>Alternative Role:</strong> For less critical updates (like "Search results updated"), use `role="status"`. This usually implies `aria-live="polite"`, meaning screen readers will announce it when they finish their current task.</li>
                    <li><strong>Dynamic Content:</strong> Alerts are typically added to the DOM dynamically via JavaScript. The presence of the `role="alert"` (or `status`) causes assistive technologies to monitor the element and announce its content when it appears or changes.</li>
                    <li><strong>Focus:</strong> Do **not** move focus to the alert when it appears. This can be disorienting. Let the screen reader announce it automatically due to the ARIA role.</li>
                    <li><strong>Content:</strong> Keep alert messages concise and clear.</li>
                    <li><strong>Dismissal:</strong> Alerts often disappear automatically or don't require explicit dismissal. If they persist and require dismissal, ensure a clear, keyboard-accessible close button is provided (like in a modal dialog, though the role remains "alert").</li>
                    <li><strong>Visibility:</strong> Ensure alerts are visually distinct (background, border, icon) but don't rely on color alone.</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" data-keywords="breadcrumb navigation path trail hierarchy site structure">
            <h2>Breadcrumb Trail</h2>
            <p>Shows the user's current location within the site hierarchy and provides links to parent pages.</p>
            <nav aria-label="Breadcrumb">
                <ol class="breadcrumb">
                    <li><a href="#">Home</a></li>
                    <li><a href="#">Products</a></li>
                    <li><a href="#">Accessories</a></li>
                    <li aria-current="page"><span>Headphones</span></li> </ol>
            </nav>
            <pre><code>&lt;nav aria-label="Breadcrumb"&gt;
  &lt;ol class="breadcrumb"&gt;
    &lt;li&gt;&lt;a href="#"&gt;Home&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href="#"&gt;Parent Page&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;span aria-current="page"&gt;Current Page&lt;/span&gt;&lt;/li&gt; &lt;!-- Current page is not a link --&gt;
  &lt;/ol&gt;
&lt;/nav&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes (Breadcrumb)</h3>
                <ul>
                    <li><strong>Navigation Landmark:</strong> Wrap the breadcrumb list in a `<nav>` element.</li>
                    <li><strong>Labeling the Nav:</strong> Provide an `aria-label="Breadcrumb"` (or similar) on the `<nav>` element to identify its purpose.</li>
                    <li><strong>List Structure:</strong> Use an ordered list (`<ol>`) as breadcrumbs represent a sequence.</li>
                    <li><strong>Links:</strong> Each breadcrumb item representing a parent page should be a link (`<a>`) pointing to that page.</li>
                    <li><strong>Current Page:</strong> The last item, representing the current page, should **not** be a link. Use a `<span>` or similar non-interactive element. Apply `aria-current="page"` to this item to programmatically identify it as the current location.</li>
                    <li><strong>Separators:</strong> Visual separators (like '/') are typically added via CSS (`::before` pseudo-element on `li + li`). They are generally decorative and should be ignored by screen readers.</li>
                    <li><strong>Clarity:</strong> Ensure link text clearly identifies the destination page.</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" data-keywords="carousel slider slideshow rotator image gallery banner">
            <h2>Carousel / Slideshow</h2>
            <p>A rotating set of content items (e.g., images, cards). Accessibility requires careful handling of controls and announcements.</p>
            <div class="carousel"
                 aria-roledescription="carousel"
                 aria-label="Featured Items Showcase">

                 <div class="carousel-status" aria-live="polite" aria-atomic="true">
                     </div>

                <div class="carousel-slides">
                    <div class="carousel-slide"
                         role="group"
                         aria-roledescription="slide"
                         aria-label="1 of 3"> <img src="https://placehold.co/600x300/f0f0f0/333?text=Slide+1" alt="Placeholder Slide 1">
                         <p>Content for Slide 1</p>
                    </div>
                    <div class="carousel-slide"
                         role="group"
                         aria-roledescription="slide"
                         aria-label="2 of 3">
                         <img src="https://placehold.co/600x300/e0e0e0/333?text=Slide+2" alt="Placeholder Slide 2">
                         <p>Content for Slide 2</p>
                    </div>
                    <div class="carousel-slide"
                         role="group"
                         aria-roledescription="slide"
                         aria-label="3 of 3">
                         <img src="https://placehold.co/600x300/d0d0d0/333?text=Slide+3" alt="Placeholder Slide 3">
                         <p>Content for Slide 3</p>
                    </div>
                </div>

                <button type="button" class="carousel-button prev" aria-label="Previous Slide">‹</button>
                <button type="button" class="carousel-button next" aria-label="Next Slide">›</button>

                <div class="carousel-pagination" role="tablist" aria-label="Slides">
                    <button type="button" role="tab" aria-selected="true" aria-controls="slide-1-content" aria-label="Slide 1"></button>
                    <button type="button" role="tab" aria-selected="false" aria-controls="slide-2-content" aria-label="Slide 2"></button>
                    <button type="button" role="tab" aria-selected="false" aria-controls="slide-3-content" aria-label="Slide 3"></button>
                </div>
            </div>
            <pre><code>&lt;!-- Wrapper with appropriate labels --&gt;
&lt;div class="carousel"
     aria-roledescription="carousel"
     aria-label="Carousel Title"&gt;

  &lt;!-- Status region for announcements --&gt;
  &lt;div class="carousel-status" aria-live="polite" aria-atomic="true"&gt;&lt;/div&gt;

  &lt;div class="carousel-slides"&gt;
    &lt;!-- Individual Slide --&gt;
    &lt;div class="carousel-slide"
         role="group" &lt;!-- Use group per slide --&gt;
         aria-roledescription="slide"
         aria-label="1 of X"&gt; &lt;!-- Update via JS --&gt;
       &lt;img src="..." alt="..."&gt;
       &lt;p&gt;Slide Content&lt;/p&gt;
    &lt;/div&gt;
    &lt;!-- More slides... --&gt;
  &lt;/div&gt;

  &lt;!-- Controls --&gt;
  &lt;button type="button" class="carousel-button prev" aria-label="Previous Slide"&gt;‹&lt;/button&gt;
  &lt;button type="button" class="carousel-button next" aria-label="Next Slide"&gt;›&lt;/button&gt;

  &lt;!-- Pagination (Optional) --&gt;
  &lt;div class="carousel-pagination" role="tablist" aria-label="Slides"&gt;
    &lt;button type="button" role="tab" aria-selected="true" aria-label="Slide 1"&gt;&lt;/button&gt;
    &lt;button type="button" role="tab" aria-selected="false" aria-label="Slide 2"&gt;&lt;/button&gt;
    &lt;!-- More pagination buttons... --&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JavaScript (see main script block) is essential for:
     - Moving slides (transforming .carousel-slides)
     - Handling prev/next button clicks
     - Handling pagination button clicks
     - Updating aria-selected on pagination tabs
     - Updating aria-label on slides ("1 of X")
     - Updating the status div for screen reader announcements
     - Stopping autoplay on focus/hover (if applicable)
     - Handling keyboard interaction for controls
--&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes (Carousel)</h3>
                <ul>
                    <li><strong>Region Role:</strong> The main container can have `role="region"` or `aria-roledescription="carousel"` along with an `aria-label` identifying the carousel's purpose.</li>
                    <li><strong>Slide Roles:</strong> Each slide container can use `role="group"` and `aria-roledescription="slide"`. Provide an `aria-label` like "Slide X of Y", updated by JS.</li>
                    <li><strong>Controls:</strong> Previous/Next buttons must be focusable `button` elements with clear `aria-label`s (e.g., "Previous Slide", "Next Slide").</li>
                    <li><strong>Pagination (Tabs):** If using pagination dots/thumbnails, implement them as a `role="tablist"`. Each dot/thumbnail button should have `role="tab"`, `aria-selected="true|false"` (updated by JS), and an `aria-label` (e.g., "Go to Slide X"). `aria-controls` can optionally point to the slide's ID if slides have unique IDs.</li>
                    <li><strong>Live Region:** Use an `aria-live="polite"` region (visually hidden) to announce slide changes (e.g., "Slide 2 of 3 displayed"). Use `aria-atomic="true"` so the whole message is read.</li>
                    <li><strong>Keyboard Interaction:** Ensure Prev/Next buttons and pagination tabs are keyboard accessible (focusable, activatable with Enter/Space). Consider allowing arrow keys to navigate slides when focus is within the carousel region (complex).</li>
                    <li><strong>Autoplay:** If the carousel autoplays, provide a mechanism to pause, stop, or hide it (WCAG 2.2.2 Pause, Stop, Hide). Autoplay should pause on keyboard focus or mouse hover within the carousel.</li>
                    <li><strong>Focus Management:** When a slide changes (especially via pagination), ensure focus behavior is predictable. Often, focus stays on the control that triggered the change.</li>
                    <li><strong>Content Accessibility:** Ensure the *content* within each slide (images, text, links) is itself accessible (e.g., alt text for images).</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" data-keywords="listbox select list options scrollable grouped rearrangeable multiselect">
            <h2>Listbox Examples</h2>
            <p>Allows selection from a list of options, similar to a native select but often used for custom UI or multi-select.</p>

            <h3>Scrollable Listbox</h3>
            <div class="listbox-container">
                <label id="lb1-label" class="listbox-label">Choose your primary skill:</label>
                <ul id="lb1"
                    tabindex="0"
                    role="listbox"
                    aria-labelledby="lb1-label"
                    aria-activedescendant=""> <li id="lb1-opt1" role="option" aria-selected="false">HTML</li>
                    <li id="lb1-opt2" role="option" aria-selected="false">CSS</li>
                    <li id="lb1-opt3" role="option" aria-selected="false">JavaScript</li>
                    <li id="lb1-opt4" role="option" aria-selected="false">React</li>
                    <li id="lb1-opt5" role="option" aria-selected="false">Angular</li>
                    <li id="lb1-opt6" role="option" aria-selected="false">Vue</li>
                    <li id="lb1-opt7" role="option" aria-selected="false">Python</li>
                    <li id="lb1-opt8" role="option" aria-selected="false">PHP</li>
                    <li id="lb1-opt9" role="option" aria-selected="false">Ruby</li>
                </ul>
            </div>
            <pre><code>&lt;!-- Scrollable Listbox --&gt;
&lt;label id="lb1-label" class="listbox-label"&gt;Choose your primary skill:&lt;/label&gt;
&lt;ul id="lb1"
    tabindex="0" &lt;!-- Make the listbox container focusable --&gt;
    role="listbox"
    aria-labelledby="lb1-label"
    aria-activedescendant=""&gt; &lt;!-- JS updates with focused option ID --&gt;

  &lt;li id="lb1-opt1" role="option" aria-selected="false"&gt;HTML&lt;/li&gt;
  &lt;li id="lb1-opt2" role="option" aria-selected="false"&gt;CSS&lt;/li&gt;
  &lt;!-- ... more options ... --&gt;
&lt;/ul&gt;

&lt;!-- JavaScript (see main script block) handles:
     - Keyboard navigation (Arrows, Home, End, PageUp/Down, Letter keys)
     - Updating aria-activedescendant to the focused option's ID
     - Updating aria-selected on click/Enter/Space
     - Scrolling the focused option into view
     - Optional: Multi-select with Shift/Ctrl keys
--&gt;</code></pre>

            <h3 style="margin-top: calc(var(--spacing-unit)*4);">Listbox with Grouped Options</h3>
             <div class="listbox-container">
                <label id="lb2-label" class="listbox-label">Choose a framework/library:</label>
                <ul id="lb2"
                    tabindex="0"
                    role="listbox"
                    aria-labelledby="lb2-label"
                    aria-activedescendant="">
                    <li role="presentation" class="listbox-group-label" id="lb2-group1-label">Frontend</li>
                    <li id="lb2-opt1" role="option" aria-selected="false">React</li>
                    <li id="lb2-opt2" role="option" aria-selected="false">Angular</li>
                    <li id="lb2-opt3" role="option" aria-selected="false">Vue</li>
                    <li role="presentation" class="listbox-group-label" id="lb2-group2-label">Backend</li>
                    <li id="lb2-opt4" role="option" aria-selected="false">Node.js</li>
                    <li id="lb2-opt5" role="option" aria-selected="false">Django</li>
                    <li id="lb2-opt6" role="option" aria-selected="false">Ruby on Rails</li>
                </ul>
            </div>
             <pre><code>&lt;!-- Grouped Listbox --&gt;
&lt;label id="lb2-label" class="listbox-label"&gt;Choose a framework/library:&lt;/label&gt;
&lt;ul id="lb2"
    tabindex="0"
    role="listbox"
    aria-labelledby="lb2-label"
    aria-activedescendant=""&gt;

  &lt;!-- Group 1 --&gt;
  &lt;li role="presentation" class="listbox-group-label" id="lb2-group1-label"&gt;Frontend&lt;/li&gt;
  &lt;li id="lb2-opt1" role="option" aria-selected="false"&gt;React&lt;/li&gt;
  &lt;li id="lb2-opt2" role="option" aria-selected="false"&gt;Angular&lt;/li&gt;
  &lt;li id="lb2-opt3" role="option" aria-selected="false"&gt;Vue&lt;/li&gt;

  &lt;!-- Group 2 --&gt;
  &lt;li role="presentation" class="listbox-group-label" id="lb2-group2-label"&gt;Backend&lt;/li&gt;
  &lt;li id="lb2-opt4" role="option" aria-selected="false"&gt;Node.js&lt;/li&gt;
  &lt;li id="lb2-opt5" role="option" aria-selected="false"&gt;Django&lt;/li&gt;
  &lt;li id="lb2-opt6" role="option" aria-selected="false"&gt;Ruby on Rails&lt;/li&gt;
&lt;/ul&gt;

&lt;!-- JS requirements similar to scrollable listbox, keyboard nav should skip group labels --&gt;</code></pre>


            <h3 style="margin-top: calc(var(--spacing-unit)*4);">Listbox with Rearrangeable Options (Simplified)</h3>
            <p><em>Note: Full keyboard support for rearranging is complex and omitted here. This example focuses on structure and basic interaction.</em></p>
            <div class="rearrange-listbox-wrapper">
                 <div class="listbox-container" style="flex-grow: 1;">
                    <label id="lb3-label" class="listbox-label">Prioritize Tasks:</label>
                    <ul id="lb3"
                        tabindex="0"
                        role="listbox"
                        aria-labelledby="lb3-label"
                        aria-multiselectable="false"
                        aria-activedescendant="">
                        <li id="lb3-opt1" role="option" aria-selected="false">Task A: Design Mockups</li>
                        <li id="lb3-opt2" role="option" aria-selected="false">Task B: Develop API</li>
                        <li id="lb3-opt3" role="option" aria-selected="false">Task C: Write Tests</li>
                        <li id="lb3-opt4" role="option" aria-selected="false">Task D: User Documentation</li>
                    </ul>
                </div>
                 <div class="rearrange-buttons">
                     <button type="button" aria-label="Move selected item up" class="move-up-btn">▲</button>
                     <button type="button" aria-label="Move selected item down" class="move-down-btn">▼</button>
                 </div>
            </div>
             <pre><code>&lt;!-- Rearrangeable Listbox (Simplified) --&gt;
&lt;div class="rearrange-listbox-wrapper"&gt;
  &lt;div class="listbox-container" style="flex-grow: 1;"&gt;
    &lt;label id="lb3-label" class="listbox-label"&gt;Prioritize Tasks:&lt;/label&gt;
    &lt;ul id="lb3"
        tabindex="0"
        role="listbox"
        aria-labelledby="lb3-label"
        aria-multiselectable="false" &lt;!-- Or true --&gt;
        aria-activedescendant=""&gt;
      &lt;li id="lb3-opt1" role="option" aria-selected="false"&gt;Task A...&lt;/li&gt;
      &lt;li id="lb3-opt2" role="option" aria-selected="false"&gt;Task B...&lt;/li&gt;
      &lt;!-- ... --&gt;
    &lt;/ul&gt;
  &lt;/div&gt;
  &lt;div class="rearrange-buttons"&gt;
    &lt;button type="button" aria-label="Move selected item up" class="move-up-btn"&gt;▲&lt;/button&gt;
    &lt;button type="button" aria-label="Move selected item down" class="move-down-btn"&gt;▼&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JS requirements include basic listbox interaction PLUS:
     - Handling move button clicks to reorder items in the DOM
     - Updating focus/aria-activedescendant after reordering
     - **Crucially:** Providing keyboard-only methods for reordering (e.g., Ctrl+Up/Down Arrow), which is complex.
--&gt;</code></pre>

            <div class="accessibility-notes">
                <h3>Accessibility Notes (Listbox)</h3>
                <ul>
                    <li><strong>Role Structure:</strong> The container element has `role="listbox"`. Each selectable item within it has `role="option"`.</li>
                    <li><strong>Labeling:</strong> The listbox must have an accessible name, usually via `aria-labelledby` pointing to a visible `<label>` element.</li>
                    <li><strong>Focus Management:**
                        <ul>
                            <li>Typically, the listbox container itself is made focusable (`tabindex="0"`).</li>
                            <li>Focus remains on the listbox container while the user navigates *options* using arrow keys.</li>
                            <li>`aria-activedescendant` on the listbox container is updated via JS to point to the `id` of the currently *visually focused* option. This tells assistive technology which option is active without actually moving DOM focus to it.</li>
                            <li>Options themselves usually have `tabindex="-1"` (or no tabindex) so they aren't in the default tab order.</li>
                        </ul>
                    </li>
                    <li><strong>Selection State:** Use `aria-selected="true|false"` on each option to indicate whether it's selected. Update via JS on user interaction (click, Enter, Space).</li>
                    <li><strong>Multi-Select:** If multiple options can be selected, add `aria-multiselectable="true"` to the listbox container. Selection logic needs to handle Shift+Arrow, Ctrl+Click, Ctrl+Space, etc.</li>
                    <li><strong>Keyboard Navigation (Essential):**
                        <ul>
                            <li>Down/Up Arrow: Move visual focus (`aria-activedescendant`) to the next/previous option.</li>
                            <li>Home/End: Move visual focus to the first/last option.</li>
                            <li>PageUp/PageDown (Optional): Scroll and move focus up/down by a larger amount.</li>
                            <li>Letter Keys: Move focus to the next option starting with that letter (type-ahead).</li>
                            <li>Enter/Space: Select/deselect the focused option (toggle in multi-select).</li>
                        </ul>
                        (WCAG 2.1.1 Keyboard)
                    </li>
                     <li><strong>Scrollable Listbox:** Ensure keyboard navigation automatically scrolls the focused option (`aria-activedescendant`) into view.</li>
                     <li><strong>Grouped Listbox:** Use `role="presentation"` on list items acting as group labels to remove them from the option count/navigation. Alternatively, use `role="group"` around sets of options with `aria-labelledby` pointing to the group label's ID. Keyboard navigation should typically skip over group labels.</li>
                     <li><strong>Rearrangeable Listbox:** This adds significant complexity. In addition to standard listbox behavior:
                        <ul>
                            <li>Provide explicit visual buttons (Up/Down) for reordering.</li>
                            <li>Provide a keyboard-only mechanism for reordering (e.g., Ctrl+Arrow keys when an item is selected). This requires capturing key events and manipulating the DOM order.</li>
                            <li>Ensure screen readers announce the item's new position after moving.</li>
                            <li>Consider drag-and-drop as an *enhancement*, but it must have a keyboard equivalent.</li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>


    </main>

    <button id="scrollToTopBtn" title="Go to top" aria-label="Scroll to top"></button>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- Focusable Elements Selector ---
            const focusableElementsString = 'a[href], button:not([disabled]), textarea:not([disabled]), input:not([type="hidden"]):not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"]), [role="option"], [role="tab"], .accordion-button';

            // --- Utility Functions ---
            const trapFocus = (element, event) => {
                const focusableEls = Array.from(element.querySelectorAll(focusableElementsString));
                const closeBtn = element.querySelector('.dialog-close-btn');
                if (closeBtn && !focusableEls.includes(closeBtn)) {
                     const firstActionBtnIndex = focusableEls.findIndex(el => el.closest('.dialog_form_actions'));
                     if (firstActionBtnIndex !== -1) {
                         focusableEls.splice(firstActionBtnIndex, 0, closeBtn);
                     } else {
                         focusableEls.unshift(closeBtn);
                     }
                }

                if (focusableEls.length === 0) return;

                const firstFocusableEl = focusableEls[0];
                const lastFocusableEl = focusableEls[focusableEls.length - 1];
                const isTabPressed = event.key === 'Tab';

                if (!isTabPressed) return;

                if (event.shiftKey) { // Shift + Tab
                    if (document.activeElement === firstFocusableEl) {
                        lastFocusableEl.focus();
                        event.preventDefault();
                    }
                } else { // Tab
                    if (document.activeElement === lastFocusableEl) {
                        firstFocusableEl.focus();
                        event.preventDefault();
                    }
                }
            };

            // --- Modal Dialog Logic ---
            const dialogLayer = document.getElementById('dialog_layer');
            const openDialogBtns = document.querySelectorAll('[data-dialog-id]');
            let focusedElementBeforeDialog;

            const openDialog = (dialogId) => {
                const dialog = document.getElementById(dialogId);
                if (!dialog || !dialogLayer) return;

                focusedElementBeforeDialog = document.activeElement;

                dialogLayer.classList.remove('hidden');
                document.body.classList.add('modal-open');

                let firstFocusable = dialog.querySelector('.dialog-close-btn');
                if (!firstFocusable) {
                    const focusableEls = Array.from(dialog.querySelectorAll(focusableElementsString));
                     firstFocusable = focusableEls.length > 0 ? focusableEls[0] : dialog;
                }
                firstFocusable.focus();

                dialog.addEventListener('keydown', handleDialogKeyDown);
            };

            const closeDialog = (dialogElementOrButton) => {
                if (!dialogElementOrButton || !dialogLayer) return;
                const dialog = dialogElementOrButton.closest('.dialog');

                if(dialog) {
                    dialog.removeEventListener('keydown', handleDialogKeyDown);
                }
                dialogLayer.classList.add('hidden');
                document.body.classList.remove('modal-open');

                if (focusedElementBeforeDialog) {
                    focusedElementBeforeDialog.focus();
                }
            };

            const handleDialogKeyDown = (event) => {
                const dialog = event.currentTarget.closest('.dialog');
                if (!dialog) return;

                if (event.key === 'Escape') {
                    closeDialog(dialog);
                } else {
                    trapFocus(dialog, event);
                }
            };

            openDialogBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    openDialog(btn.dataset.dialogId);
                });
            });

            if (dialogLayer) {
                dialogLayer.addEventListener('click', (event) => {
                    if (event.target === dialogLayer) {
                        const openDialog = dialogLayer.querySelector('.dialog');
                        if (openDialog) closeDialog(openDialog);
                    }
                    else if (event.target.classList.contains('dialog-close-btn')) {
                        closeDialog(event.target);
                    }
                    else if (event.target.classList.contains('dialog-cancel-btn')) {
                        closeDialog(event.target);
                    }
                    else if (event.target.classList.contains('dialog-add-btn')) {
                        console.log('Add button clicked');
                        closeDialog(event.target);
                    }
                });
            }


            // --- Accordion Logic ---
            const accordions = document.querySelectorAll('.accordion');
            accordions.forEach(accordion => {
                const buttons = accordion.querySelectorAll('.accordion-button');
                buttons.forEach(button => {
                    button.addEventListener('click', () => {
                        const panel = document.getElementById(button.getAttribute('aria-controls'));
                        const isExpanded = button.getAttribute('aria-expanded') === 'true';

                        button.setAttribute('aria-expanded', !isExpanded);
                        panel.classList.toggle('hidden');
                    });
                });
            });

            // --- Alert Logic ---
            const triggerAlertBtn = document.getElementById('triggerAlertBtn');
            const alertContainer = document.getElementById('alertContainer');
            if (triggerAlertBtn && alertContainer) {
                triggerAlertBtn.addEventListener('click', () => {
                    const existingAlert = alertContainer.querySelector('.alert');
                    if (existingAlert) existingAlert.remove();

                    const newAlert = document.createElement('div');
                    newAlert.className = 'alert';
                    newAlert.setAttribute('role', 'alert');
                    newAlert.textContent = `Action completed successfully at ${new Date().toLocaleTimeString()}.`;
                    alertContainer.appendChild(newAlert);
                });
            }

            // --- Carousel Logic (Basic) ---
            const carousels = document.querySelectorAll('.carousel');
            carousels.forEach(carousel => {
                const slidesContainer = carousel.querySelector('.carousel-slides');
                const slides = carousel.querySelectorAll('.carousel-slide');
                const prevButton = carousel.querySelector('.carousel-button.prev');
                const nextButton = carousel.querySelector('.carousel-button.next');
                const paginationButtons = carousel.querySelectorAll('.carousel-pagination button');
                const statusDiv = carousel.querySelector('.carousel-status');
                let currentIndex = 0;
                const totalSlides = slides.length;

                const updateCarousel = (newIndex) => {
                    if (totalSlides === 0) return;
                    currentIndex = (newIndex + totalSlides) % totalSlides;
                    slidesContainer.style.transform = `translateX(-${currentIndex * 100}%)`;
                    paginationButtons.forEach((btn, index) => btn.setAttribute('aria-selected', index === currentIndex));
                    slides.forEach((slide, index) => slide.setAttribute('aria-label', `${index + 1} of ${totalSlides}`));
                    if (statusDiv) statusDiv.textContent = `Item ${currentIndex + 1} of ${totalSlides}`;
                };

                if (prevButton) prevButton.addEventListener('click', () => updateCarousel(currentIndex - 1));
                if (nextButton) nextButton.addEventListener('click', () => updateCarousel(currentIndex + 1));
                paginationButtons.forEach((btn, index) => btn.addEventListener('click', () => updateCarousel(index)));
                if(totalSlides > 0) updateCarousel(0);
            });


            // --- Listbox Logic (Basic Focus & Selection) ---
            const listboxes = document.querySelectorAll('[role="listbox"]');
            listboxes.forEach(listbox => {
                let options = Array.from(listbox.querySelectorAll('[role="option"]'));
                let focusedOptionIndex = -1;

                const updateFocus = (newIndex) => {
                    focusedOptionIndex = newIndex;
                    if (focusedOptionIndex >= 0 && options[focusedOptionIndex]) {
                        listbox.setAttribute('aria-activedescendant', options[focusedOptionIndex].id);
                        options[focusedOptionIndex].scrollIntoView({ block: 'nearest' });
                    } else {
                        listbox.removeAttribute('aria-activedescendant');
                    }
                };

                const selectOption = (index) => {
                    if (index < 0 || index >= options.length) return;
                    const isMultiSelect = listbox.getAttribute('aria-multiselectable') === 'true';
                    const option = options[index];
                    const isSelected = option.getAttribute('aria-selected') === 'true';
                    if (!isMultiSelect) options.forEach(opt => opt.setAttribute('aria-selected', 'false'));
                    option.setAttribute('aria-selected', isMultiSelect ? !isSelected : 'true');
                };

                listbox.addEventListener('focus', () => {
                    options = Array.from(listbox.querySelectorAll('[role="option"]')); // Refresh options on focus
                    const firstSelectedIndex = options.findIndex(opt => opt.getAttribute('aria-selected') === 'true');
                    updateFocus(firstSelectedIndex !== -1 ? firstSelectedIndex : (options.length > 0 ? 0 : -1));
                });

                listbox.addEventListener('keydown', (e) => {
                    options = Array.from(listbox.querySelectorAll('[role="option"]')); // Refresh options
                    if (options.length === 0) return;
                    let newIndex = focusedOptionIndex;
                    let preventDefault = true;

                    switch (e.key) {
                        case 'ArrowDown': newIndex = Math.min(options.length - 1, focusedOptionIndex + 1); break;
                        case 'ArrowUp': newIndex = Math.max(0, focusedOptionIndex - 1); break;
                        case 'Home': newIndex = 0; break;
                        case 'End': newIndex = options.length - 1; break;
                        case ' ': case 'Enter': selectOption(focusedOptionIndex); break;
                        default: preventDefault = false; break;
                    }

                    if (newIndex !== focusedOptionIndex && newIndex >= 0 && newIndex < options.length) {
                         updateFocus(newIndex);
                    }
                    if(preventDefault) e.preventDefault();
                });

                listbox.addEventListener('click', (e) => {
                    const clickedOption = e.target.closest('[role="option"]');
                    options = Array.from(listbox.querySelectorAll('[role="option"]')); // Refresh options
                    if (clickedOption && options.includes(clickedOption)) {
                        const index = options.indexOf(clickedOption);
                        updateFocus(index);
                        selectOption(index);
                        listbox.focus();
                    }
                });

                 // --- Rearrangeable Listbox Button Logic (Basic) ---
                 const wrapper = listbox.closest('.rearrange-listbox-wrapper');
                 if (wrapper) {
                     const moveUpBtn = wrapper.querySelector('.move-up-btn');
                     const moveDownBtn = wrapper.querySelector('.move-down-btn');

                     const moveOption = (direction) => {
                         options = Array.from(listbox.querySelectorAll('[role="option"]'));
                         if (focusedOptionIndex < 0) return;
                         const currentOption = options[focusedOptionIndex];
                         let swapIndex = -1;

                         if (direction === 'up' && focusedOptionIndex > 0) swapIndex = focusedOptionIndex - 1;
                         else if (direction === 'down' && focusedOptionIndex < options.length - 1) swapIndex = focusedOptionIndex + 1;

                         if (swapIndex !== -1) {
                             const swapOption = options[swapIndex];
                             if (direction === 'up') listbox.insertBefore(currentOption, swapOption);
                             else listbox.insertBefore(swapOption, currentOption);
                             options = Array.from(listbox.querySelectorAll('[role="option"]'));
                             updateFocus(swapIndex);
                         }
                     };

                     if (moveUpBtn) moveUpBtn.addEventListener('click', () => moveOption('up'));
                     if (moveDownBtn) moveDownBtn.addEventListener('click', () => moveOption('down'));
                 }
            });


            // --- Search/Filter Logic ---
            const searchInput = document.getElementById('controlSearchInput');
            const controlsContainer = document.getElementById('controls-container');
            const controlItems = controlsContainer ? controlsContainer.getElementsByClassName('form-control-item') : [];
            const resultsCountSpan = document.getElementById('search-results-count');
            let totalControls = controlItems.length;

            if (searchInput && controlsContainer && resultsCountSpan && controlItems.length > 0) {
                const filterControls = () => {
                    const searchTerm = searchInput.value.toLowerCase().trim();
                    let visibleCount = 0;
                    for (let item of controlItems) {
                        const title = item.querySelector('h2')?.textContent.toLowerCase() || '';
                        const keywords = item.dataset.keywords?.toLowerCase() || '';
                        const isMatch = searchTerm === '' || title.includes(searchTerm) || keywords.includes(searchTerm);
                        item.classList.toggle('hidden', !isMatch);
                        if (isMatch) visibleCount++;
                    }
                    resultsCountSpan.textContent = `${visibleCount} of ${totalControls} component${visibleCount !== 1 ? 's' : ''} shown.`;
                };
                searchInput.addEventListener('input', filterControls);
                filterControls(); // Initial run
            } else if(resultsCountSpan) {
                 resultsCountSpan.textContent = `0 components found.`;
            }

            // --- Scroll to Top Button Logic ---
            const scrollToTopBtn = document.getElementById("scrollToTopBtn");
            if (scrollToTopBtn) {
                window.onscroll = () => {
                    scrollToTopBtn.style.display = (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) ? "block" : "none";
                };
                scrollToTopBtn.addEventListener('click', () => {
                    window.scrollTo({top: 0, behavior: 'smooth'});
                    document.querySelector('h1')?.focus();
                });
            }

             // --- Theme Toggle Logic ---
             const themeToggle = document.getElementById('themeToggle');
             if (themeToggle) {
                 const applyTheme = (isDark) => {
                     document.body.classList.toggle('dark-theme', isDark);
                     themeToggle.setAttribute('aria-checked', isDark ? 'true' : 'false');
                 };
                 themeToggle.addEventListener('change', (e) => applyTheme(e.target.checked));
                 const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                 themeToggle.checked = prefersDark;
                 applyTheme(prefersDark);
             }

             // --- Toggle Switch Aria Sync ---
             const switches = document.querySelectorAll('input[role="switch"]:not(#themeToggle)');
             switches.forEach(switchInput => {
                switchInput.setAttribute('aria-checked', switchInput.checked);
                switchInput.addEventListener('change', (e) => {
                     e.target.setAttribute('aria-checked', e.target.checked);
                });
             });

             // --- Range Slider Initial Value Sync ---
             const rangeInputs = document.querySelectorAll('input[type="range"]');
             rangeInputs.forEach(rangeInput => {
                 const outputElement = document.querySelector(`output[for="${rangeInput.id}"]`);
                 if(outputElement) {
                     outputElement.textContent = rangeInput.value; // Set initial
                     rangeInput.addEventListener('input', (e) => { // Update on input
                         outputElement.textContent = e.target.value;
                     });
                 }
             });

             // --- File Input Initial Text & Update ---
             const fileInputs = document.querySelectorAll('input[type="file"]');
             fileInputs.forEach(fileInput => {
                const displaySpanId = 'fileNameDisplay' + fileInput.id.replace('InputExample','');
                const displaySpan = document.getElementById(displaySpanId);
                if(displaySpan){
                    // Set initial text
                    displaySpan.textContent = (fileInput.files && fileInput.files.length > 0) ? fileInput.files[0].name : 'No file chosen';
                    // Update on change (already handled by inline JS, but good practice to have it here too)
                    fileInput.addEventListener('change', (e) => {
                         displaySpan.textContent = (e.target.files.length > 0) ? e.target.files[0].name : 'No file chosen';
                    });
                }
             });

        }); // End DOMContentLoaded
    </script>

</body>
</html>
