<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controls Library (WCAG 2.2 Compliant)</title>
    <style>
        /* Basic Reset & Variables */
        :root {
            --primary-color: #005fcc;
            --primary-hover-color: #004a9f;
            /* Light Theme Text/Element Colors */
            --text-color-light: #333;
            --border-color-light: #ccc;
            --label-color-light: #555;
            --input-bg-color-light: #fff;
            --input-border-color-light: #ccc;
            --disabled-bg-color-light: #eee;
            --disabled-text-color-light: #999;
            --form-item-bg-light: transparent;
            --header-bg-light: #f8f9fa;
            --pre-bg-light: #f0f0f0;
            --pre-border-light: #ccc;
            --theme-toggle-bg-light: #fff;
            --component-bg-light: #fff;
            --component-border-light: #ccc;
            --alert-info-bg-light: #e7f3fe;
            --alert-info-border-light: #b3d7f9;
            --alert-info-text-light: #0a58ca;
            --overlay-bg-light: rgba(0, 0, 0, 0.6);


            /* Dark Theme Text/Element Colors */
            /* Adjusted for contrast */
            --primary-color-dark: #228be6; /* Changed from #4dabf7 */
            --primary-hover-color-dark: #1c7ed6; /* Changed from #74c0fc */
            --text-color-dark: #eee;
            --border-color-dark: #4a4a4a;
            --label-color-dark: #bbb;
            --input-bg-color-dark: #1a1a1a;
            --input-border-color-dark: #4a4a4a;
            --disabled-bg-color-dark: #333;
            --disabled-text-color-dark: #777;
            --form-item-bg-dark: transparent;
            --header-bg-dark: #1c1f23;
            --pre-bg-dark: #151515;
            --pre-border-dark: #333;
            --theme-toggle-bg-dark: #2a2a2a;
            --component-bg-dark: #252525;
            --component-border-dark: #4a4a4a;
            --alert-info-bg-dark: #1c2a3b;
            --alert-info-border-dark: #2a4a6f;
            --alert-info-text-dark: #a6cfff;
            --overlay-bg-dark: rgba(0, 0, 0, 0.7);

            /* Adjusted for contrast */
            --error-color: #c9302c; /* Changed from #d9534f */
            --focus-outline-color: #005fcc;
            --input-focus-border-color: #005fcc;
            /* Adjusted to use new primary dark color */
            --focus-outline-color-dark: var(--primary-color-dark); /* Was #4dabf7 */
            --input-focus-border-color-dark: var(--primary-color-dark); /* Was #4dabf7 */

            --font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
            --spacing-unit: 8px;
            --min-control-height: 44px;
        }

        /* Apply base variables (Light theme default) */
        :root {
            --text-color: var(--text-color-light);
            --border-color: var(--border-color-light);
            --label-color: var(--label-color-light);
            --input-bg-color: var(--input-bg-color-light);
            --input-border-color: var(--input-border-color-light);
            --disabled-bg-color: var(--disabled-bg-color-light);
            --disabled-text-color: var(--disabled-text-color-light);
            --form-item-bg: var(--form-item-bg-light);
            --header-bg: var(--header-bg-light);
            --pre-bg: var(--pre-bg-light);
            --pre-border: var(--pre-border-light);
            --theme-toggle-bg: var(--theme-toggle-bg-light);
            --component-bg: var(--component-bg-light);
            --component-border: var(--component-border-light);
            --alert-info-bg: var(--alert-info-bg-light);
            --alert-info-border: var(--alert-info-border-light);
            --alert-info-text: var(--alert-info-text-light);
            --overlay-bg: var(--overlay-bg-light);
        }


        /* Dark Theme Overrides */
        body.dark-theme {
             --primary-color: var(--primary-color-dark);
            --primary-hover-color: var(--primary-hover-color-dark);
            --text-color: var(--text-color-dark);
            --border-color: var(--border-color-dark);
            --label-color: var(--label-color-dark);
            --input-bg-color: var(--input-bg-color-dark);
            --input-border-color: var(--input-border-color-dark);
            --disabled-bg-color: var(--disabled-bg-color-dark);
            --disabled-text-color: var(--disabled-text-color-dark);
            --form-item-bg: var(--form-item-bg-dark);
            --header-bg: var(--header-bg-dark);
            --pre-bg: var(--pre-bg-dark);
            --pre-border: var(--pre-border-dark);
            --theme-toggle-bg: var(--theme-toggle-bg-dark);
            --component-bg: var(--component-bg-dark);
            --component-border: var(--component-border-dark);
            --alert-info-bg: var(--alert-info-bg-dark);
            --alert-info-border: var(--alert-info-border-dark);
            --alert-info-text: var(--alert-info-text-dark);
            --overlay-bg: var(--overlay-bg-dark);

            /* Dark theme error color (was already okay, just ensuring it's explicitly set) */
            --error-color: #f78b88;
            --focus-outline-color: var(--focus-outline-color-dark);
            --input-focus-border-color: var(--input-focus-border-color-dark);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
            height: 100%;
        }

        body {
            font-family: var(--font-family);
            color: var(--text-color);
            background-color: #f5f5f5;
            background-image: linear-gradient(147deg, #f5f5f5 0%, #fffafa 74%);
            background-attachment: fixed;
            background-size: cover;
            min-height: 100%;
            line-height: 1.6;
            padding: 0 0 3rem 0;
            padding-top: 0px;
            transition: color 0.3s ease;
        }
        body.modal-open {
             overflow: hidden;
        }

        body.dark-theme {
            background-color: #003153;
            background-image: linear-gradient(315deg, #003153 0%, #1B1B1B 74%);
        }


 /* --- Theme Toggle (Inside Header) --- */
 .theme-toggle-container {
     display: flex;
     align-items: center;
     gap: calc(var(--spacing-unit) / 2);
     background: transparent;
     padding: calc(var(--spacing-unit) / 2);
     border-radius: 4px;
     /* box-shadow removed */
     transition: background-color 0.3s ease;
 }
 body.dark-theme .theme-toggle-container {
      /* box-shadow removed */
 }

        .theme-toggle-container label {
             font-size: 0.9em;
             font-weight: normal;
             color: var(--label-color);
             margin-bottom: 0;
        }

        h1, h2, h3 {
            margin-bottom: calc(var(--spacing-unit) * 2);
            color: var(--primary-color);
        }
        h1 {
            margin-top: 0;
            margin-bottom: 0;
        }
        h2 { margin-top: calc(var(--spacing-unit) * 4); }
        h3 { margin-top: calc(var(--spacing-unit) * 3); }

        p, ol {
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        ul {
            margin-bottom: calc(var(--spacing-unit) * 2);
            padding-left: 1rem;
        }
        .accessibility-notes ul {
             padding-left: 0;
             list-style: none;
        }
         .accessibility-notes ul ul {
             padding-left: 1rem;
             list-style: disc;
             margin-top: calc(var(--spacing-unit) / 2);
        }
         .accessibility-notes li {
             margin-bottom: calc(var(--spacing-unit) / 2);
             font-weight: 400;
         }


        pre {
            background-color: var(--pre-bg);
            padding: calc(var(--spacing-unit) * 2);
            border-radius: 4px;
            overflow-x: auto;
            margin-top: var(--spacing-unit);
            margin-bottom: var(--spacing-unit);
            border: 0px solid var(--pre-border);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        code {
            font-family: monospace;
             color: var(--text-color);
        }
        body.dark-theme pre code {
            color: var(--text-color-dark);
        }


        /* --- Sticky Search Header --- */
        .sticky-search-container {
            position: sticky;
            top: 0;
            left: 0;
            right: 0;
            background-color: var(--header-bg); /* Reverted */
            padding: calc(var(--spacing-unit) * 2); /* Reverted */
            border-bottom: 1px solid var(--border-color);
            z-index: 100;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: background-color 0.3s ease, border-bottom-color 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: stretch;
        }
        .header-top-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 900px;
            margin-bottom: var(--spacing-unit);
            margin-left: auto;
            margin-right: auto;
        }

        .search-form {
            display: flex;
            flex-direction: column;
            align-items: stretch;
            gap: calc(var(--spacing-unit));
            width: 100%;
            max-width: 900px;
            padding: 0;
            margin-left: auto;
            margin-right: auto;
        }
        .search-form > input,
        .search-form > span,
        .search-form > button {
             max-width: none;
             margin-left: 0;
             margin-right: 0;
        }


        .search-input-group {
            display: contents;
        }

        .search-form label {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        #controlSearchInput {
             width: 100%;
        }

        #search-results-count {
            font-size: 0.85em;
            color: var(--label-color);
            text-align: left;
            width: 100%;
            padding-left: calc(var(--spacing-unit) / 2);
            order: 1;
            margin-bottom: 1rem;
        }

        /* Commented out search button remains commented out */
        /* .search-form button#searchBtn { ... } */
        .search-form button#selectControlBtn {
            width: 100%;
            margin: 0;
            order: 3; /* Adjust order if searchBtn is removed */
        }


        /* --- Form Control Container --- */
        .form-control-item {
            margin: calc(var(--spacing-unit) * 4) auto;
            padding: 1rem 1.5rem;
            border-width: 0px;
            border-radius: 8px;
            background-color: transparent;
            max-width: 900px;
            transition: background-color 0.3s ease, border-color 0.3s ease;
            box-shadow: none;
        }
        body.dark-theme .form-control-item {
             box-shadow: none;
        }


        .form-control-item.hidden {
            display: none;
        }

        .form-group {
            margin-bottom: calc(var(--spacing-unit) * 2);
        }

        /* Common Input & Select Styling */
        input[type="text"],
        input[type="password"],
        input[type="email"],
        input[type="url"],
        input[type="tel"],
        input[type="number"],
        input[type="search"],
        input[type="date"],
        input[type="time"],
        input[type="datetime-local"],
        input[type="month"],
        input[type="week"],
        textarea,
        select {
            display: block;
            width: 100%;
            padding: var(--spacing-unit) calc(var(--spacing-unit) * 1.5);
            font-size: 1rem;
            line-height: 1.5;
            color: var(--text-color);
            background-color: var(--input-bg-color);
            background-clip: padding-box;
            border: 1px solid var(--input-border-color);
            border-radius: 4px;
            transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out, background-color 0.3s ease, color 0.3s ease;
            margin-top: calc(var(--spacing-unit) / 2);
            min-height: var(--min-control-height);
            vertical-align: middle;
        }

        select {
             padding-top: calc(var(--spacing-unit) * 0.75);
             padding-bottom: calc(var(--spacing-unit) * 0.75);
        }
        input[type="date"],
        input[type="time"],
        input[type="datetime-local"],
        input[type="month"],
        input[type="week"] {
             padding-top: calc(var(--spacing-unit) * 0.75);
             padding-bottom: calc(var(--spacing-unit) * 0.75);
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        /* Focus States */
        input:focus-visible,
        textarea:focus-visible,
        select:focus-visible,
        button:focus-visible,
        input[type="checkbox"]:focus-visible + label::before,
        input[type="radio"]:focus-visible + label::before,
        a.button-like:focus-visible,
        [role="switch"]:focus-visible,
        .switch input:focus-visible + .slider,
        .accordion-button:focus-visible,
        .carousel-button:focus-visible,
        .carousel-pagination button:focus-visible,
        [role="listbox"]:focus-visible,
        [role="option"]:focus-visible,
        .dialog button:focus-visible,
        .dialog input:focus-visible,
        .dialog [tabindex="-1"]:focus-visible,
        .control-select-dialog a:focus-visible
        {
            outline: 2px solid var(--focus-outline-color);
            outline-offset: 2px;
            border-color: var(--input-focus-border-color);
            box-shadow: 0 0 0 2px color-mix(in srgb, var(--focus-outline-color) 25%, transparent);
        }
        input:focus, textarea:focus, select:focus, button:focus, a:focus {
            outline: none;
        }


        /* Labels */
        label {
            display: inline-block;
            margin-bottom: calc(var(--spacing-unit) / 2);
            font-weight: bold;
            color: var(--label-color);
            cursor: pointer;
            transition: color 0.3s ease;
        }
        .form-group label:not(.inline-label) {
             display: block;
        }


        /* Help Text / Descriptions */
        .help-text {
            font-size: 0.875em;
            color: var(--label-color);
            margin-top: calc(var(--spacing-unit) / 2);
            display: block;
            transition: color 0.3s ease;
        }

        /* Required Fields */
        .required-indicator {
            color: var(--error-color); /* Uses updated contrast-safe color */
            margin-left: 2px;
            font-weight: bold;
        }
        label .required-indicator {
             font-weight: bold;
        }

        /* Fieldsets for Grouping */
        fieldset {
            border: 1px solid var(--border-color);
            padding: calc(var(--spacing-unit) * 2);
            margin-bottom: calc(var(--spacing-unit) * 2);
            border-radius: 4px;
            transition: border-color 0.3s ease;
        }

        legend {
            padding: 0 calc(var(--spacing-unit));
            font-weight: bold;
            color: var(--primary-color);
            transition: color 0.3s ease;
        }

        /* Buttons */
        button,
        input[type="submit"],
        input[type="reset"],
        input[type="button"],
        a.button-like
        {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: 400;
            color: #fff; /* Default white text */
            text-align: center;
            vertical-align: middle;
            cursor: pointer;
            user-select: none;
            background-color: var(--primary-color);
            border: 1px solid var(--primary-color);
            padding: var(--spacing-unit) calc(var(--spacing-unit) * 1.5);
            font-size: 1rem;
            line-height: 1.5;
            border-radius: 4px;
            text-decoration: none;
            transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
            margin-right: var(--spacing-unit);
            margin-bottom: 0px;
            min-height: var(--min-control-height);
        }
         .form-group > button,
         .dialog_form_actions > button {
             margin-bottom: var(--spacing-unit);
        }
         .form-group > button:last-child,
         .dialog_form_actions > button:last-child {
              margin-bottom: 0;
         }

        /* Keep button text white for dark theme now primary color is darker */
        /* body.dark-theme button { color: #002b4d; } /* Removed - using new primary color */

        button:hover,
        input[type="submit"]:hover,
        input[type="reset"]:hover,
        input[type="button"]:hover,
        a.button-like:hover {
            background-color: var(--primary-hover-color);
            border-color: var(--primary-hover-color);
            color: #fff; /* Keep hover text white */
            text-decoration: none;
        }

        /* body.dark-theme button:hover { color: #002b4d; } */ /* Removed */

        /* Secondary/Cancel Button Style */
        button.secondary,
        a.button-like.secondary {
            color: var(--primary-color);
            background-color: transparent;
            border-color: var(--primary-color);
        }
        button.secondary:hover,
        a.button-like.secondary:hover {
            color: #fff;
            background-color: var(--primary-hover-color);
            border-color: var(--primary-hover-color);
        }
        /* Keep dark theme secondary hover text white */
        /* body.dark-theme button.secondary:hover { ... } */ /* No longer needs specific text color override */


        /* Disabled State */
        input:disabled,
        textarea:disabled,
        select:disabled,
        button:disabled {
            background-color: var(--disabled-bg-color);
            opacity: 0.65;
            cursor: not-allowed;
            color: var(--disabled-text-color);
            border-color: var(--input-border-color);
        }
        input[type="checkbox"]:disabled + label,
        input[type="radio"]:disabled + label {
             color: var(--disabled-text-color);
             cursor: not-allowed;
        }
        input[type="checkbox"]:disabled + label::before,
        input[type="radio"]:disabled + label::before {
             background-color: var(--disabled-bg-color);
             border-color: color-mix(in srgb, var(--disabled-text-color) 50%, transparent);
             cursor: not-allowed;
        }


        /* Checkbox & Radio Button Custom Styling */
        .checkbox-group label,
        .radio-group label {
            display: flex;
            align-items: center;
            margin-bottom: var(--spacing-unit);
            position: relative;
            padding-left: calc(var(--spacing-unit) * 3.5);
            min-height: calc(var(--spacing-unit) * 3);
            cursor: pointer;
            font-weight: normal;
            color: var(--text-color);
            transition: color 0.3s ease;
        }

        .checkbox-group input[type="checkbox"],
        .radio-group input[type="radio"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }

        .checkbox-group label::before,
        .radio-group label::before {
            content: "";
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            height: calc(var(--spacing-unit) * 2.5);
            width: calc(var(--spacing-unit) * 2.5);
            border: 1px solid var(--input-border-color);
            background-color: var(--input-bg-color);
            transition: background-color 0.15s ease-in-out, border-color 0.15s ease-in-out;
        }

        .radio-group label::before { border-radius: 50%; }
        .checkbox-group label::before { border-radius: 3px; }


        .checkbox-group input[type="checkbox"]:checked + label::after {
            content: "";
            position: absolute;
            left: calc(var(--spacing-unit) * 0.75);
            top: 50%;
            width: calc(var(--spacing-unit) * 0.75);
            height: calc(var(--spacing-unit) * 1.5);
            border: solid var(--primary-color);
            border-width: 0 3px 3px 0;
            transform: translateY(-65%) rotate(45deg);
        }

        .radio-group input[type="radio"]:checked + label::after {
            content: "";
            position: absolute;
            left: calc(var(--spacing-unit) * 0.6);
            top: 50%;
            transform: translateY(-50%);
            height: calc(var(--spacing-unit) * 1.3);
            width: calc(var(--spacing-unit) * 1.3);
            border-radius: 50%;
            background: var(--primary-color);
        }

        .checkbox-group label:hover::before,
        .radio-group label:hover::before {
             border-color: var(--input-focus-border-color);
        }


        /* File Input Specific Styling */
        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-flex;
            align-items: center;
            margin-top: calc(var(--spacing-unit) / 2);
            min-height: var(--min-control-height);
            gap: var(--spacing-unit);
        }
        .file-input-wrapper input[type="file"] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
         .file-input-wrapper .button-like {
             margin: 0;
             flex-shrink: 0;
        }
        .file-input-wrapper .file-name-display {
            display: inline-block;
            font-size: 0.9em;
            color: var(--label-color);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 200px;
            transition: color 0.3s ease;
        }

        /* Range Input - Display Value */
        .range-group {
            display: flex;
            align-items: center;
            gap: var(--spacing-unit);
            min-height: var(--min-control-height);
        }
        .range-group input[type="range"] {
             flex-grow: 1;
             margin-top: 0;
             height: var(--min-control-height);
             cursor: pointer;
        }
        .range-group .range-value {
            font-weight: bold;
            min-width: 3ch;
            text-align: right;
            color: var(--text-color);
            transition: color 0.3s ease;
        }

/* --- Styles for Password Show/Hide Button --- */
.password-input-container {
     position: relative;
     /* Adjust spacing if input has margin-top */
      margin-top: calc(var(--spacing-unit) / 2);
 }

 .password-input-container input[type="password"],
 .password-input-container input[type="text"] {
    /* Reset margin-top from common input style */
    margin-top: 0;
    /* Add padding on the right to prevent text overlap with button */
    padding-right: calc(var(--spacing-unit) * 8); /* Adjust as needed */
 }

 .password-toggle-btn {
     position: absolute;
     /* Vertically center within the input's height */
     top: 0;
     bottom: 0;
     height: fit-content; /* Adjust height based on content */
     margin: auto 0;
     /* Position on the right */
     right: var(--spacing-unit);
     /* Styling to look like an inline button */
     background: transparent;
     border: none;
     padding: calc(var(--spacing-unit) / 2) var(--spacing-unit);
     cursor: pointer;
     color: var(--primary-color);
     font-weight: 600; /* Slightly bolder */
     font-size: 0.85em;
     /* Override base button styles */
     min-height: 30px; /* Ensure minimum clickable height */
     min-width: auto;
     margin-right: 0; /* Remove base button margin */
     line-height: 1; /* Adjust line height */
     border-radius: 3px;
     z-index: 2; /* Ensure it's above the input */
 }

 .password-toggle-btn:hover,
 .password-toggle-btn:focus-visible { /* Use focus-visible */
     color: var(--primary-hover-color);
     background-color: transparent;
     text-decoration: underline;
     /* Ensure focus style is clear even without outline */
     /* box-shadow: 0 0 0 2px color-mix(in srgb, var(--focus-outline-color) 25%, transparent); */
     /* Outline might be better here */
 }

  /* Explicit focus-visible style for the button */
 .password-toggle-btn:focus-visible {
    outline: 2px solid var(--focus-outline-color);
    outline-offset: 1px;
 }
 .password-toggle-btn:focus {
     outline: none; /* Remove default focus potentially added */
 }

 /* --- End Password Button Styles --- */ 

        /* Toggle Switch Styling */
        .switch {
            position: relative;
            display: inline-flex;
            align-items: center;
            width: 50px;
            height: 28px;
            vertical-align: middle;
            margin-top: calc(var(--spacing-unit) / 2);
            min-height: var(--min-control-height);
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
            position: absolute;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 50%;
            transform: translateY(-50%);
            left: 0;
            right: 0;
            height: 28px;
            background-color: var(--input-border-color);
            transition: .4s;
            border-radius: 28px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        body.dark-theme .slider:before {
             background-color: #ddd;
        }

        input:checked + .slider {
            background-color: var(--primary-color);
        }

        input:checked + .slider:before {
            transform: translateX(22px);
        }


        /* --- Scroll to Top Button --- */
        #scrollToTopBtn {
            display: none;
            position: fixed;
            bottom: 20px;
            right: 30px;
            z-index: 99;
            border: none;
            outline: none;
            background-color: var(--primary-color);
            color: white;
            cursor: pointer;
            padding: 0;
            border-radius: 50%;
            font-size: 18px;
            width: 55px;
            height: 55px;
            line-height: 55px;
            text-align: center;
            opacity: 0.8;
            transition: opacity 0.3s ease, background-color 0.3s ease;
        }

        #scrollToTopBtn:hover {
            background-color: var(--primary-hover-color);
            opacity: 1;
        }
         #scrollToTopBtn:focus-visible {
            outline: 3px solid var(--focus-outline-color);
            outline-offset: 3px;
            opacity: 1;
        }
         #scrollToTopBtn::before {
            content: '';
            display: inline-block;
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 10px solid white;
            position: absolute;
            top: 45%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        /* --- Utility Classes --- */
        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
        .hidden {
            display: none !important;
        }


        /* --- Component Styles --- */

        /* Modal Dialog Styles */
        .dialog-overlay {
            position: fixed;
            inset: 0;
            background-color: var(--overlay-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 1rem;
        }
        .dialog {
            background-color: var(--component-bg);
            border: 1px solid var(--component-border);
            border-radius: 8px;
            padding: calc(var(--spacing-unit) * 3);
            max-width: 600px;
            width: 90%;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }
        .dialog-content {
             overflow-y: auto;
             flex-grow: 1;
        }

        .dialog-close-btn {
            position: absolute;
            top: var(--spacing-unit);
            right: var(--spacing-unit);
            background: transparent;
            border: none;
            font-size: 1.8rem;
            line-height: 1;
            padding: calc(var(--spacing-unit) / 2); /* Padding within the button */
            cursor: pointer;
            color: var(--label-color);
            width: 44px; /* Changed from 40px */
            height: 44px; /* Changed from 40px */
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            margin: 0;
            min-height: auto; /* Override default button min-height if needed */
            z-index: 1;
            box-sizing: border-box; /* Ensure padding is included */
        }
        .dialog-close-btn:hover, .dialog-close-btn:focus {
            color: var(--text-color);
            background-color: color-mix(in srgb, var(--border-color) 20%, transparent);
        }

        .dialog_label {
            font-size: 1.5rem;
            margin-bottom: var(--spacing-unit);
            margin-right: 40px; /* Space for close button */
            color: var(--primary-color);
            flex-shrink: 0;
        }
        .dialog_desc {
            margin-bottom: calc(var(--spacing-unit) * 2);
        }
        .dialog_form .form-group {
            margin-bottom: var(--spacing-unit);
        }
        .dialog_form_actions {
            margin-top: calc(var(--spacing-unit) * 3);
            text-align: right;
            border-top: 1px solid var(--border-color);
            padding-top: calc(var(--spacing-unit) * 2);
            flex-shrink: 0;
        }
        .dialog_form_actions button {
            margin-left: var(--spacing-unit);
            margin-bottom: 0;
        }
        .dialog_form_actions button:first-child {
             margin-left: 0;
        }

        /* Control Select Dialog Specific Styles */
        #controlSelectDialog {
            max-width: 400px;
            height: 40vw !important;
            min-height: 300px;
            overflow: hidden;
        }
        #controlSelectList {
            list-style: none;
            padding: 0;
            margin: 0;
            overflow-y: auto; /* Make list scrollable */
            border: 1px solid var(--border-color);
            border-radius: 4px;
            flex-grow: 1;
            /* Removed max-height */
        }
        #controlSelectList li {
            margin-bottom: 0;
        }
        #controlSelectList a {
            display: block;
            padding: var(--spacing-unit) calc(var(--spacing-unit) * 1.5);
            color: var(--primary-color);
            text-decoration: none;
            border-bottom: 1px solid var(--border-color);
        }
        #controlSelectList li:last-child a {
            border-bottom: none;
        }
        #controlSelectList a:hover,
        #controlSelectList a:focus {
            background-color: color-mix(in srgb, var(--primary-color) 10%, var(--component-bg));
            text-decoration: underline;
            color: var(--primary-hover-color);
        }
        body.dark-theme #controlSelectList a {
             color: var(--primary-color-dark);
             border-color: var(--border-color-dark);
        }
         body.dark-theme #controlSelectList a:hover,
         body.dark-theme #controlSelectList a:focus {
             background-color: color-mix(in srgb, var(--primary-color-dark) 15%, var(--component-bg));
             color: var(--primary-hover-color-dark);
        }


        /* Accordion Styles */
        .accordion {
            border: 1px solid var(--border-color);
            border-radius: 4px;
            overflow: hidden;
        }
        .accordion-item {
            border-bottom: 1px solid var(--border-color);
        }
        .accordion-item:last-child {
            border-bottom: none;
        }
        .accordion-button {
            display: block;
            width: 100%;
            padding: calc(var(--spacing-unit) * 1.5) calc(var(--spacing-unit) * 2);
            background-color: var(--input-bg-color);
            border: none;
            text-align: left;
            font-size: 1rem;
            font-weight: bold;
            color: var(--text-color);
            cursor: pointer;
            position: relative;
            transition: background-color 0.2s ease;
            min-height: var(--min-control-height);
        }
        .accordion-button:hover {
            background-color: color-mix(in srgb, var(--input-bg-color) 85%, var(--border-color));
        }
        .accordion-button::after {
            content: '';
            position: absolute;
            right: calc(var(--spacing-unit) * 2);
            top: 50%;
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-top: 6px solid currentColor;
            transform: translateY(-50%);
            transition: transform 0.2s ease;
        }
        .accordion-button[aria-expanded="true"]::after {
            transform: translateY(-50%) rotate(180deg);
        }
        .accordion-panel {
            padding: calc(var(--spacing-unit) * 2);
            background-color: var(--component-bg);
            border-top: 1px solid var(--border-color);
        }

        /* Alert Styles */
        .alert {
            padding: calc(var(--spacing-unit) * 1.5);
            margin-bottom: var(--spacing-unit) * 2;
            border: 1px solid transparent;
            border-radius: 4px;
            background-color: var(--alert-info-bg);
            border-color: var(--alert-info-border);
            color: var(--alert-info-text);
        }

        /* Breadcrumb Styles */
        .breadcrumb {
            padding: var(--spacing-unit) 0;
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            gap: calc(var(--spacing-unit) / 2) var(--spacing-unit);
        }
        .breadcrumb li {
            display: inline-flex;
            align-items: center;
        }
        .breadcrumb li + li::before {
            content: "/";
            padding: 0 var(--spacing-unit);
            color: var(--label-color);
        }
        .breadcrumb a {
            color: var(--primary-color);
            text-decoration: none;
        }
        .breadcrumb a:hover, .breadcrumb a:focus {
            text-decoration: underline;
        }
        .breadcrumb [aria-current="page"] {
            color: var(--text-color);
            font-weight: bold;
            text-decoration: none;
            cursor: default;
        }

        /* Carousel Styles */
        .carousel {
            position: relative;
            overflow: hidden;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background-color: var(--input-bg-color);
        }
        .carousel-slides {
            display: flex;
            transition: transform 0.5s ease-in-out;
        }
        .carousel-slide {
            min-width: 100%;
            flex-shrink: 0;
            padding: calc(var(--spacing-unit) * 5);
            text-align: center;
            background-color: var(--component-bg);
            border: 1px solid var(--component-border);
            margin: 1px;
        }
        .carousel-slide img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 0 auto calc(var(--spacing-unit)*2);
            max-height: 300px;
        }
        .carousel-button {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            padding: var(--spacing-unit);
            border-radius: 50%;
            cursor: pointer;
            z-index: 10;
            width: 40px;
            height: 40px;
            font-size: 1.5rem;
            line-height: 1;
        }
        .carousel-button.prev { left: var(--spacing-unit); }
        .carousel-button.next { right: var(--spacing-unit); }
        .carousel-button:hover, .carousel-button:focus {
            background-color: rgba(0, 0, 0, 0.8);
        }
        .carousel-pagination {
            position: absolute;
            bottom: var(--spacing-unit);
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: calc(var(--spacing-unit) / 2); /* Reduced gap slightly */
            z-index: 10;
        }

        .carousel-pagination button {
            /* Make the button the target size */
            width: 44px;
            height: 44px;
            min-height: 44px; /* Explicitly set min-height */
            padding: 0; /* Remove default padding */
            margin: 0;
            cursor: pointer;
            border-radius: 50%; /* Round touch target */
            background-color: transparent; /* Make button background invisible */
            border: none; /* Remove button border */
            display: inline-flex; /* Use flex to center the pseudo-element */
            align-items: center;
            justify-content: center;
            position: relative; /* Needed for pseudo-element positioning if not using flex */
            box-sizing: border-box;
            /* Add transition for potential focus styles on the button itself */
            transition: box-shadow 0.15s ease-in-out;
        }
        /* Style the visible dot using ::before */
        .carousel-pagination button::before {
            content: '';
            display: block; /* Make it a block element */
            width: 10px; /* Size of the visible dot */
            height: 10px; /* Size of the visible dot */
            border-radius: 50%; /* Make the dot round */
            background-color: color-mix(in srgb, var(--text-color) 35%, transparent); /* Semi-transparent dot */
            border: 1px solid color-mix(in srgb, var(--text-color) 50%, transparent);
            transition: background-color 0.2s ease; /* Transition for selected state */
        }

        /* Style the dot for the selected state */
        .carousel-pagination button[aria-selected="true"]::before {
            background-color: var(--primary-color); /* Use primary color for selected */
            border-color: var(--primary-color);
        }

        /* Optional: Subtle hover/focus indication on the button itself (around the dot) */
        .carousel-pagination button:hover {
        /* background-color: rgba(0, 0, 0, 0.05); /* Subtle background on hover */
        }

        /* Ensure focus style applies correctly (inherited :focus-visible should work, but override if needed) */
        .carousel-pagination button:focus-visible {
            outline: 2px solid var(--focus-outline-color);
            outline-offset: 2px; /* Adjust offset as needed */
            box-shadow: 0 0 0 2px color-mix(in srgb, var(--focus-outline-color) 25%, transparent); /* Match other focus */
        }
        .carousel-status {
             position: absolute;
             width: 1px;
             height: 1px;
             padding: 0;
             margin: -1px;
             overflow: hidden;
             clip: rect(0, 0, 0, 0);
             white-space: nowrap;
             border-width: 0;
        }

        /* Add this new rule for the pause/play button */
 .carousel-pause-play {
    position: absolute;
    top: var(--spacing-unit);
    right: var(--spacing-unit);
    z-index: 15; /* Above other controls */
    background-color: rgba(0, 0, 0, 0.5);
    color: white;
    border: none;
    border-radius: 4px;
    padding: calc(var(--spacing-unit) / 2) var(--spacing-unit);
    cursor: pointer;
    font-size: 0.8em;
    min-height: 30px; /* Smaller button okay here if needed */
    min-width: 60px; /* Give text space */
    height: auto;
    width: auto;
 }
  .carousel-pause-play:hover,
  .carousel-pause-play:focus {
     background-color: rgba(0, 0, 0, 0.8);
 }
 /* Ensure focus style is visible */
 .carousel-pause-play:focus-visible {
      outline: 2px solid var(--focus-outline-color);
      outline-offset: 1px;
      box-shadow: 0 0 0 2px color-mix(in srgb, var(--focus-outline-color) 25%, transparent);
 }

 /* --- End of new carousel button styles --- */

        /* Listbox Styles */
        .listbox-container {
            margin-top: var(--spacing-unit);
        }
        .listbox-label {
            display: block;
            font-weight: bold;
            margin-bottom: calc(var(--spacing-unit) / 2);
            color: var(--label-color);
        }
        [role="listbox"] {
            border: 1px solid var(--input-border-color);
            background-color: var(--input-bg-color);
            border-radius: 4px;
            padding: calc(var(--spacing-unit) / 2) 0;
            min-height: 100px;
            max-height: 200px;
            overflow-y: auto;
        }
        [role="option"] {
            padding: var(--spacing-unit) calc(var(--spacing-unit) * 1.5);
            cursor: pointer;
            display: block;
        }
        [role="option"][aria-selected="true"] {
            background-color: var(--primary-color);
            color: white;
        }
        [role="option"]:hover, [role="option"]:focus {
             background-color: color-mix(in srgb, var(--primary-color) 20%, var(--input-bg-color));
             color: var(--text-color);
        }
        [role="option"][aria-selected="true"]:hover,
        [role="option"][aria-selected="true"]:focus {
            background-color: var(--primary-hover-color);
            color: white;
        }
        .listbox-group-label {
            padding: calc(var(--spacing-unit) / 2) calc(var(--spacing-unit) * 1.5);
            font-weight: bold;
            color: var(--label-color);
            font-style: italic;
            margin-top: var(--spacing-unit);
            border-top: 1px dashed var(--border-color);
        }
        .listbox-group-label:first-child {
             margin-top: 0;
             border-top: none;
        }
        [role="group"] [role="option"] {
             padding-left: calc(var(--spacing-unit) * 3);
        }
        .rearrange-listbox-wrapper {
            display: flex;
            align-items: flex-start;
            gap: var(--spacing-unit);
        }
        .rearrange-listbox-wrapper [role="listbox"] {
            flex-grow: 1;
        }
        .rearrange-buttons {
            display: flex;
            flex-direction: column;
            gap: calc(var(--spacing-unit) / 2);
            padding-top: calc(var(--spacing-unit) * 3);
        }
        .rearrange-buttons button {
            margin: 0;
            padding: 0;
            min-height: 44px;
            min-width: 44px;
            width: 44px;
            height: 44px;
            font-size: 1.2em;
            box-sizing: border-box;
        }

    </style>
</head>
<body>

    <header class="sticky-search-container">
        <div class="header-top-row">
            <h1>Controls Library</h1>
            <div class="theme-toggle-container">
                 <label for="themeToggle" id="themeToggleLabel" class="inline-label">Theme Toggle</label>
                 <label class="switch" aria-labelledby="themeToggleLabel">
                   <input type="checkbox" id="themeToggle" role="switch" aria-checked="false">
                   <span class="slider"></span>
                 </label>
            </div>
        </div>

        <form action="#" class="search-form" role="search" onsubmit="return false;">
            <label for="controlSearchInput">Search Components</label>
            <input type="search" id="controlSearchInput" placeholder="E.g., 'button', 'modal', 'accordion'">
            <span id="search-results-count" aria-live="polite"></span>
            <button type="submit" id="searchBtn" class="secondary" aria-label="Search Components">Search</button>
            <button type="button" id="selectControlBtn" class="secondary">Select Control</button> </form>
    </header>

    <main id="controls-container">

        <div class="form-control-item" id="accordion-section" data-keywords="accordion disclosure collapse expand section toggle">
            <h2>Accordion</h2>
            <p>A vertically stacked set of interactive headings that each reveal an associated section of content.</p>
            <div class="accordion" id="myAccordion">
                <div class="accordion-item">
                     <button class="accordion-button" aria-expanded="false" aria-controls="panel1" id="btn1">Section 1</button>
                     <div id="panel1" role="region" aria-labelledby="btn1" class="accordion-panel hidden">
                         <p>Content for section 1.</p>
                     </div>
                 </div>
                 <div class="accordion-item">
                     <button class="accordion-button" aria-expanded="false" aria-controls="panel2" id="btn2">Section 2</button>
                     <div id="panel2" role="region" aria-labelledby="btn2" class="accordion-panel hidden">
                         <p>Content for section 2.</p>
                     </div>
                 </div>
            </div>
            <h3>Code Snippet</h3> <pre><code>&lt;!-- Example Accordion HTML Structure:
&lt;div class="accordion"&gt;
  &lt;div class="accordion-item"&gt;
    &lt;button class="accordion-button" aria-expanded="false" aria-controls="panel1" id="btn1"&gt;Section 1&lt;/button&gt;
    &lt;div id="panel1" role="region" aria-labelledby="btn1" class="accordion-panel hidden"&gt;
       Content for section 1.
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;div class="accordion-item"&gt;
     &lt;button class="accordion-button" aria-expanded="false" aria-controls="panel2" id="btn2"&gt;Section 2&lt;/button&gt;
     &lt;div id="panel2" role="region" aria-labelledby="btn2" class="accordion-panel hidden"&gt;
       Content for section 2.
     &lt;/div&gt;
   &lt;/div&gt;
&lt;/div&gt;
 --&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes (Accordion)</h3>
                 <ul>
                    <li>Use heading elements (e.g., `h3`) inside the `button` for semantic structure, or ensure button text is descriptive.</li>
                    <li>`aria-expanded` indicates state (true/false).</li>
                    <li>`aria-controls` links button to its panel.</li>
                    <li>Panel needs `role="region"` and `aria-labelledby` pointing to the button's ID.</li>
                    <li>Panel should be hidden/shown (e.g., using `display: none;` or the `hidden` attribute) based on `aria-expanded`.</li>
                    <li>Keyboard: Buttons focusable; Enter/Space toggles expansion. Arrow keys might navigate between buttons.</li>
                </ul>
                </div>
        </div>

        <div class="form-control-item" id="alert-section" data-keywords="alert notification message status assertive polite live region">
            <h2>Alert</h2>
            <p>Provides brief, important, and usually time-sensitive information. Often appears dynamically.</p>
            <button type="button" id="triggerAlertBtn">Trigger Alert</button>
            <div id="alertContainer">
                 </div>
            <h3>Code Snippet</h3> <pre><code>&lt;!-- Example Alert HTML Structure:
&lt;div class="alert" role="alert"&gt;
  Your changes have been saved successfully.
&lt;/div&gt;

&lt;!-- Or for more assertive alerts (use sparingly): --&gt;
&lt;div class="alert alert-danger" role="alert" aria-live="assertive"&gt;
  Error: Please fill out all required fields.
&lt;/div&gt;
 --&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes (Alert)</h3>
                <ul>
                    <li>Use `role="alert"`.</li>
                    <li>Content injected into this container is automatically announced by most screen readers.</li>
                    <li>`aria-live="polite"` (implicit with `role="alert"`) is usually sufficient. Use `aria-live="assertive"` only for critical, time-sensitive errors.</li>
                    <li>Alerts should ideally not receive focus.</li>
                    <li>Provide a mechanism to dismiss alerts if they persist.</li>
                </ul>
                </div>
        </div>

        <div class="form-control-item" id="breadcrumb-trail-section" data-keywords="breadcrumb navigation path trail hierarchy site structure">
            <h2>Breadcrumb Trail</h2>
            <p>Shows the user's current location within the site hierarchy and provides links to parent pages.</p>
            <nav aria-label="Breadcrumb">
                <ol class="breadcrumb">
                    <li><a href="#">Home</a></li>
                    <li><a href="#">Products</a></li>
                    <li><a href="#">Accessories</a></li>
                    <li aria-current="page"><span>Headphones</span></li> </ol>
            </nav>
            <h3>Code Snippet</h3> <pre><code>&lt;!-- Example Breadcrumb HTML Structure: --&gt;
&lt;nav aria-label="Breadcrumb"&gt;
  &lt;ol class="breadcrumb"&gt;
    &lt;li&gt;&lt;a href="/"&gt;Home&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href="/category/"&gt;Category&lt;/a&gt;&lt;/li&gt;
    &lt;li aria-current="page"&gt;&lt;span&gt;Current Page&lt;/span&gt;&lt;/li&gt; &lt;!-- Use span if not linking --&gt;
  &lt;/ol&gt;
&lt;/nav&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes (Breadcrumb)</h3>
                 <ul>
                     <li>Wrap in a `<nav>` element with an `aria-label` (e.g., "Breadcrumb").</li>
                     <li>Use an ordered list (`<ol>`) as it represents a sequence.</li>
                     <li>Separate items visually (e.g., with CSS `::before` pseudo-elements containing '/').</li>
                     <li>The *last* item representing the current page should:
                         <ul>
                            <li>Have `aria-current="page"`.</li>
                            <li>Ideally *not* be a link. Use a `<span>` or similar non-interactive element.</li>
                        </ul>
                     </li>
                 </ul>
                </div>
        </div>

        <div class="form-control-item" id="buttons-section" data-keywords="button submit reset cancel action click interactive">
            <h2>Buttons</h2>
            <p>Elements to trigger actions.</p>
            <div class="form-group">
                <button type="submit">Submit Form</button>
                <button type="reset" class="secondary">Reset Fields</button>
                <button type="button" class="secondary">Cancel</button>
                <button type="button" disabled>Disabled Action</button>
                <a href="#some-section" class="button-like secondary" role="button">Link as Button</a>
            </div>
             <h3>Code Snippet</h3> <pre><code>&lt;!-- Standard Button --&gt;
&lt;button type="button"&gt;Action&lt;/button&gt;

&lt;!-- Submit Button --&gt;
&lt;button type="submit"&gt;Submit&lt;/button&gt;

&lt;!-- Reset Button --&gt;
&lt;button type="reset" class="secondary"&gt;Reset&lt;/button&gt;

&lt;!-- Disabled Button --&gt;
&lt;button type="button" disabled&gt;Cannot Click&lt;/button&gt;

&lt;!-- Link Styled as Button --&gt;
&lt;a href="#" class="button-like" role="button"&gt;Go Somewhere&lt;/a&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                 <ul>
                    <li>Use `<button>` element for actions within a form or page.</li>
                    <li>Use `<a>` with `role="button"` only when the action is navigation, but visually it should appear as a button.</li>
                    <li>Ensure sufficient text contrast against button background (WCAG 1.4.11).</li>
                    <li>Ensure clear visual focus indicator (WCAG 2.4.7).</li>
                    <li>Ensure minimum target size (44x44px recommended) (WCAG 2.5.5).</li>
                    <li>`disabled` attribute prevents interaction and is announced by screen readers.</li>
                    <li>Button text should clearly describe the action performed.</li>
                 </ul>
                </div>
        </div>

        <div class="form-control-item" id="carousel-slideshow-section" data-keywords="carousel slider slideshow rotator image gallery banner">
            <h2>Carousel / Slideshow</h2>
            <p>A rotating set of content items (e.g., images, cards). Accessibility requires careful handling of controls and announcements.</p>
            <div class="carousel"
                tabindex="0" /* Added tabindex */
                aria-roledescription="carousel"
                aria-label="Featured Items Showcase">
       
                <button type="button" class="carousel-pause-play" aria-label="Pause carousel">Pause</button> <div class="carousel-status" aria-live="polite" aria-atomic="true">
                    Item 1 of 3
                </div>

                <div class="carousel-slides">
                    <div class="carousel-slide"
                         role="group"
                         aria-roledescription="slide"
                         aria-label="1 of 3"> <img src="https://placehold.co/600x300/f0f0f0/333?text=Slide+1" alt="Placeholder Slide 1">
                         <p>Content for Slide 1</p>
                    </div>
                    <div class="carousel-slide"
                         role="group"
                         aria-roledescription="slide"
                         aria-label="2 of 3">
                         <img src="https://placehold.co/600x300/e0e0e0/333?text=Slide+2" alt="Placeholder Slide 2">
                         <p>Content for Slide 2</p>
                    </div>
                    <div class="carousel-slide"
                         role="group"
                         aria-roledescription="slide"
                         aria-label="3 of 3">
                         <img src="https://placehold.co/600x300/d0d0d0/333?text=Slide+3" alt="Placeholder Slide 3">
                         <p>Content for Slide 3</p>
                    </div>
                </div>

                <button type="button" class="carousel-button prev" aria-label="Previous Slide">‹</button>
                <button type="button" class="carousel-button next" aria-label="Next Slide">›</button>
       

                <div class="carousel-pagination" role="tablist" aria-label="Slides">
                    <button type="button" role="tab" aria-selected="true" aria-controls="slide-1-content" aria-label="Go to Slide 1"></button>
                    <button type="button" role="tab" aria-selected="false" aria-controls="slide-2-content" aria-label="Go to Slide 2"></button>
                    <button type="button" role="tab" aria-selected="false" aria-controls="slide-3-content" aria-label="Go to Slide 3"></button>
                </div>
            </div>
            <h3>Code Snippet</h3> <pre><code>&lt;!-- Example Carousel Structure (Simplified ARIA) --&gt;
&lt;div class="carousel" aria-roledescription="carousel" aria-label="Descriptive Carousel Title"&gt;
  &lt;div class="carousel-status" aria-live="polite" aria-atomic="true"&gt;
    &lt;!-- Status text updated by JS, e.g., "Item 1 of 3" --&gt;
  &lt;/div&gt;
  &lt;div class="carousel-slides"&gt;
    &lt;div class="carousel-slide" role="group" aria-roledescription="slide" aria-label="1 of 3"&gt;
      Slide 1 Content
    &lt;/div&gt;
    &lt;!-- More slides --&gt;
  &lt;/div&gt;
  &lt;button type="button" class="carousel-button prev" aria-label="Previous Slide"&gt;‹&lt;/button&gt;
  &lt;button type="button" class="carousel-button next" aria-label="Next Slide"&gt;›&lt;/button&gt;
  &lt;div class="carousel-pagination" role="tablist" aria-label="Select Slide"&gt;
    &lt;button type="button" role="tab" aria-selected="true" aria-label="Go to Slide 1"&gt;&lt;/button&gt;
    &lt;!-- More pagination buttons --&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes (Carousel)</h3>
                <ul>
                    <li>Container: `aria-roledescription="carousel"`, `aria-label` for overall description.</li>
                    <li>Slides: `role="group"`, `aria-roledescription="slide"`, `aria-label="[N] of [Total]"`</li>
                    <li>Live Region: Use `aria-live="polite"` to announce slide changes (e.g., "Item 2 of 3").</li>
                    <li>Controls (Prev/Next): Clear `aria-label` (e.g., "Previous Slide").</li>
                    <li>Pagination: Use `role="tablist"` for the container, `role="tab"` for buttons. `aria-selected="true/false"`. Provide descriptive `aria-label` for each tab button (e.g., "Go to Slide 1").</li>
                    <li>Keyboard: Ensure all controls are keyboard accessible. Consider arrow key navigation for slides.</li>
                    <li>Auto-rotation: Provide pause/play controls (WCAG 2.2.2). Pause on hover/focus.</li>
                    <li>Focus Management: Manage focus logically when interacting with controls.</li>
                 </ul>
                </div>
        </div>

        <div class="form-control-item" id="checkbox-section" data-keywords="checkbox check box toggle boolean option select multiple">
            <h2>Checkbox</h2>
            <p>Allows users to select zero or more options.</p>
            <fieldset class="checkbox-group">
                <legend>Notification Preferences</legend>
                <div class="form-group">
                    <input type="checkbox" id="checkNews" name="notifications" value="newsletter" checked>
                    <label for="checkNews" class="inline-label">Subscribe to Newsletter</label>
                </div>
                <div class="form-group">
                     <input type="checkbox" id="checkUpdates" name="notifications" value="updates">
                     <label for="checkUpdates" class="inline-label">Receive Product Updates</label>
                </div>
                <div class="form-group">
                     <input type="checkbox" id="checkOffers" name="notifications" value="offers" disabled>
                     <label for="checkOffers" class="inline-label">Get Special Offers (Unavailable)</label>
                </div>
            </fieldset>
             <h3>Code Snippet</h3> <pre><code>&lt;!-- Single Checkbox --&gt;
&lt;div class="form-group"&gt;
  &lt;input type="checkbox" id="agreeTerms" name="terms" value="agree"&gt;
  &lt;label for="agreeTerms"&gt;I agree to the terms and conditions&lt;/label&gt;
&lt;/div&gt;

&lt;!-- Grouped Checkboxes --&gt;
&lt;fieldset class="checkbox-group"&gt;
  &lt;legend&gt;Select toppings:&lt;/legend&gt;
  &lt;div class="form-group"&gt;
    &lt;input type="checkbox" id="toppingPepperoni" name="toppings" value="pepperoni"&gt;
    &lt;label for="toppingPepperoni"&gt;Pepperoni&lt;/label&gt;
  &lt;/div&gt;
  &lt;div class="form-group"&gt;
    &lt;input type="checkbox" id="toppingMushrooms" name="toppings" value="mushrooms"&gt;
    &lt;label for="toppingMushrooms"&gt;Mushrooms&lt;/label&gt;
  &lt;/div&gt;
&lt;/fieldset&gt;</code></pre>
             <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                 <ul>
                     <li><strong>Label Association:</strong> CRITICAL. Use `<label for="id">`. Clicking label should toggle checkbox.</li>
                     <li><strong>Grouping:</strong> If multiple checkboxes relate to a single question, group them using `<fieldset>` and provide a `<legend>`.</li>
                     <li><strong>State:</strong> The `checked` attribute handles the state. Screen readers announce "checked" or "not checked".</li>
                     <li><strong>Keyboard:</strong> Focusable with Tab. Spacebar toggles checked state.</li>
                     <li><strong>Target Size:</strong> Ensure the label provides a sufficient clickable area (WCAG 2.5.5). Your CSS padding seems adequate.</li>
                     <li><strong>Disabled State:</strong> Use `disabled` attribute. Visually indicate and ensure it's not interactive.</li>
                 </ul>
                </div>
        </div>

        <div class="form-control-item" id="date-and-time-input-section" data-keywords="datetime date time local input picker timestamp">
            <h2>Date and Time Input</h2>
            <p>Allows users to select both date and time (local).</p>
            <div class="form-group">
                <label for="datetimeInputExample">Event Start Date/Time</label>
                <input type="datetime-local" id="datetimeInputExample" name="event_start" aria-describedby="datetimeHelp">
                <small id="datetimeHelp" class="help-text">Select date and local time.</small>
            </div>
            <h3>Code Snippet</h3> <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="meetingTime"&gt;Meeting Date and Time:&lt;/label&gt;
  &lt;input type="datetime-local" id="meetingTime" name="meeting_datetime"
         min="2025-05-01T08:30" max="2025-12-31T17:00"
         aria-describedby="meetingTimeHelp"&gt;
  &lt;small id="meetingTimeHelp" class="help-text"&gt;Select date and time (YYYY-MM-DDTHH:MM).&lt;/small&gt;
&lt;/div&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                     <li><strong>Label Association:</strong> Essential (`for`/`id`).</li>
                     <li><strong>Type Attribute:</strong> `type="datetime-local"` triggers browser's native date/time picker UI.</li>
                     <li><strong>Picker Accessibility:</strong> Varies significantly between browsers. Some native pickers have poor keyboard accessibility. TEST thoroughly.</li>
                     <li><strong>Format Hint:</strong> Provide format guidance (`aria-describedby`) as presentation varies. Value format is `YYYY-MM-DDTHH:MM`.</li>
                     <li><strong>Keyboard Input:</strong> Users should ideally be able to type the date/time directly.</li>
                     <li><strong>Custom Pickers:</strong> If native pickers are inadequate, use a well-vetted accessible custom date/time picker component.</li>
                     <li><strong>Min/Max Attributes:</strong> Define allowed range if applicable.</li>
                     <li><strong>Target Size:</strong> Ensure min. 44px height (WCAG 2.5.5).</li>
                 </ul>
                </div>
        </div>

        <div class="form-control-item" id="date-input-section" data-keywords="date input picker calendar select day month year">
            <h2>Date Input</h2>
            <p>Allows users to select a specific date.</p>
            <div class="form-group">
                <label for="dateInputExample">Appointment Date</label>
                <input type="date" id="dateInputExample" name="appointment_date" min="2024-01-01" max="2025-12-31" aria-describedby="dateHelp">
                <small id="dateHelp" class="help-text">Format: MM/DD/YYYY. Use calendar or type.</small>
            </div>
            <h3>Code Snippet</h3> <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="birthDate"&gt;Date of Birth:&lt;/label&gt;
  &lt;input type="date" id="birthDate" name="dob"
         min="1900-01-01" max="2025-05-01" &lt;!-- Example range --&gt;
         aria-describedby="birthDateHelp"&gt;
  &lt;small id="birthDateHelp" class="help-text"&gt;Enter as MM/DD/YYYY or use picker.&lt;/small&gt;
&lt;/div&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                 <ul>
                     <li><strong>Label Association:</strong> Essential (`for`/`id`).</li>
                     <li><strong>Type Attribute:</strong> `type="date"` triggers browser's native date picker UI.</li>
                     <li><strong>Picker Accessibility:</strong> Varies between browsers. TEST.</li>
                     <li><strong>Format Hint:</strong> Provide format guidance (`aria-describedby`). Value format is `YYYY-MM-DD`.</li>
                     <li><strong>Keyboard Input:</strong> Should allow direct typing.</li>
                     <li><strong>Custom Pickers:</strong> Consider accessible custom pickers if native ones are problematic.</li>
                     <li><strong>Min/Max Attributes:</strong> Define allowed date range.</li>
                     <li><strong>Target Size:</strong> Ensure min. 44px height (WCAG 2.5.5).</li>
                 </ul>
                </div>
        </div>

        <div class="form-control-item" id="email-input-section" data-keywords="email address input contact">
            <h2>Email Input</h2>
            <p>Input specifically for email addresses.</p>
            <div class="form-group">
                <label for="emailInputExample">Email Address</label>
                <input type="email" id="emailInputExample" name="user_email" placeholder="you@example.com" aria-describedby="emailHelp">
                 <small id="emailHelp" class="help-text">We'll never share your email with anyone else.</small>
            </div>
            <h3>Code Snippet</h3> <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="userEmail"&gt;Your Email Address:&lt;/label&gt;
  &lt;input type="email" id="userEmail" name="email"
         placeholder="name@domain.com" required aria-required="true"
         multiple &lt;!-- Allows multiple comma-separated emails --&gt;
         aria-describedby="userEmailHelp"&gt;
  &lt;small id="userEmailHelp" class="help-text"&gt;Enter a valid email address.&lt;/small&gt;
&lt;/div&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                 <ul>
                     <li>Follows general Text Input principles (Label, Focus, Target Size, etc.).</li>
                     <li><strong>Type Attribute:</strong> `type="email"` provides semantic meaning, triggers appropriate mobile keyboards, and enables browser-level validation for email format (WCAG 3.3.1).</li>
                     <li><strong>Multiple Attribute:</strong> If present, allows a list of comma-separated email addresses.</li>
                     <li><strong>Validation Feedback:</strong> Ensure validation errors (native or custom) are clearly communicated accessibly (WCAG 3.3.1, 4.1.3).</li>
                 </ul>
                </div>
        </div>

        <div class="form-control-item" id="file-input-upload-section" data-keywords="file input upload attachment select image document">
            <h2>File Input / Upload</h2>
            <p>Allows users to select files for upload.</p>
            <div class="form-group">
                 <label for="fileInputExample">Upload Your Resume (PDF or DOCX)</label>
                 <div class="file-input-wrapper">
                     <button type="button" class="button-like secondary" aria-hidden="true" tabindex="-1">Choose File</button>
                     <span class="file-name-display" id="fileNameDisplayResume">No file chosen</span>
                     <input type="file" id="fileInputExample" name="resume" accept=".pdf,.docx,.doc" aria-describedby="fileHelp resumeConstraints" onchange="document.getElementById('fileNameDisplayResume').textContent = this.files.length > 0 ? this.files[0].name : 'No file chosen';">
                 </div>
                 <small id="fileHelp" class="help-text">Max file size: 5MB.</small>
                 <div id="resumeConstraints" class="help-text">Accepted formats: PDF, DOC, DOCX.</div>
            </div>
            <h3>Code Snippet</h3> <pre><code>&lt;!-- Basic File Input --&gt;
&lt;div class="form-group"&gt;
  &lt;label for="avatarUpload"&gt;Upload Profile Picture:&lt;/label&gt;
  &lt;input type="file" id="avatarUpload" name="avatar"
         accept="image/png, image/jpeg" &lt;!-- Specify accepted types --&gt;
         aria-describedby="avatarHelp"&gt;
  &lt;small id="avatarHelp" class="help-text"&gt;PNG or JPG only. Max 2MB.&lt;/small&gt;
&lt;/div&gt;

&lt;!-- Custom Styled File Input (like example above) --&gt;
&lt;div class="form-group"&gt;
  &lt;label for="reportFile"&gt;Upload Report:&lt;/label&gt;
  &lt;div class="file-input-wrapper"&gt;
     &lt;!-- Decorative button (hidden from AT) --&gt;
     &lt;button type="button" class="button-like secondary" aria-hidden="true" tabindex="-1"&gt;Choose File&lt;/button&gt;
     &lt;!-- Display area for file name --&gt;
     &lt;span class="file-name-display" id="fileNameDisplayReport"&gt;No file chosen&lt;/span&gt;
     &lt;!-- Actual file input (visually hidden/layered) --&gt;
     &lt;input type="file" id="reportFile" name="report" accept=".pdf,.txt"
            aria-describedby="reportHelp"
            onchange="..."&gt; &lt;!-- JS to update span --&gt;
  &lt;/div&gt;
  &lt;small id="reportHelp" class="help-text"&gt;PDF or TXT.&lt;/small&gt;
&lt;/div&gt;</code></pre>
            <p><em>Note: Basic styling provided. Robust JS often needed for custom styling and feedback.</em></p>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                     <li><strong>Label Association:</strong> Essential (`for`/`id`).</li>
                     <li><strong>Native Input:</strong> The default `<input type="file">` is keyboard accessible but difficult to style consistently.</li>
                     <li><strong>Custom Styling Pattern:**
                         <ul>
                             <li>Hide the actual `<input type="file">` visually but keep it accessible (e.g., opacity: 0, position absolute).</li>
                             <li>Use a visible `<button>` (often with `aria-hidden="true"`) and/or styled `<span>` layered over the actual input. The label still points to the hidden input's ID.</li>
                             <li>Use JS to display the selected filename(s) in a separate element (like the `<span>` in the example).</li>
                             <li>Ensure the interactive area (the visible button/span) is large enough (WCAG 2.5.5).</li>
                         </ul>
                     </li>
                     <li><strong>`accept` Attribute:</strong> Specify allowed file types (MIME types or extensions) to assist users.</li>
                     <li><strong>Feedback:</strong> Provide clear feedback on selection, upload progress, and errors accessibly (e.g., using `aria-live` regions).</li>
                </ul>
                </div>
        </div>

        <div class="form-control-item" id="hidden-input-section" data-keywords="hidden input invisible data parameter form submission">
            <h2>Hidden Input</h2>
            <p>Non-visible input for submitting data.</p>
            <form>
                <input type="hidden" id="csrfToken" name="_csrf_token" value="aBcDeF12345GHIjkl">
                <input type="hidden" id="sessionId" name="session_id" value="zyXwVu98765TsRqPo">
                 <button type="submit">Submit with Hidden Data</button>
            </form>
             <h3>Code Snippet</h3> <pre><code>&lt;form action="/process" method="post"&gt;
  &lt;!-- Hidden input for security token --&gt;
  &lt;input type="hidden" name="csrf_token" value="UNIQUE_TOKEN_HERE"&gt;

  &lt;!-- Hidden input for tracking source --&gt;
  &lt;input type="hidden" name="source" value="campaign_xyz"&gt;

  &lt;!-- Visible form fields here --&gt;
  &lt;label for="visibleField"&gt;Visible Data:&lt;/label&gt;
  &lt;input type="text" id="visibleField" name="visible_data"&gt;

  &lt;button type="submit"&gt;Submit&lt;/button&gt;
&lt;/form&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                    <li>`type="hidden"` fields are completely ignored by assistive technologies and are not part of the accessibility tree or tab order.</li>
                    <li>They have no direct accessibility implications for end-users interacting with the form.</li>
                    <li>Ensure they are used for data that the user does not need to know about or interact with directly (e.g., session IDs, security tokens, tracking parameters).</li>
                    <li>Do NOT use them to hide information that *should* be available to the user.</li>
                 </ul>
                </div>
        </div>

        <div class="form-control-item" id="listbox-examples-section" data-keywords="listbox select list options scrollable grouped rearrangeable multiselect">
            <h2>Listbox Examples</h2>
            <p>Allows selection from a list of options, similar to a native select but often used for custom UI or multi-select.</p>

            <h3>Scrollable Listbox</h3>
            <div class="listbox-container">
                <label id="lb1-label" class="listbox-label">Choose your primary skill:</label>
                <ul id="lb1"
                    tabindex="0"
                    role="listbox"
                    aria-labelledby="lb1-label"
                    aria-activedescendant=""> <li id="lb1-opt1" role="option" aria-selected="false">HTML</li>
                     <li id="lb1-opt2" role="option" aria-selected="false">CSS</li>
                     <li id="lb1-opt3" role="option" aria-selected="false">JavaScript</li>
                     <li id="lb1-opt4" role="option" aria-selected="false">React</li>
                     <li id="lb1-opt5" role="option" aria-selected="false">Angular</li>
                     <li id="lb1-opt6" role="option" aria-selected="false">Vue</li>
                     <li id="lb1-opt7" role="option" aria-selected="false">Python</li>
                     <li id="lb1-opt8" role="option" aria-selected="false">PHP</li>
                     <li id="lb1-opt9" role="option" aria-selected="false">Ruby</li>
                </ul>
            </div>
             <h3>Code Snippet</h3> <pre><code>&lt;!-- Scrollable Single-Select Listbox --&gt;
&lt;div class="listbox-container"&gt;
  &lt;label id="country-label" class="listbox-label"&gt;Select Country:&lt;/label&gt;
  &lt;ul id="country-listbox"
      tabindex="0" &lt;!-- Make the container focusable --&gt;
      role="listbox"
      aria-labelledby="country-label"
      aria-activedescendant="" &lt;!-- Updated by JS --&gt;
      style="max-height: 150px; overflow-y: auto;"&gt;
    &lt;li id="country-opt1" role="option" aria-selected="false"&gt;Canada&lt;/li&gt;
    &lt;li id="country-opt2" role="option" aria-selected="false"&gt;Mexico&lt;/li&gt;
    &lt;li id="country-opt3" role="option" aria-selected="false"&gt;USA&lt;/li&gt;
    &lt;!-- More options --&gt;
  &lt;/ul&gt;
&lt;/div&gt;</code></pre>

            <h3 style="margin-top: calc(var(--spacing-unit)*4);">Listbox with Grouped Options</h3>
             <div class="listbox-container">
                 <label id="lb2-label" class="listbox-label">Choose a framework/library:</label>
                 <ul id="lb2"
                     tabindex="0"
                     role="listbox"
                     aria-labelledby="lb2-label"
                     aria-activedescendant="">
                     <li role="presentation" class="listbox-group-label" id="lb2-group1-label">Frontend</li>
                     <li id="lb2-opt1" role="option" aria-selected="false">React</li>
                     <li id="lb2-opt2" role="option" aria-selected="false">Angular</li>
                     <li id="lb2-opt3" role="option" aria-selected="false">Vue</li>
                     <li role="presentation" class="listbox-group-label" id="lb2-group2-label">Backend</li>
                     <li id="lb2-opt4" role="option" aria-selected="false">Node.js</li>
                     <li id="lb2-opt5" role="option" aria-selected="false">Django</li>
                     <li id="lb2-opt6" role="option" aria-selected="false">Ruby on Rails</li>
                 </ul>
            </div>
             <h3>Code Snippet</h3> <pre><code>&lt;!-- Grouped Listbox --&gt;
&lt;div class="listbox-container"&gt;
  &lt;label id="food-label" class="listbox-label"&gt;Select Food Item:&lt;/label&gt;
  &lt;ul id="food-listbox"
      tabindex="0" role="listbox" aria-labelledby="food-label"&gt;
    &lt;li role="presentation" class="listbox-group-label" id="fruit-group"&gt;Fruits&lt;/li&gt;
    &lt;li id="food-opt1" role="option" aria-selected="false"&gt;Apple&lt;/li&gt;
    &lt;li id="food-opt2" role="option" aria-selected="false"&gt;Banana&lt;/li&gt;
    &lt;li role="presentation" class="listbox-group-label" id="veg-group"&gt;Vegetables&lt;/li&gt;
    &lt;li id="food-opt3" role="option" aria-selected="false"&gt;Carrot&lt;/li&gt;
    &lt;li id="food-opt4" role="option" aria-selected="false"&gt;Broccoli&lt;/li&gt;
 &lt;/ul&gt;
&lt;/div&gt;</code></pre>


            <h3 style="margin-top: calc(var(--spacing-unit)*4);">Listbox with Rearrangeable Options (Simplified)</h3>
            <p><em>Note: Full keyboard support for rearranging is complex and omitted here. This example focuses on structure and basic interaction.</em></p>
            <div class="rearrange-listbox-wrapper">
                 <div class="listbox-container" style="flex-grow: 1;">
                     <label id="lb3-label" class="listbox-label">Prioritize Tasks:</label>
                     <ul id="lb3"
                         tabindex="0"
                         role="listbox"
                         aria-labelledby="lb3-label"
                         aria-multiselectable="false"
                         aria-activedescendant="">
                         <li id="lb3-opt1" role="option" aria-selected="false">Task A: Design Mockups</li>
                         <li id="lb3-opt2" role="option" aria-selected="false">Task B: Develop API</li>
                         <li id="lb3-opt3" role="option" aria-selected="false">Task C: Write Tests</li>
                         <li id="lb3-opt4" role="option" aria-selected="false">Task D: User Documentation</li>
                     </ul>
                 </div>
                 <div class="rearrange-buttons">
                      <button type="button" aria-label="Move selected item up" class="move-up-btn">▲</button>
                      <button type="button" aria-label="Move selected item down" class="move-down-btn">▼</button>
                 </div>
            </div>
             <h3>Code Snippet</h3> <pre><code>&lt;!-- Rearrangeable Listbox --&gt;
&lt;div class="rearrange-listbox-wrapper"&gt;
  &lt;div class="listbox-container" style="flex-grow: 1;"&gt;
    &lt;label id="priority-label" class="listbox-label"&gt;Set Priority:&lt;/label&gt;
    &lt;ul id="priority-listbox"
        tabindex="0" role="listbox" aria-labelledby="priority-label"&gt;
      &lt;li id="prio-opt1" role="option" aria-selected="false"&gt;Item One&lt;/li&gt;
      &lt;li id="prio-opt2" role="option" aria-selected="false"&gt;Item Two&lt;/li&gt;
      &lt;li id="prio-opt3" role="option" aria-selected="false"&gt;Item Three&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/div&gt;
  &lt;div class="rearrange-buttons"&gt;
    &lt;button type="button" aria-label="Move selected item up" class="move-up-btn"&gt;▲&lt;/button&gt;
    &lt;button type="button" aria-label="Move selected item down" class="move-down-btn"&gt;▼&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>

            <div class="accessibility-notes">
                <h3>Accessibility Notes (Listbox)</h3>
                <ul>
                    <li><strong>Role Structure:</strong> Container `role="listbox"`. Items `role="option"`.</li>
                    <li><strong>Labeling:</strong> `aria-labelledby` points to a visible `<label>`.</li>
                    <li><strong>Focus Management:**
                         <ul>
                             <li>Listbox container `tabindex="0"`.</li>
                             <li>Focus stays on container; `aria-activedescendant` points to focused option ID.</li>
                             <li>Options usually `tabindex="-1"` or no tabindex.</li>
                         </ul>
                    </li>
                    <li><strong>Selection State:** `aria-selected="true|false"` on options. Update via JS.</li>
                    <li><strong>Multi-Select:** Add `aria-multiselectable="true"` to listbox container. Implement keyboard (Shift/Ctrl).</li>
                    <li><strong>Keyboard Navigation (Essential):**
                         <ul>
                             <li>Down/Up Arrow: Move visual focus (`aria-activedescendant`).</li>
                             <li>Home/End: Move to first/last option.</li>
                             <li>Letter Keys: Type-ahead (Move focus to next option starting with letter).</li>
                             <li>Enter/Space: Select/deselect focused option.</li>
                         </ul>
                         (WCAG 2.1.1 Keyboard)
                    </li>
                     <li><strong>Scrollable Listbox:** Keyboard navigation must scroll focused option into view.</li>
                     <li><strong>Grouped Listbox:** Use `role="presentation"` on label `<li>` OR use `role="group"` around options. Keyboard nav should skip labels.</li>
                     <li><strong>Rearrangeable Listbox:** COMPLEX.
                         <ul>
                             <li>Provide explicit visual buttons (Up/Down).</li>
                             <li>Provide keyboard-only method (e.g., Ctrl+Arrows). MUST HAVE. (WCAG 2.1.1, 2.5.7 if drag/drop added)</li>
                             <li>Announce new position after move (e.g., via `aria-live`).</li>
                         </ul>
                     </li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" id="modal-dialog-section" data-keywords="modal dialog popup window overlay accessible focus trap">
            <h2>Modal Dialog</h2>
            <p>A window overlaid on the primary content, requiring user interaction. Must trap focus and be dismissible.</p>
            <button type="button" id="openDialogBtn" data-dialog-id="addressDialog">
                Open Address Dialog
            </button>

            <div id="addressDialogOverlay" class="dialog-overlay hidden"> <div role="dialog"
                     id="addressDialog"
                     aria-labelledby="dialog1_label"
                     aria-modal="true"
                     class="dialog">
                     <button type="button" class="dialog-close-btn" aria-label="Close dialog">&times;</button>
                     <h2 id="dialog1_label" class="dialog_label">
                         Add Delivery Address
                     </h2>
                     <div class="dialog-content"> <form class="dialog_form">
                         <div class="form-group">
                             <label for="dialog-street">Street:</label>
                             <input type="text" id="dialog-street" class="wide_input">
                         </div>
                         <div class="form-group">
                             <label for="dialog-city">City:</label>
                             <input type="text" id="dialog-city" class="city_input">
                         </div>
                         <div class="form-group">
                             <label for="dialog-state">State:</label>
                             <input type="text" id="dialog-state" class="state_input">
                         </div>
                          <div class="form-group">
                             <label for="dialog-zip">Zip:</label>
                             <input type="text" id="dialog-zip" class="zip_input">
                         </div>
                     </form> </div> <div class="dialog_form_actions">
                         <button type="button" class="dialog-add-btn">Add</button>
                         <button type="button" class="dialog-cancel-btn secondary">Cancel</button>
                     </div>
                 </div>
            </div>

            <h3>Code Snippet</h3> <pre><code>&lt;!-- Trigger Button --&gt;
&lt;button type="button" id="openMyDialogBtn"&gt;Open Modal&lt;/button&gt;

&lt;!-- Dialog Structure --&gt;
&lt;div id="myDialogOverlay" class="dialog-overlay hidden"&gt;
  &lt;div role="dialog"
       id="myDialog"
       aria-labelledby="myDialogLabel"
       aria-describedby="myDialogDesc" &lt;!-- Optional --&gt;
       aria-modal="true"
       class="dialog"&gt;

    &lt;button type="button" class="dialog-close-btn" aria-label="Close Dialog"&gt;&times;&lt;/button&gt;

    &lt;h2 id="myDialogLabel" class="dialog_label"&gt;Dialog Title&lt;/h2&gt;

    &lt;div class="dialog-content"&gt;
        &lt;p id="myDialogDesc"&gt;This is the main content or description of the dialog.&lt;/p&gt;
        &lt;!-- More form elements or content --&gt;
    &lt;/div&gt;

    &lt;div class="dialog_form_actions"&gt;
      &lt;button type="button" class="dialog-confirm-btn"&gt;Confirm&lt;/button&gt;
      &lt;button type="button" class="dialog-cancel-btn secondary"&gt;Cancel&lt;/button&gt;
    &lt;/div&gt;

  &lt;/div&gt;
&lt;/div&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes (Modal Dialog)</h3>
                <ul>
                    <li><strong>Role & State:</strong> Use `role="dialog"` and `aria-modal="true"`.</li>
                    <li><strong>Labeling:</strong> Provide label via `aria-labelledby` pointing to a visible heading (`h2` preferred).</li>
                    <li><strong>Description (Optional):</strong> `aria-describedby` for additional descriptive text.</li>
                    <li><strong>Visibility & Overlay:</strong> Hide initially. JS shows/hides. Overlay obscures background.</li>
                    <li><strong>Focus Management (CRITICAL):**
                         <ul>
                             <li>On open, focus moves inside (e.g., first input or close button).</li>
                             <li>Focus is trapped within the dialog (Tab/Shift+Tab cycle inside).</li>
                             <li>On close, focus returns to the trigger element.</li>
                         </ul>
                         (WCAG 2.4.3 Focus Order, 2.1.1 Keyboard)
                    </li>
                    <li><strong>Keyboard Dismissal:</strong> Allow closing via Escape key.</li>
                    <li><strong>Dismiss Button:</strong> Provide clearly labeled, keyboard-accessible close button.</li>
                    <li><strong>Background Inertness:** Use JS focus trapping. `aria-hidden="true"` on background elements or native `<dialog>` behavior can also help.</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" id="month-input-section" data-keywords="month input picker select year month">
            <h2>Month Input</h2>
            <p>Allows users to select month and year.</p>
            <div class="form-group">
                 <label for="monthInputExample">Billing Cycle Month</label>
                 <input type="month" id="monthInputExample" name="billing_month" min="2024-01" max="2025-12" aria-describedby="monthHelp">
                 <small id="monthHelp" class="help-text">Select billing month/year (YYYY-MM).</small>
            </div>
             <h3>Code Snippet</h3> <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="expiryMonth"&gt;Card Expiry Month/Year:&lt;/label&gt;
  &lt;input type="month" id="expiryMonth" name="card_expiry"
         min="2025-05" &lt;!-- Example: Current month/year --&gt;
         aria-describedby="expiryHelp"&gt;
  &lt;small id="expiryHelp" class="help-text"&gt;Format: YYYY-MM.&lt;/small&gt;
&lt;/div&gt;</code></pre>
             <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                 <ul>
                     <li><strong>Label Association:</strong> Essential (`for`/`id`).</li>
                     <li><strong>Type Attribute:</strong> `type="month"` triggers browser's native month/year picker.</li>
                     <li><strong>Picker Accessibility:</strong> Varies. TEST.</li>
                     <li><strong>Format Hint:</strong> Provide format (`YYYY-MM`) guidance via `aria-describedby`.</li>
                     <li><strong>Keyboard/Custom Pickers:</strong> Similar considerations as Date Input.</li>
                     <li><strong>Target Size:</strong> Ensure min. 44px height. (WCAG 2.5.5)</li>
                 </ul>
            </div>
        </div>

        <div class="form-control-item" id="number-input-section" data-keywords="number numeric input integer float quantity amount spinner">
            <h2>Number Input</h2>
            <p>Input for numerical values.</p>
              <div class="form-group">
                 <label for="numberInputExample">Quantity</label>
                 <input type="number" id="numberInputExample" name="quantity" min="1" max="10" step="1" value="1" aria-describedby="numberHelp">
                 <small id="numberHelp" class="help-text">Enter whole number (1-10).</small>
            </div>
             <h3>Code Snippet</h3> <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="itemQuantity"&gt;Number of Items:&lt;/label&gt;
  &lt;input type="number" id="itemQuantity" name="quantity"
         min="0" max="99" step="1" value="1" &lt;!-- Example range/step --&gt;
         required aria-required="true"
         aria-describedby="quantityHelp"&gt;
  &lt;small id="quantityHelp" class="help-text"&gt;Enter a whole number between 0 and 99.&lt;/small&gt;
&lt;/div&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                 <ul>
                     <li><strong>Label Association:</strong> Essential (`for`/`id`).</li>
                     <li><strong>Type Attribute:</strong> `type="number"` triggers numeric keyboard on mobile and enables browser validation/spinner controls.</li>
                     <li><strong>Spinner Controls:</strong> Accessibility of native spinners varies. Ensure direct typing is easy and effective. Consider hiding spinners via CSS if problematic and relying on typing.</li>
                     <li><strong>Min/Max/Step Attributes:</strong> Define constraints programmatically (WCAG 3.3.2).</li>
                     <li><strong>Validation:</strong> Native validation checks format/range. Ensure errors are communicated accessibly.</li>
                     <li><strong>Target Size:</strong> Ensure min. 44px height (WCAG 2.5.5).</li>
                 </ul>
            </div>
        </div>

        <div class="form-control-item" id="password-input-section" data-keywords="password secret input secure">
            <h2>Password Input</h2>
            <p>Input for sensitive information.</p>
            <div class="form-group">
                <label for="passwordInputExample">Password</label>
                <div class="password-input-container"> 
                    <input type="password" id="passwordInputExample" name="user_pass" required aria-required="true" aria-describedby="passwordHelp" autocomplete="current-password">
                    
                    <button type="button"
                            id="passwordToggleBtn"
                            class="password-toggle-btn"
                            aria-label="Show password"
                            aria-controls="passwordInputExample">
                        Show
                    </button>
                </div>
                <small id="passwordHelp" class="help-text">Must be at least 8 characters long.</small>
            </div>
            <h3>Code Snippet</h3> <pre><code>&lt;!-- Password input with Show/Hide Toggle --&gt;
       &lt;div class="form-group"&gt;
        &lt;label for="userPassword"&gt;Enter Password:&lt;/label&gt;
        &lt;div class="password-input-container"&gt; &lt;!-- Wrapper recommended for positioning --&gt;
          &lt;input type="password" id="userPassword" name="password"
                 required aria-required="true"
                 autocomplete="current-password" &lt;!-- Or "new-password" --&gt;
                 aria-describedby="passwordRules"&gt;
          &lt;button type="button" class="password-toggle-btn"
                  aria-label="Show password"
                  aria-controls="userPassword"&gt; &lt;!-- Controls the input --&gt;
            Show
          &lt;/button&gt;
        &lt;/div&gt;
        &lt;small id="passwordRules" class="help-text"&gt;Minimum 8 characters, one number.&lt;/small&gt;
       &lt;/div&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                    <li>Follows Text Input principles (Label, Focus, Target Size).</li>
                    <li>`type="password"` masks input visually.</li>
                    <li>**Show/Hide Toggle:** Strongly recommend adding an accessible button to toggle visibility (`type="password"` to `type="text"`).
                        <ul>
                            <li>Button needs clear label (e.g., "Show password", "Hide password") - **Use `aria-label`**.</li>
                            <li>Announce state change by updating the `aria-label` and button text.</li>
                            <li>Use `aria-controls` to link button to the input.</li>
                            <li>Ensure button is keyboard accessible and has sufficient target size/clickable area.</li>
                        </ul>
                        (Helps meet WCAG 3.3.8 Accessible Authentication)
                    </li>
                    <li>`autocomplete` attribute (`current-password`, `new-password`) helps password managers (WCAG 1.3.5 Identify Input Purpose).</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" id="radio-buttons-section" data-keywords="radio button option select single choice">
            <h2>Radio Buttons</h2>
            <p>Allows users to select exactly one option.</p>
             <fieldset class="radio-group">
                 <legend>Preferred Contact Method <span class="required-indicator" aria-hidden="true">*</span></legend>
                 <div class="form-group">
                     <input type="radio" id="contactEmail" name="contact_method" value="email" checked required aria-required="true">
                     <label for="contactEmail" class="inline-label">Email</label>
                 </div>
                 <div class="form-group">
                     <input type="radio" id="contactPhone" name="contact_method" value="phone" required aria-required="true">
                     <label for="contactPhone" class="inline-label">Phone</label>
                 </div>
                 <div class="form-group">
                      <input type="radio" id="contactMail" name="contact_method" value="mail" required aria-required="true" disabled>
                      <label for="contactMail" class="inline-label">Postal Mail (Unavailable)</label>
                 </div>
             </fieldset>
             <h3>Code Snippet</h3> <pre><code>&lt;fieldset class="radio-group"&gt;
  &lt;legend&gt;Select Delivery Option:&lt;/legend&gt;
  &lt;div class="form-group"&gt;
    &lt;input type="radio" id="deliveryStandard" name="delivery_option" value="standard" checked&gt;
    &lt;label for="deliveryStandard"&gt;Standard (5-7 days)&lt;/label&gt;
  &lt;/div&gt;
  &lt;div class="form-group"&gt;
    &lt;input type="radio" id="deliveryExpress" name="delivery_option" value="express"&gt;
    &lt;label for="deliveryExpress"&gt;Express (1-2 days)&lt;/label&gt;
  &lt;/div&gt;
  &lt;div class="form-group"&gt;
    &lt;input type="radio" id="deliveryPickup" name="delivery_option" value="pickup" disabled&gt;
    &lt;label for="deliveryPickup"&gt;In-Store Pickup (Not Available)&lt;/label&gt;
  &lt;/div&gt;
&lt;/fieldset&gt;</code></pre>
             <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                    <li><strong>Label Association:</strong> CRITICAL (`for`/`id`).</li>
                    <li><strong>Grouping:</strong> MUST use `<fieldset>`/`<legend>` to group related radio buttons. The legend describes the group question.</li>
                    <li><strong>`name` Attribute:</strong> MUST be identical for all radios in a group to ensure only one can be selected. (WCAG 1.3.1, 4.1.2)</li>
                    <li><strong>State:</strong> `checked` attribute indicates selection. Announced by screen readers.</li>
                    <li><strong>Keyboard:</strong> Arrow keys (Up/Down/Left/Right) navigate *and select* within the group once one radio has focus. Tab moves into/out of the entire group.</li>
                    <li><strong>Default Selection:</strong> Recommended to have one option selected by default.</li>
                    <li><strong>Target Size:</strong> Ensure label provides sufficient clickable area (WCAG 2.5.5).</li>
                 </ul>
            </div>
        </div>

        <div class="form-control-item" id="range-input-slider-section" data-keywords="range input slider select value volume brightness percentage">
            <h2>Range Input (Slider)</h2>
            <p>Allows selection of a value within a range.</p>
            <div class="form-group range-group">
                <label for="rangeInputExample">Volume</label>
                <input type="range" id="rangeInputExample" name="volume" min="0" max="100" step="1" value="50" aria-describedby="rangeValueHelp">
                <output for="rangeInputExample" class="range-value" id="rangeValueOutput">50</output>
                <small id="rangeValueHelp" class="help-text visually-hidden">Use arrow keys to adjust. Current value is displayed.</small>
            </div>
             <h3>Code Snippet</h3> <pre><code>&lt;div class="form-group range-group"&gt;
  &lt;label for="brightnessRange"&gt;Brightness:&lt;/label&gt;
  &lt;input type="range" id="brightnessRange" name="brightness"
         min="0" max="100" step="10" value="70"
         aria-describedby="brightnessValueHelp"&gt;
  &lt;output for="brightnessRange" class="range-value" id="brightnessOutput"&gt;70&lt;/output&gt;%
  &lt;small id="brightnessValueHelp" class="help-text visually-hidden"&gt;Use arrow keys. Current value shown.&lt;/small&gt;
&lt;/div&gt;</code></pre>
             <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                 <ul>
                     <li><strong>Label Association:</strong> Essential (`for`/`id`).</li>
                     <li><strong>Communicating Value:</strong> CRITICAL. Screen reader users cannot see the slider position. Provide the current value accessibly:
                         <ul>
                            <li>Use `<output for="inputId">` linked to the input, updated via JS (good semantic choice).</li>
                            <li>Use `aria-valuetext` attribute on the input, updated via JS.</li>
                            <li>Include value in a nearby visible text element linked via `aria-describedby`.</li>
                         </ul>
                         (WCAG 4.1.2 Name, Role, Value)
                     </li>
                     <li><strong>Keyboard:</strong> Arrow keys adjust value (Left/Right usually; Up/Down might also work). Home/End jump to min/max. PageUp/PageDown may move in larger steps.</li>
                     <li><strong>Min/Max/Step Attributes:</strong> Define range and increments.</li>
                     <li><strong>Target Size:</strong> Ensure slider thumb/track provides adequate target area (min height helps) (WCAG 2.5.5). Styling the thumb might be needed.</li>
                 </ul>
            </div>
        </div>

        <div class="form-control-item" id="search-input-content-area-example-section" data-keywords="search find query input filter content">
            <h2>Search Input (Content Area Example)</h2>
            <p>Input specifically for search queries within the main content area.</p>
              <div class="form-group" role="search">
                 <label for="searchInputExampleContent">Search Documentation</label>
                 <div style="display: flex; align-items: center; gap: var(--spacing-unit);">
                      <input type="search" id="searchInputExampleContent" name="query_content" placeholder="Enter search term..." style="flex-grow: 1;">
                      <button type="submit" class="secondary">Search</button>
                 </div>
            </div>
             <h3>Code Snippet</h3> <pre><code>&lt;!-- Search within a landmark --&gt;
&lt;form class="form-group" role="search" action="/docs-search" method="get"&gt;
  &lt;label for="docSearchInput"&gt;Search Site Documentation:&lt;/label&gt;
  &lt;div style="display: flex; gap: 8px;"&gt;
    &lt;input type="search" id="docSearchInput" name="q"
           placeholder="e.g., accessibility, components"
           aria-label="Search Documentation" &lt;!-- Use if label not visible --&gt;
           style="flex-grow: 1;"&gt;
    &lt;button type="submit" class="secondary"&gt;Search&lt;/button&gt;
  &lt;/div&gt;
&lt;/form&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                 <ul>
                     <li>Follows Text Input principles (Label, Focus, Target Size).</li>
                     <li>`type="search"` provides semantic meaning and may add a built-in 'clear' button (browser dependent).</li>
                     <li>Visible label is preferred. If not possible, use `aria-label` on the input.</li>
                     <li>Use `role="search"` on the containing `<form>` or `<div>` to create a landmark region, making it easier to navigate to.</li>
                     <li>Button Association: Ensure the search button is clearly associated (usually via `<form>` or described by label).</li>
                     <li>Dynamic Results: If results update dynamically without page reload, announce them using an `aria-live` region (WCAG 4.1.3 Status Messages).</li>
                 </ul>
            </div>
        </div>

        <div class="form-control-item" id="select-dropdown-section" data-keywords="select dropdown drop down list options picker menu">
            <h2>Select (Dropdown)</h2>
            <p>Allows users to select one option from a list.</p>
            <div class="form-group">
                <label for="selectExample">Select Your Country</label>
                <select id="selectExample" name="country">
                    <option value="" disabled selected>--Please choose an option--</option>
                    <optgroup label="North America">
                        <option value="CA">Canada</option>
                        <option value="MX">Mexico</option>
                        <option value="US">United States</option>
                    </optgroup>
                    <optgroup label="Europe">
                        <option value="FR">France</option>
                        <option value="DE">Germany</option>
                        <option value="UK">United Kingdom</option>
                    </optgroup>
                     <option value="OTHER">Other</option>
                </select>
            </div>
            <h3>Code Snippet</h3> <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="stateSelect"&gt;Select State:&lt;/label&gt;
  &lt;select id="stateSelect" name="state" required aria-required="true"&gt;
    &lt;option value="" disabled selected&gt;-- Select a State --&lt;/option&gt;
    &lt;optgroup label="West Coast"&gt;
      &lt;option value="CA"&gt;California&lt;/option&gt;
      &lt;option value="OR"&gt;Oregon&lt;/option&gt;
      &lt;option value="WA"&gt;Washington&lt;/option&gt;
    &lt;/optgroup&gt;
    &lt;optgroup label="East Coast"&gt;
      &lt;option value="NY"&gt;New York&lt;/option&gt;
      &lt;option value="MA"&gt;Massachusetts&lt;/option&gt;
      &lt;option value="FL"&gt;Florida&lt;/option&gt;
    &lt;/optgroup&gt;
    &lt;option value="Other"&gt;Other&lt;/option&gt; &lt;!-- Avoid disabling if possible --&gt;
  &lt;/select&gt;
&lt;/div&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                    <li><strong>Label Association:</strong> Essential (`for`/`id`).</li>
                    <li><strong>Native Element:</strong> Standard `<select>` is generally very accessible out-of-the-box.</li>
                    <li><strong>Options:</strong> Use `<option>`. Visible text is read by screen readers; `value` attribute is submitted.</li>
                    <li><strong>Option Groups:</strong> Use `<optgroup label="...">` for semantic grouping within long lists.</li>
                    <li><strong>Placeholder Option:</strong> Use a first option that is `disabled` and `selected` with an empty `value` (e.g., `<option value="" disabled selected>Choose...</option>`).</li>
                    <li><strong>Keyboard:</strong> Native controls handle keyboard well (Space/Alt+Down opens; Arrows navigate; Enter selects; Typing letters jumps to options).</li>
                    <li><strong>Custom Selects:</strong> Avoid building custom selects if possible. They are very complex to make fully accessible (requires managing focus, ARIA roles like `listbox`/`option`, `aria-expanded`, selection state, keyboard nav, etc.). Stick to native `<select>` unless absolutely necessary.</li>
                    <li><strong>Target Size:</strong> Ensure min. 44px height (WCAG 2.5.5).</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" id="text-input-section" data-keywords="text input field textfield string">
            <h2>Text Input</h2>
            <p>Standard input for single-line text.</p>
            <div class="form-group">
                <label for="textInputExample" class="label-block">Your Name <span class="required-indicator" aria-hidden="true">*</span></label>
                <input type="text" id="textInputExample" name="username" placeholder="E.g., Jane Doe" required aria-required="true" aria-describedby="nameHelp">
                <small id="nameHelp" class="help-text">Please enter your full name.</small>
            </div>
             <h3>Code Snippet</h3> <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="firstName"&gt;First Name:&lt;/label&gt;
  &lt;input type="text" id="firstName" name="first_name"
         placeholder="Enter your first name"
         required aria-required="true"
         autocomplete="given-name" &lt;!-- Helps autofill --&gt;
         aria-describedby="firstNameHelp"&gt;
  &lt;small id="firstNameHelp" class="help-text"&gt;As shown on your ID.&lt;/small&gt;
&lt;/div&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                    <li><strong>Label Association:</strong> CRITICAL. `<label for="id">` must match `input id`. (WCAG 1.3.1, 3.3.2, 4.1.2)</li>
                    <li><strong>Visible Label:</strong> Always provide a visible label.</li>
                    <li><strong>Placeholder:</strong> Use only for short hints or examples, NOT as a replacement for the label. Placeholder text disappears on input and often has poor contrast. (WCAG 1.3.1, 3.3.2)</li>
                    <li><strong>Required Fields:</strong> Indicate visually (e.g., `*`) and programmatically using `required` attribute and/or `aria-required="true"`. (WCAG 3.3.2)</li>
                    <li><strong>Instructions/Hints:</strong> Provide necessary instructions or format requirements using visible text linked via `aria-describedby`.</li>
                    <li><strong>Focus Indicator:</strong> Ensure clear visual focus style (WCAG 2.4.7, 2.4.11).</li>
                    <li><strong>Target Size:</strong> Ensure sufficient height (min. 44px recommended) (WCAG 2.5.5).</li>
                     <li><strong>Autocomplete:</strong> Use appropriate `autocomplete` values (e.g., `name`, `given-name`, `street-address`) to help users autofill forms (WCAG 1.3.5).</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" id="textarea-section" data-keywords="textarea multi-line text input large comments feedback">
            <h2>Textarea</h2>
            <p>Input for multi-line text entry.</p>
            <div class="form-group">
                <label for="textareaExample">Your Comments</label>
                <textarea id="textareaExample" name="comments" rows="5" placeholder="Enter your feedback here..." aria-describedby="commentsHelp"></textarea>
                <small id="commentsHelp" class="help-text">Max 500 characters.</small>
            </div>
             <h3>Code Snippet</h3> <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="userFeedback"&gt;Feedback:&lt;/label&gt;
  &lt;textarea id="userFeedback" name="feedback"
            rows="4" cols="50" &lt;!-- Suggest initial size --&gt;
            maxlength="500" &lt;!-- Optional constraint --&gt;
            placeholder="Please provide detailed feedback..."
            aria-describedby="feedbackHelp"&gt;&lt;/textarea&gt; &lt;!-- Default content can go here --&gt;
  &lt;small id="feedbackHelp" class="help-text"&gt;Limit 500 characters.&lt;/small&gt;
&lt;/div&gt;</code></pre>
             <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                    <li>Follows Text Input principles (Label, Focus, Target Size, Required, Describedby).</li>
                    <li>Inherently accessible when correctly labeled.</li>
                    <li>`rows` and `cols` attributes suggest initial size but CSS usually controls final size.</li>
                    <li>`maxlength` attribute can limit input length. Consider providing a character count indicator if using `maxlength`.</li>
                    <li>Ensure sufficient visible size for comfortable typing. Avoid very small textareas that require excessive scrolling.</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" id="time-input-section" data-keywords="time input picker clock select hour minute second">
            <h2>Time Input</h2>
            <p>Allows users to select a specific time.</p>
            <div class="form-group">
                 <label for="timeInputExample">Meeting Start Time</label>
                 <input type="time" id="timeInputExample" name="start_time" min="09:00" max="17:00" step="1800" aria-describedby="timeHelp">
                 <small id="timeHelp" class="help-text">Select time (9AM-5PM, 30min intervals).</small>
            </div>
             <h3>Code Snippet</h3> <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="apptTime"&gt;Appointment Time:&lt;/label&gt;
  &lt;input type="time" id="apptTime" name="appointment_time"
         min="09:00" max="17:00" &lt;!-- Example business hours --&gt;
         step="900" &lt;!-- 900 seconds = 15 minutes --&gt;
         aria-describedby="apptTimeHelp"&gt;
  &lt;small id="apptTimeHelp" class="help-text"&gt;Select time between 9 AM and 5 PM.&lt;/small&gt;
&lt;/div&gt;</code></pre>
             <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                 <ul>
                     <li><strong>Label Association:</strong> Essential (`for`/`id`).</li>
                     <li><strong>Type Attribute:</strong> `type="time"` triggers browser's native time picker.</li>
                     <li><strong>Picker Accessibility:</strong> Varies by browser. TEST.</li>
                     <li><strong>Format Hint:</strong> Provide guidance (e.g., HH:MM AM/PM or 24-hour) via `aria-describedby`. Value format is `HH:MM`.</li>
                     <li><strong>Keyboard Input:</strong> Should allow direct typing.</li>
                     <li><strong>Min/Max/Step Attributes:</strong> Define time range and intervals (step is in seconds).</li>
                     <li><strong>Custom Pickers:</strong> Consider accessible custom pickers if native ones are inadequate.</li>
                     <li><strong>Target Size:</strong> Ensure min. 44px height (WCAG 2.5.5).</li>
                 </ul>
            </div>
        </div>

        <div class="form-control-item" id="toggle-switch-section" data-keywords="toggle switch on off boolean checkbox role switch">
             <h2>Toggle Switch</h2>
             <p>Visually distinct on/off control, often used as an alternative to a checkbox.</p>
             <div class="form-group" style="display: flex; align-items: center; gap: var(--spacing-unit);">
                 <label for="toggleSwitchExample" id="toggleSwitchLabel" class="inline-label" style="margin-bottom: 0;">Enable Notifications</label>
                 <label class="switch" aria-labelledby="toggleSwitchLabel"> <input type="checkbox" id="toggleSwitchExample" name="notifications_enabled" role="switch" aria-checked="false"> <span class="slider"></span> </label>
             </div>
              <h3>Code Snippet</h3> <pre><code>&lt;div class="form-group" style="display: flex; align-items: center; gap: 8px;"&gt;
  &lt;!-- The visible label --&gt;
  &lt;label for="darkModeToggle" id="darkModeLabel" class="inline-label" style="margin-bottom: 0;"&gt;
    Dark Mode
  &lt;/label&gt;

  &lt;!-- The switch mechanism --&gt;
  &lt;label class="switch" aria-labelledby="darkModeLabel"&gt; &lt;!-- Associates label text --&gt;
    &lt;!-- Underlying checkbox holds state --&gt;
    &lt;input type="checkbox" id="darkModeToggle" name="dark_mode"
           role="switch" &lt;!-- Critical ARIA role --&gt;
           aria-checked="false"&gt; &lt;!-- State updated by JS --&gt;
    &lt;!-- Visual slider part --&gt;
    &lt;span class="slider"&gt;&lt;/span&gt;
  &lt;/label&gt;
&lt;/div&gt;</code></pre>
              <div class="accessibility-notes">
                 <h3>Accessibility Notes</h3>
                 <ul>
                     <li><strong>Underlying Element:</strong> MUST use a hidden `<input type="checkbox">` to manage state.</li>
                     <li><strong>Label Association:</strong> Associate a visible label (`<label>`) with the checkbox (`for`/`id` or wrapping). Use `aria-labelledby` on the switch container/visual element to reference the visible label's ID.</li>
                     <li><strong>ARIA Role:</strong> Add `role="switch"` to the checkbox input.</li>
                     <li><strong>ARIA State:</strong> Use `aria-checked="true|false"` on the checkbox, kept in sync with its `checked` state via JS. Screen readers announce this state (e.g., "Notifications, switch, off").</li>
                     <li><strong>Keyboard Interaction:</strong> Spacebar toggles the state (checked/unchecked).</li>
                     <li><strong>Visual Design:</strong> Ensure clear visual distinction between on/off states. Use more than just color (e.g., position of thumb). Ensure sufficient contrast.</li>
                     <li><strong>Focus Indicator:</strong> Provide a clear focus style on the interactive switch element itself.</li>
                     <li><strong>Target Size:</strong> The clickable switch element (the wrapping label or the slider span if interactive) needs minimum 44x44px target area (WCAG 2.5.5).</li>
                 </ul>
              </div>
         </div>

        <div class="form-control-item" id="url-input-section" data-keywords="url web address website link input">
            <h2>URL Input</h2>
            <p>Input for web addresses (URLs).</p>
            <div class="form-group">
                <label for="urlInputExample">Website URL</label>
                <input type="url" id="urlInputExample" name="website" placeholder="https://example.com">
            </div>
             <h3>Code Snippet</h3> <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="portfolioUrl"&gt;Portfolio Website:&lt;/label&gt;
  &lt;input type="url" id="portfolioUrl" name="portfolio_url"
         placeholder="https://your-portfolio.com"
         pattern="https://.*" &lt;!-- Optional: enforce protocol --&gt;
         title="Please include https://" &lt;!-- Tooltip for pattern --&gt;
         aria-describedby="urlHelp"&gt;
  &lt;small id="urlHelp" class="help-text"&gt;Enter the full URL starting with https://&lt;/small&gt;
&lt;/div&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                    <li>Follows Text Input principles (Label, Focus, Target Size).</li>
                    <li>`type="url"` provides semantic meaning, may trigger optimized mobile keyboards, and enables browser-level validation for URL format (WCAG 3.3.1).</li>
                    <li>`pattern` attribute can enforce specific formats (like requiring `https://`). Use `title` attribute matching the pattern for tooltip help, and provide clear instructions via `aria-describedby`.</li>
                     <li>Validation Feedback: Ensure validation errors are communicated accessibly.</li>
                </ul>
            </div>
        </div>

        <div class="form-control-item" id="week-input-section" data-keywords="week input picker select year week">
            <h2>Week Input</h2>
            <p>Allows users to select week and year.</p>
            <div class="form-group">
                <label for="weekInputExample">Select Project Week</label>
                <input type="week" id="weekInputExample" name="project_week" min="2024-W01" max="2025-W52" aria-describedby="weekHelp">
                <small id="weekHelp" class="help-text">Select project week (YYYY-W##).</small>
            </div>
             <h3>Code Snippet</h3> <pre><code>&lt;div class="form-group"&gt;
  &lt;label for="reportWeek"&gt;Reporting Week:&lt;/label&gt;
  &lt;input type="week" id="reportWeek" name="report_week"
         min="2025-W01" max="2025-W52" &lt;!-- Example range --&gt;
         aria-describedby="weekHelpInfo"&gt;
  &lt;small id="weekHelpInfo" class="help-text"&gt;Format: YYYY-W## (e.g., 2025-W20).&lt;/small&gt;
&lt;/div&gt;</code></pre>
            <div class="accessibility-notes">
                <h3>Accessibility Notes</h3>
                <ul>
                    <li><strong>Label Association:</strong> Essential (`for`/`id`).</li>
                    <li><strong>Type Attribute:</strong> `type="week"` triggers browser's native week picker.</li>
                    <li><strong>Picker Accessibility:</strong> Varies significantly. TEST.</li>
                    <li><strong>Format Hint:</strong> Provide format (`YYYY-W##`) guidance via `aria-describedby`.</li>
                    <li><strong>Keyboard/Custom Pickers:</strong> Similar considerations as Date Input.</li>
                     <li><strong>Target Size:</strong> Ensure min. 44px height (WCAG 2.5.5).</li>
                </ul>
            </div>
        </div>


    </main>

    <div id="addressDialogOverlay" class="dialog-overlay hidden">
        </div>

    <div id="controlSelectDialogOverlay" class="dialog-overlay hidden">
        <div role="dialog"
             id="controlSelectDialog"
             aria-labelledby="controlSelectDialogLabel"
             aria-modal="true"
             class="dialog control-select-dialog">
            <button type="button" class="dialog-close-btn" aria-label="Close control selection">&times;</button>
            <h2 id="controlSelectDialogLabel" class="dialog_label">Select Control to View</h2>
            <ul id="controlSelectList">
                </ul>
        </div>
    </div>

    <button id="scrollToTopBtn" title="Go to top" aria-label="Scroll to top"></button>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- Focusable Elements Selector ---
            const focusableElementsString = 'a[href], button:not([disabled]), textarea:not([disabled]), input:not([type="hidden"]):not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"]), [role="option"], [role="tab"], .accordion-button, #controlSelectList a';

            // --- Utility Functions ---
            const trapFocus = (element, event) => {
                const focusableEls = Array.from(element.querySelectorAll(focusableElementsString));
                const closeBtn = element.querySelector('.dialog-close-btn');
                if (closeBtn && !focusableEls.includes(closeBtn)) {
                     const firstActionBtnIndex = focusableEls.findIndex(el => el.closest('.dialog_form_actions') || el.closest('#controlSelectList'));
                     if (firstActionBtnIndex !== -1) {
                         focusableEls.splice(firstActionBtnIndex, 0, closeBtn);
                     } else {
                         focusableEls.unshift(closeBtn);
                     }
                }

                if (focusableEls.length === 0) return;

                const firstFocusableEl = focusableEls[0];
                const lastFocusableEl = focusableEls[focusableEls.length - 1];
                const isTabPressed = event.key === 'Tab';

                if (!isTabPressed) return;

                if (event.shiftKey) { // Shift + Tab
                    if (document.activeElement === firstFocusableEl) {
                        lastFocusableEl.focus();
                        event.preventDefault();
                    }
                } else { // Tab
                    if (document.activeElement === lastFocusableEl) {
                        firstFocusableEl.focus();
                        event.preventDefault();
                    }
                }
            };

            // --- Modal Dialog Logic (Generic) ---
            let focusedElementBeforeDialog;

            const openDialogGeneric = (dialogId, triggerButton) => {
                const dialogOverlay = document.getElementById(dialogId + 'Overlay');
                const dialog = document.getElementById(dialogId);

                if (!dialog || !dialogOverlay) {
                    console.error("Dialog or overlay not found for ID:", dialogId);
                    return;
                }

                focusedElementBeforeDialog = triggerButton || document.activeElement;

                dialogOverlay.classList.remove('hidden');
                dialog.classList.remove('hidden');
                document.body.classList.add('modal-open');

                let firstFocusable = dialog.querySelector('.dialog-close-btn');
                if (!firstFocusable) {
                    const focusableEls = Array.from(dialog.querySelectorAll(focusableElementsString));
                    firstFocusable = focusableEls.length > 0 ? focusableEls[0] : dialog;
                }
                 setTimeout(() => {
                     if(firstFocusable) firstFocusable.focus();
                 }, 50);

                const handleKeyDown = (event) => handleDialogKeyDownGeneric(event, dialogId);
                dialogOverlay.addEventListener('keydown', handleKeyDown);
                dialogOverlay._dialogKeyDownListener = handleKeyDown;
            };

            const closeDialogGeneric = (dialogElementOrButton) => {
                const dialog = dialogElementOrButton.closest('.dialog');
                if (!dialog) return;
                const dialogOverlay = dialog.closest('.dialog-overlay');
                if (!dialogOverlay) return;

                if (dialogOverlay._dialogKeyDownListener) {
                    dialogOverlay.removeEventListener('keydown', dialogOverlay._dialogKeyDownListener);
                    delete dialogOverlay._dialogKeyDownListener;
                }

                dialogOverlay.classList.add('hidden');
                dialog.classList.add('hidden');
                document.body.classList.remove('modal-open');

                if (focusedElementBeforeDialog) {
                    focusedElementBeforeDialog.focus();
                }
            };

             const handleDialogKeyDownGeneric = (event, dialogId) => {
                 const dialog = document.getElementById(dialogId);
                 if (!dialog) return;

                 if (event.key === 'Escape') {
                     closeDialogGeneric(dialog);
                 } else {
                     trapFocus(dialog, event);
                 }
             };

            // --- Address Modal Specific Listeners ---
            const addressDialogTrigger = document.getElementById('openDialogBtn');
            if (addressDialogTrigger) {
                addressDialogTrigger.addEventListener('click', () => {
                    openDialogGeneric('addressDialog', addressDialogTrigger);
                });
            }
             const addressDialogOverlay = document.getElementById('addressDialogOverlay');
             if (addressDialogOverlay) {
                 addressDialogOverlay.addEventListener('click', (event) => {
                     if (event.target === addressDialogOverlay) {
                         closeDialogGeneric(addressDialogOverlay.querySelector('.dialog'));
                     }
                     else if (event.target.classList.contains('dialog-close-btn')) {
                         closeDialogGeneric(event.target);
                     }
                     else if (event.target.classList.contains('dialog-cancel-btn')) {
                         closeDialogGeneric(event.target);
                     }
                     else if (event.target.classList.contains('dialog-add-btn')) {
                         console.log('Add button clicked');
                         closeDialogGeneric(event.target);
                     }
                 });
             }


            // --- Control Select Modal Logic ---
            const selectControlBtn = document.getElementById('selectControlBtn');
            const controlSelectOverlay = document.getElementById('controlSelectDialogOverlay');
            const controlSelectList = document.getElementById('controlSelectList');
            const controlSelectDialog = document.getElementById('controlSelectDialog');

            if (selectControlBtn && controlSelectOverlay && controlSelectList && controlSelectDialog) {
                selectControlBtn.addEventListener('click', () => {
                    controlSelectList.innerHTML = '';
                    const items = document.querySelectorAll('#controls-container .form-control-item'); // Updated selector to include all descendants
                    const sortedItems = Array.from(items)
                        .filter(item => item.id && item.querySelector('h2')) // Ensure valid id and h2
                        .sort((a, b) => {
                            const titleA = a.querySelector('h2').textContent.trim().toLowerCase();
                            const titleB = b.querySelector('h2').textContent.trim().toLowerCase();
                            return titleA.localeCompare(titleB);
                        });

                    sortedItems.forEach(item => {
                        const heading = item.querySelector('h2');
                        const itemId = item.id;
                        if (heading && itemId) {
                            const li = document.createElement('li');
                            const link = document.createElement('a');
                            link.href = `#${itemId}`;
                            link.textContent = heading.textContent.trim();
                            link.addEventListener('click', (e) => {
                                e.preventDefault();
                                const targetElement = document.getElementById(itemId);
                                closeDialogGeneric(link); // Close first
                                if (targetElement) {
                                    setTimeout(() => {
                                        targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                                        targetElement.querySelector('h2')?.focus({ preventScroll: true });
                                    }, 50);
                                }
                            });
                            li.appendChild(link);
                            controlSelectList.appendChild(li);
                        }
                    });
                    openDialogGeneric('controlSelectDialog', selectControlBtn);
                });

                 controlSelectOverlay.addEventListener('click', (event) => {
                     if (event.target === controlSelectOverlay) {
                         closeDialogGeneric(controlSelectDialog);
                     } else if (event.target.classList.contains('dialog-close-btn')) {
                          closeDialogGeneric(event.target);
                     }
                 });
            }


            // --- Accordion Logic ---
            const accordions = document.querySelectorAll('.accordion');
            accordions.forEach(accordion => {
                const buttons = accordion.querySelectorAll('.accordion-button');
                buttons.forEach(button => {
                    const panelId = button.getAttribute('aria-controls');
                    const panel = document.getElementById(panelId);
                    if (!panel) {
                         console.warn(`Accordion panel with ID "${panelId}" not found for button`, button);
                         return;
                    }

                    button.addEventListener('click', () => {
                        const isExpanded = button.getAttribute('aria-expanded') === 'true';
                        button.setAttribute('aria-expanded', !isExpanded);
                        panel.classList.toggle('hidden');
                    });
                });
            });

            // --- Alert Logic ---
            const triggerAlertBtn = document.getElementById('triggerAlertBtn');
            const alertContainer = document.getElementById('alertContainer');
            if (triggerAlertBtn && alertContainer) {
                triggerAlertBtn.addEventListener('click', () => {
                    const existingAlert = alertContainer.querySelector('.alert');
                    if (existingAlert) existingAlert.remove();

                    const newAlert = document.createElement('div');
                    newAlert.className = 'alert';
                    newAlert.setAttribute('role', 'alert');
                    newAlert.textContent = `Action completed successfully at ${new Date().toLocaleTimeString()}.`;
                    alertContainer.appendChild(newAlert);
                });
            }

// --- Carousel Logic (Enhanced) ---
const carousels = document.querySelectorAll('.carousel');
         carousels.forEach(carousel => {
             const slidesContainer = carousel.querySelector('.carousel-slides');
             const slides = carousel.querySelectorAll('.carousel-slide');
             const prevButton = carousel.querySelector('.carousel-button.prev');
             const nextButton = carousel.querySelector('.carousel-button.next');
             const paginationButtons = carousel.querySelectorAll('.carousel-pagination button');
             const statusDiv = carousel.querySelector('.carousel-status');
             const pausePlayButton = carousel.querySelector('.carousel-pause-play'); // Get the new button

             let currentIndex = 0;
             const totalSlides = slides.length;
             let intervalId = null;
             const autoPlayInterval = 5000; // Time per slide in ms (e.g., 5 seconds)
             let isPlaying = true; // Autoplay starts on
             let userPaused = false; // Track if paused explicitly by user

             const updateCarousel = (newIndex, keepFocus = false) => {
                 if (totalSlides === 0 || !slidesContainer) return;

                 // Stop autoplay temporarily during manual navigation or update
                 stopAutoPlay();

                 currentIndex = (newIndex + totalSlides) % totalSlides;
                 slidesContainer.style.transform = `translateX(-${currentIndex * 100}%)`;
                 paginationButtons.forEach((btn, index) => btn.setAttribute('aria-selected', index === currentIndex));

                 // Update slide labels (good practice)
                 slides.forEach((slide, index) => {
                    slide.setAttribute('aria-label', `${index + 1} of ${totalSlides}`);
                    // Optional: Make only visible slide interactive/discoverable by AT
                    // slide.setAttribute('aria-hidden', index !== currentIndex);
                    // slide.inert = (index !== currentIndex); // More modern approach
                 });


                 if (statusDiv) statusDiv.textContent = `Item ${currentIndex + 1} of ${totalSlides}`;

                 // Only restart autoplay if it wasn't explicitly paused by the user
                 if (!userPaused) {
                     startAutoPlay();
                 }

                 // Optional: Manage focus after update (simple: keep focus on control)
                 // If keepFocus is false, you might blur or move focus elsewhere if needed.
             };

             const startAutoPlay = () => {
                 if (intervalId) clearInterval(intervalId); // Clear existing interval
                 if (isPlaying && totalSlides > 1) { // Only play if isPlaying is true
                     intervalId = setInterval(() => {
                         updateCarousel(currentIndex + 1);
                     }, autoPlayInterval);
                 }
             };

             const stopAutoPlay = () => {
                 clearInterval(intervalId);
                 intervalId = null;
             };

             const togglePlayState = (play) => {
                isPlaying = play;
                if (pausePlayButton) {
                    pausePlayButton.textContent = isPlaying ? 'Pause' : 'Play';
                    pausePlayButton.setAttribute('aria-label', isPlaying ? 'Pause carousel' : 'Play carousel');
                }
                 if (isPlaying) {
                    startAutoPlay();
                 } else {
                    stopAutoPlay();
                 }
             };

             // --- Event Listeners ---

             // Previous/Next Buttons
             if (prevButton) prevButton.addEventListener('click', () => {
                userPaused = true; // Manual interaction pauses
                togglePlayState(false);
                updateCarousel(currentIndex - 1);
             });
             if (nextButton) nextButton.addEventListener('click', () => {
                userPaused = true; // Manual interaction pauses
                togglePlayState(false);
                updateCarousel(currentIndex + 1);
             });

             // Pagination Buttons
             paginationButtons.forEach((btn, index) => btn.addEventListener('click', () => {
                 userPaused = true; // Manual interaction pauses
                 togglePlayState(false);
                 updateCarousel(index);
             }));

             // Pause/Play Button
             if (pausePlayButton) {
                 pausePlayButton.addEventListener('click', () => {
                     userPaused = !userPaused; // Toggle explicit pause state
                     togglePlayState(!userPaused); // Update play state based on user pause
                 });
             }

             // Keyboard Navigation (Arrows on Carousel Container)
             carousel.addEventListener('keydown', (e) => {
                 let handled = false;
                 if (e.key === 'ArrowLeft') {
                     userPaused = true; // Manual interaction pauses
                     togglePlayState(false);
                     updateCarousel(currentIndex - 1);
                     handled = true;
                 } else if (e.key === 'ArrowRight') {
                     userPaused = true; // Manual interaction pauses
                     togglePlayState(false);
                     updateCarousel(currentIndex + 1);
                     handled = true;
                 }
                 if (handled) {
                     e.preventDefault(); // Prevent page scroll
                 }
             });

             // Pause on Hover
             carousel.addEventListener('mouseenter', () => {
                 if (isPlaying) stopAutoPlay(); // Pause visually
             });
             carousel.addEventListener('mouseleave', () => {
                if (isPlaying && !userPaused) startAutoPlay(); // Resume only if playing and not user-paused
             });

             // Pause on Focus within Component
            carousel.addEventListener('focusin', () => {
                 if (isPlaying) stopAutoPlay(); // Pause visually
             });
            carousel.addEventListener('focusout', (e) => {
                // Check if focus is still within the carousel
                if (!carousel.contains(e.relatedTarget)) {
                   if (isPlaying && !userPaused) startAutoPlay(); // Resume only if playing, not user-paused, and focus left carousel
                }
            });


             // Initial Setup
             if(totalSlides > 0) {
                 updateCarousel(0); // Set initial slide view
                 togglePlayState(isPlaying); // Start autoplay if initially set to play
             } else if (pausePlayButton) {
                pausePlayButton.disabled = true; // Disable button if no slides
             }
         });


            // --- Listbox Logic (Basic Focus & Selection) ---
            const listboxes = document.querySelectorAll('[role="listbox"]');
            listboxes.forEach(listbox => {
                let options = Array.from(listbox.querySelectorAll('[role="option"]'));
                let focusedOptionIndex = -1;

                const updateFocus = (newIndex) => {
                    focusedOptionIndex = newIndex;
                    if (focusedOptionIndex >= 0 && options[focusedOptionIndex]) {
                        listbox.setAttribute('aria-activedescendant', options[focusedOptionIndex].id);
                        options[focusedOptionIndex].scrollIntoView({ block: 'nearest' });
                    } else {
                        listbox.removeAttribute('aria-activedescendant');
                    }
                };

                const selectOption = (index) => {
                    if (index < 0 || index >= options.length) return;
                    const isMultiSelect = listbox.getAttribute('aria-multiselectable') === 'true';
                    const option = options[index];
                    const isSelected = option.getAttribute('aria-selected') === 'true';
                    if (!isMultiSelect) options.forEach(opt => opt.setAttribute('aria-selected', 'false'));
                    option.setAttribute('aria-selected', isMultiSelect ? !isSelected : 'true');
                };

                listbox.addEventListener('focus', () => {
                    options = Array.from(listbox.querySelectorAll('[role="option"]')); // Refresh options on focus
                    const firstSelectedIndex = options.findIndex(opt => opt.getAttribute('aria-selected') === 'true');
                    updateFocus(firstSelectedIndex !== -1 ? firstSelectedIndex : (options.length > 0 ? 0 : -1));
                });

                listbox.addEventListener('keydown', (e) => {
                    options = Array.from(listbox.querySelectorAll('[role="option"]')); // Refresh options
                    if (options.length === 0) return;
                    let newIndex = focusedOptionIndex;
                    let preventDefault = true;

                    switch (e.key) {
                        case 'ArrowDown': newIndex = Math.min(options.length - 1, focusedOptionIndex + 1); break;
                        case 'ArrowUp': newIndex = Math.max(0, focusedOptionIndex - 1); break;
                        case 'Home': newIndex = 0; break;
                        case 'End': newIndex = options.length - 1; break;
                        case ' ': case 'Enter': selectOption(focusedOptionIndex); break;
                        default: preventDefault = false; break;
                    }

                    if (newIndex !== focusedOptionIndex && newIndex >= 0 && newIndex < options.length) {
                         updateFocus(newIndex);
                    }
                    if(preventDefault) e.preventDefault();
                });

                listbox.addEventListener('click', (e) => {
                    const clickedOption = e.target.closest('[role="option"]');
                    options = Array.from(listbox.querySelectorAll('[role="option"]')); // Refresh options
                    if (clickedOption && options.includes(clickedOption)) {
                        const index = options.indexOf(clickedOption);
                        updateFocus(index);
                        selectOption(index);
                        listbox.focus();
                    }
                });

                 // --- Rearrangeable Listbox Button Logic (Basic) ---
                 const wrapper = listbox.closest('.rearrange-listbox-wrapper');
                 if (wrapper) {
                     const moveUpBtn = wrapper.querySelector('.move-up-btn');
                     const moveDownBtn = wrapper.querySelector('.move-down-btn');

                     const moveOption = (direction) => {
                         options = Array.from(listbox.querySelectorAll('[role="option"]'));
                         if (focusedOptionIndex < 0) return;
                         const currentOption = options[focusedOptionIndex];
                         let swapIndex = -1;

                         if (direction === 'up' && focusedOptionIndex > 0) swapIndex = focusedOptionIndex - 1;
                         else if (direction === 'down' && focusedOptionIndex < options.length - 1) swapIndex = focusedOptionIndex + 1;

                         if (swapIndex !== -1) {
                             const swapOption = options[swapIndex];
                             if (direction === 'up') listbox.insertBefore(currentOption, swapOption);
                             else listbox.insertBefore(swapOption, currentOption);
                             options = Array.from(listbox.querySelectorAll('[role="option"]'));
                             updateFocus(swapIndex);
                         }
                     };

                     if (moveUpBtn) moveUpBtn.addEventListener('click', () => moveOption('up'));
                     if (moveDownBtn) moveDownBtn.addEventListener('click', () => moveOption('down'));
                 }
            });
// --- Password Show/Hide Toggle ---
         const passwordInput = document.getElementById('passwordInputExample');
         const passwordToggleBtn = document.getElementById('passwordToggleBtn');

         if (passwordInput && passwordToggleBtn) {
             passwordToggleBtn.addEventListener('click', () => {
                 // Check current type
                 const currentType = passwordInput.getAttribute('type');

                 if (currentType === 'password') {
                     // Change to text
                     passwordInput.setAttribute('type', 'text');
                     passwordToggleBtn.textContent = 'Hide';
                     passwordToggleBtn.setAttribute('aria-label', 'Hide password');
                 } else {
                     // Change back to password
                     passwordInput.setAttribute('type', 'password');
                     passwordToggleBtn.textContent = 'Show';
                     passwordToggleBtn.setAttribute('aria-label', 'Show password');
                 }
             });
         }

            // --- Search/Filter Logic ---
            const searchInput = document.getElementById('controlSearchInput');
            const controlsContainer = document.getElementById('controls-container');
            const controlItems = controlsContainer ? controlsContainer.getElementsByClassName('form-control-item') : [];
            const resultsCountSpan = document.getElementById('search-results-count');
            let totalControls = controlItems.length;

            if (searchInput && controlsContainer && resultsCountSpan && controlItems.length > 0) {
                const filterControls = () => {
                    const searchTerm = searchInput.value.toLowerCase().trim();
                    let visibleCount = 0;
                    for (let item of controlItems) {
                        const title = item.querySelector('h2')?.textContent.toLowerCase() || '';
                        const keywords = item.dataset.keywords?.toLowerCase() || '';
                        const isMatch = searchTerm === '' || title.includes(searchTerm) || keywords.includes(searchTerm);
                        item.classList.toggle('hidden', !isMatch);
                        if (isMatch) visibleCount++;
                    }
                    resultsCountSpan.textContent = `${visibleCount} of ${totalControls} component${visibleCount !== 1 ? 's' : ''} shown.`;
                };
                searchInput.addEventListener('input', filterControls);
                filterControls(); // Initial run
            } else if(resultsCountSpan) {
                 resultsCountSpan.textContent = `0 components found.`;
            }

            // --- Scroll to Top Button Logic ---
            const scrollToTopBtn = document.getElementById("scrollToTopBtn");
            if (scrollToTopBtn) {
                window.onscroll = () => {
                    scrollToTopBtn.style.display = (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) ? "block" : "none";
                };
                scrollToTopBtn.addEventListener('click', () => {
                    window.scrollTo({top: 0, behavior: 'smooth'});
                    document.querySelector('h1')?.focus();
                });
            }

             // --- Theme Toggle Logic ---
             const themeToggle = document.getElementById('themeToggle');
             if (themeToggle) {
                 const applyTheme = (isDark) => {
                     document.body.classList.toggle('dark-theme', isDark);
                     themeToggle.setAttribute('aria-checked', isDark ? 'true' : 'false');
                 };
                 themeToggle.addEventListener('change', (e) => applyTheme(e.target.checked));
                 const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                 themeToggle.checked = prefersDark;
                 applyTheme(prefersDark);
             }

             // --- Toggle Switch Aria Sync ---
             const switches = document.querySelectorAll('input[role="switch"]:not(#themeToggle)');
             switches.forEach(switchInput => {
                switchInput.setAttribute('aria-checked', switchInput.checked);
                switchInput.addEventListener('change', (e) => {
                     e.target.setAttribute('aria-checked', e.target.checked);
                });
             });

             // --- Range Slider Initial Value Sync ---
             const rangeInputs = document.querySelectorAll('input[type="range"]');
             rangeInputs.forEach(rangeInput => {
                 const outputElement = document.querySelector(`output[for="${rangeInput.id}"]`);
                 if(outputElement) {
                     outputElement.textContent = rangeInput.value; // Set initial
                     rangeInput.addEventListener('input', (e) => { // Update on input
                         outputElement.textContent = e.target.value;
                     });
                 }
             });

             // --- File Input Initial Text & Update ---
             const fileInputs = document.querySelectorAll('input[type="file"]');
             fileInputs.forEach(fileInput => {
                const displaySpanId = 'fileNameDisplay' + fileInput.id.replace('InputExample','');
                const displaySpan = document.getElementById(displaySpanId);
                if(displaySpan){
                    // Set initial text
                    displaySpan.textContent = (fileInput.files && fileInput.files.length > 0) ? fileInput.files[0].name : 'No file chosen';
                    // Update on change (already handled by inline JS, but good practice to have it here too)
                    fileInput.addEventListener('change', (e) => {
                         displaySpan.textContent = (e.target.files.length > 0) ? e.target.files[0].name : 'No file chosen';
                    });
                }
             });

        }); // End DOMContentLoaded
    </script>

</body>
</html>
